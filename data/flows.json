[{"disabled":false,"id":"1755f935.cee76f","info":"","label":"Haus","namespace":"tab","type":"tab"},{"disabled":false,"id":"ed2293b3.9cd52","info":"","label":"Alarm","namespace":"tab","type":"tab"},{"disabled":false,"id":"e75b7fd7.a33d6","info":"","label":"EG Flur","namespace":"tab","type":"tab"},{"disabled":false,"id":"4d2cb67e.e7f9b","info":"","label":"HWR","namespace":"tab","type":"tab"},{"disabled":false,"id":"b9b74dfe.3575c","info":"","label":"Gaeste-WC","namespace":"tab","type":"tab"},{"disabled":false,"id":"69ea3b1f.befffc","info":"","label":"Treppenhaus","namespace":"tab","type":"tab"},{"disabled":false,"id":"cc109e74.5fbec","info":"","label":"Wohnzimmer","namespace":"tab","type":"tab"},{"disabled":false,"id":"302d5ee5.37b1aa","info":"","label":"Kueche","namespace":"tab","type":"tab"},{"disabled":false,"id":"c0d2bbb9.a687a","info":"","label":"Nordzimmer","namespace":"tab","type":"tab"},{"disabled":false,"id":"9cd3b032.f95e28","info":"","label":"Suedzimmer","namespace":"tab","type":"tab"},{"disabled":false,"id":"5e7e747b.a20d9c","info":"","label":"Bad","namespace":"tab","type":"tab"},{"disabled":false,"id":"822c4be8.2ccc28","info":"","label":"Schlafzimmer","namespace":"tab","type":"tab"},{"disabled":false,"id":"1d6097ff.a1be1","info":"","label":"EDV-Raum","namespace":"tab","type":"tab"},{"disabled":false,"id":"71b14382.55983c","info":"","label":"Abstellkammer","namespace":"tab","type":"tab"},{"disabled":false,"id":"524cbef6.e505b8","info":"","label":"Benachrichtigungen","namespace":"tab","type":"tab"},{"disabled":false,"id":"fee4d3bf.0b14a8","info":"","label":"Zaehler","namespace":"tab","type":"tab"},{"disabled":false,"id":"d0956444.e19c88","info":"","label":"Spielwiese","namespace":"tab","type":"tab"},{"id":"3050d780.509968","in":[{"wires":[{"id":"ee71f446.fa4548","port":0}],"x":50,"y":50}],"info":"Subflow mit welchem sich alle Lampen ansprechen lassen.","name":"Alle Lampen","namespace":"subflow","out":[],"type":"subflow"},{"id":"8dfedcf0.6ae18","in":[{"wires":[{"id":"4f865d75.03262c","port":0}],"x":50,"y":90}],"info":"","name":"Dimmer","namespace":"subflow","out":[{"wires":[{"id":"4f865d75.03262c","port":0}],"x":480,"y":60},{"wires":[{"id":"6454a276.ab605c","port":0},{"id":"4f865d75.03262c","port":1}],"x":480,"y":110}],"type":"subflow"},{"broker":"127.0.0.1","clientid":"","id":"951b3e2.1a5d3c","namespace":"mqtt","port":"1883","type":"mqtt-broker","usetls":false,"z":""},{"id":"cfef0792.97ae9","namespace":"notification","port":"5222","server":"xabber.de","type":"xmpp-server","user":"homegear","z":""},{"id":"dfc2bc9b.417f1","namespace":"variable","refractoryperiod":"2000","type":"variable-loop-prevention-group","uniqueid":"Sonos Kueche - Lautstaerke","z":""},{"id":"bed7cfec.848c98","namespace":"variable","refractoryperiod":"2000","type":"variable-loop-prevention-group","uniqueid":"Spots - Schiefer","z":""},{"id":"4a09f7fb.c09be","namespace":"variable","refractoryperiod":"1000","type":"variable-loop-prevention-group","uniqueid":"Rundlicht","z":""},{"delay":"10","id":"e384e937.c38998","interval":"5000","namespace":"modbus","port":"502","readcoils":[],"readdiscreteinputs":[],"readinputregisters":[],"readregisters":[{"e":"100","inv":false,"s":"1"},{"e":"840","inv":false,"s":"801"}],"server":"192.168.3.230","slaveid":"255","type":"modbus-host","writecoils":[],"writeregisters":[],"z":""},{"id":"cab7665b.af1d4","namespace":"variable","refractoryperiod":"5000","type":"variable-loop-prevention-group","uniqueid":"Licht - Schlafzimmer","z":""},{"id":"e3a45745.cbe3c","namespace":"variable","refractoryperiod":"2000","type":"variable-loop-prevention-group","uniqueid":"Sonos Bad - Lautstaerke","z":""},{"id":"c233726a.b4eee8","namespace":"variable","refractoryperiod":"10000","type":"variable-loop-prevention-group","uniqueid":"Bad - Licht-an-Timer","z":""},{"id":"782455c3.4da004","namespace":"variable","refractoryperiod":"10000","type":"variable-loop-prevention-group","uniqueid":"Bad - Licht-aus-Timer","z":""},{"channel":"1","family":"14","id":"2830c51f.17f7fa","name":"","namespace":"variable","peerid":"34","refractoryperiod":"0","type":"variable-in","variable":"STATE","variabletype":"device","wires":[[{"id":"3dba1c03.3be4fc","port":0}]],"x":100,"y":100,"z":"822c4be8.2ccc28"},{"channel":"4","family":"15","id":"f32b782.b548108","loopprevention":false,"looppreventiongroup":"cab7665b.af1d4","name":"","namespace":"variable","outputonstartup":false,"peerid":"61","refractoryperiod":"0","type":"variable-in","variable":"STATE","variabletype":"device","wires":[[{"id":"7187a87b.8afb58","port":0}]],"x":95,"y":280,"z":"822c4be8.2ccc28"},{"channel":"3","family":"15","id":"b16b6390.3dc428","loopprevention":false,"looppreventiongroup":"cab7665b.af1d4","name":"","namespace":"variable","outputonstartup":false,"peerid":"61","refractoryperiod":"0","type":"variable-in","variable":"STATE","variabletype":"device","wires":[[{"id":"7187a87b.8afb58","port":1}]],"x":95,"y":380,"z":"822c4be8.2ccc28"},{"id":"29f291ef.a338be","info":"* `34`: Wandtaster\n* `61`: Fernbedienung\n* `43`: Deckenlicht\n* `4.4`: Dachboden\n* `70`: Nachttischlampe Ost\n* `86`: Nachttischlampe West","name":"Deckenlicht","namespace":"comment","type":"comment","wires":[],"x":90,"y":50,"z":"822c4be8.2ccc28"},{"channel":"1","family":"11","id":"7187a87b.8afb58","inputs":2,"lighttype":"dimmerstate","name":"","namespace":"light","offvalue":0,"onvalue":"10000.0","peerid":"43","twoinputs":true,"type":"light","variable":"LEVEL","variabletype":"device","wires":[],"x":380,"y":350,"z":"822c4be8.2ccc28"},{"id":"b414e8ad.a3b548","info":"","name":"Deckenlicht","namespace":"comment","type":"comment","wires":[],"x":90,"y":50,"z":"c0d2bbb9.a687a"},{"channel":"10","family":"14","id":"83df7806.5eb6e8","name":"","namespace":"variable","peerid":"32","refractoryperiod":0,"type":"variable-in","variable":"TEMPERATURE","variabletype":"device","wires":[[{"id":"337a0d68.8f295a","port":0}]],"x":120,"y":470,"z":"c0d2bbb9.a687a"},{"channel":"11","family":"14","id":"e9e43f7e.7abb68","name":"","namespace":"variable","peerid":"32","type":"variable-out","variable":"SETPOINT_INFO","variabletype":"device","wires":[],"x":470,"y":470,"z":"c0d2bbb9.a687a"},{"func":"$message['payload'] = 'Ist: '.round($message['payload'], 1).' \u00B0C';\nreturn $message;","id":"337a0d68.8f295a","inputs":1,"name":"","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[{"id":"e9e43f7e.7abb68","port":0}]],"x":290,"y":470,"z":"c0d2bbb9.a687a"},{"id":"54dbd093.760f7","info":"","name":"Temperaturanzeige Wandthermostat","namespace":"comment","type":"comment","wires":[],"x":160,"y":420,"z":"c0d2bbb9.a687a"},{"id":"7347b26.d5522cc","info":"* `32`: Wandtaster\n* `6.3`: Deckenlampe\n* `6.2`: Ablage\n* `56.1`: Spiegel","name":"Lichter","namespace":"comment","type":"comment","wires":[],"x":80,"y":50,"z":"5e7e747b.a20d9c"},{"id":"4e7d7db2.11c88c","info":"","name":"Spiegelheizung","namespace":"comment","type":"comment","wires":[],"x":100,"y":550,"z":"5e7e747b.a20d9c"},{"channel":"2","family":"14","id":"649e3d24.44288c","name":"","namespace":"variable","peerid":"33","refractoryperiod":0,"type":"variable-in","variable":"STATE","variabletype":"device","wires":[[{"id":"6460c7a9.5ea87","port":0}]],"x":100,"y":600,"z":"5e7e747b.a20d9c"},{"channel":"1","family":"15","id":"6460c7a9.5ea87","inputs":1,"lighttype":"switch","name":"","namespace":"light","offvalue":0,"onvalue":100,"peerid":"62","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":650,"y":600,"z":"5e7e747b.a20d9c"},{"channel":"1","family":"14","id":"1a51b460.f1e9f4","name":"","namespace":"variable","peerid":"39","refractoryperiod":"0","type":"variable-in","variable":"STATE","variabletype":"device","wires":[[{"id":"85dcf59.9e05108","port":0}]],"x":100,"y":100,"z":"e75b7fd7.a33d6"},{"id":"c037d5d4.295b28","info":"* `39`: Wandtaster WZ\n* `40`: Wandtaster Haustuer\n* `1.1`: Flur Deckenlicht\n* `1.2`: Aussenlicht Haustuer","name":"Lichter","namespace":"comment","type":"comment","wires":[],"x":80,"y":50,"z":"e75b7fd7.a33d6"},{"channel":"1","family":"11","id":"560b2276.91011c","inputs":1,"lighttype":"switch","name":"","namespace":"light","offvalue":"0","onvalue":"100","peerid":"1","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":970,"y":100,"z":"e75b7fd7.a33d6"},{"channel":"1","family":"14","id":"ff8ab918.8f2218","loopprevention":false,"looppreventiongroup":"4a09f7fb.c09be","name":"","namespace":"variable","outputonstartup":false,"peerid":"40","refractoryperiod":"0","type":"variable-in","variable":"SCENE","variabletype":"device","wires":[[{"id":"80b984ac.e249c8","port":0}]],"x":100,"y":390,"z":"e75b7fd7.a33d6"},{"changes-only":false,"checkall":"true","id":"80b984ac.e249c8","inputs":1,"name":"","namespace":"basic-logic","output-false":false,"output-true":true,"outputs":1,"property":"payload","rules":[{"t":"eq","v":"2","vt":"int"}],"type":"switch","wires":[[{"id":"5aa094f.8204bec","port":0},{"id":"c30301de.c08c5","port":0},{"id":"96866a4e.d054c","port":0},{"id":"45db47e5.463908","port":0},{"id":"c6c1124c.0bac68","port":0},{"id":"502c7b72.e05404","port":0}]],"x":310,"y":390,"z":"e75b7fd7.a33d6"},{"channel":"1","family":"11","id":"529cdca5.49524c","inputs":1,"lighttype":"switch","name":"","namespace":"light","offvalue":"0","onvalue":"100","peerid":"1","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":725,"y":50,"z":"3050d780.509968"},{"channel":"4","family":"11","id":"8128d6e1.3c6cc8","inputs":1,"lighttype":"switch","name":"","namespace":"light","offvalue":"0","onvalue":"100","peerid":"1","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":725,"y":100,"z":"3050d780.509968"},{"channel":"3","family":"11","id":"dcc67809.461278","inputs":1,"lighttype":"switch","name":"","namespace":"light","offvalue":"0","onvalue":"100","peerid":"2","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":725,"y":200,"z":"3050d780.509968"},{"channel":"4","family":"11","id":"cc65e918.5e8228","inputs":1,"lighttype":"switch","name":"","namespace":"light","offvalue":"0","onvalue":"100","peerid":"2","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":725,"y":250,"z":"3050d780.509968"},{"channel":"1","family":"11","id":"f5cfb96d.9288c","inputs":1,"lighttype":"switch","name":"","namespace":"light","offvalue":"0","onvalue":"100","peerid":"3","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":725,"y":300,"z":"3050d780.509968"},{"channel":"2","family":"11","id":"c5f4cb83.e4019","inputs":1,"lighttype":"switch","name":"","namespace":"light","offvalue":"0","onvalue":"100","peerid":"3","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":725,"y":350,"z":"3050d780.509968"},{"channel":"4","family":"11","id":"9abdd774.3d4ac","inputs":1,"lighttype":"switch","name":"","namespace":"light","offvalue":"0","onvalue":"100","peerid":"3","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":725,"y":400,"z":"3050d780.509968"},{"channel":"4","family":"11","id":"e0126bf8.c888e","inputs":1,"lighttype":"switch","name":"","namespace":"light","offvalue":"0","onvalue":"100","peerid":"4","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":725,"y":500,"z":"3050d780.509968"},{"channel":"1","family":"11","id":"8afe0828.477898","inputs":1,"lighttype":"switch","name":"","namespace":"light","offvalue":"0","onvalue":"100","peerid":"5","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":725,"y":550,"z":"3050d780.509968"},{"channel":"3","family":"11","id":"a90983b3.8d292","inputs":1,"lighttype":"switch","name":"","namespace":"light","offvalue":"0","onvalue":"100","peerid":"5","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":725,"y":600,"z":"3050d780.509968"},{"channel":"1","family":"11","id":"fa144af1.4dbff8","inputs":1,"lighttype":"switch","name":"","namespace":"light","offvalue":"0","onvalue":"100","peerid":"6","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":725,"y":650,"z":"3050d780.509968"},{"channel":"3","family":"11","id":"743cf121.55c95","inputs":1,"lighttype":"switch","name":"","namespace":"light","offvalue":"0","onvalue":"100","peerid":"6","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":725,"y":700,"z":"3050d780.509968"},{"channel":"4","family":"11","id":"f5072222.cf81b8","inputs":1,"lighttype":"switch","name":"","namespace":"light","offvalue":"0","onvalue":"100","peerid":"6","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":725,"y":750,"z":"3050d780.509968"},{"channel":"1","family":"11","id":"9d68e026.988f1","inputs":1,"lighttype":"switch","name":"","namespace":"light","offvalue":"0","onvalue":"100","peerid":"7","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":725,"y":800,"z":"3050d780.509968"},{"channel":"1","family":"11","id":"d4701f42.3e9dc8","inputs":1,"lighttype":"switch","name":"","namespace":"light","offvalue":"0","onvalue":"100","peerid":"8","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":725,"y":850,"z":"3050d780.509968"},{"channel":"1","family":"15","id":"db6ccfd0.147","inputs":1,"lighttype":"switch","name":"","namespace":"light","offvalue":"0","onvalue":"100","peerid":"28","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":725,"y":900,"z":"3050d780.509968"},{"channel":"1","family":"11","id":"24b7b4f9.1d783c","inputs":1,"lighttype":"switch","name":"","namespace":"light","offvalue":"0","onvalue":"100","peerid":"15","twoinputs":false,"type":"light","variable":"LEVEL","variabletype":"device","wires":[],"x":730,"y":1000,"z":"3050d780.509968"},{"channel":"1","family":"11","id":"313385a3.7bd502","inputs":1,"lighttype":"switch","name":"","namespace":"light","offvalue":"0","onvalue":"100","peerid":"16","twoinputs":false,"type":"light","variable":"LEVEL","variabletype":"device","wires":[],"x":730,"y":1050,"z":"3050d780.509968"},{"channel":"1","family":"11","id":"8aa4d530.ff8cc8","inputs":1,"lighttype":"switch","name":"","namespace":"light","offvalue":"0","onvalue":"100","peerid":"17","twoinputs":false,"type":"light","variable":"LEVEL","variabletype":"device","wires":[],"x":730,"y":1100,"z":"3050d780.509968"},{"channel":"1","family":"11","id":"a7081992.d7c33","inputs":1,"lighttype":"switch","name":"","namespace":"light","offvalue":"0","onvalue":"100","peerid":"43","twoinputs":false,"type":"light","variable":"LEVEL","variabletype":"device","wires":[],"x":730,"y":1150,"z":"3050d780.509968"},{"id":"75665009.0cf2","name":"","namespace":"passthrough","onboolean":false,"type":"passthrough","wires":[[{"id":"24b7b4f9.1d783c","port":0},{"id":"313385a3.7bd502","port":0},{"id":"8aa4d530.ff8cc8","port":0},{"id":"a7081992.d7c33","port":0},{"id":"a300af6.3b7885","port":0},{"id":"aed5a172.646c88","port":0}]],"x":235,"y":880,"z":"3050d780.509968"},{"id":"aac41ab4.12e56","name":"","namespace":"variable","outputonstartup":true,"payload":"0.0","payloadType":"float","type":"constant","wires":[[{"id":"75665009.0cf2","port":0}]],"x":80,"y":870,"z":"3050d780.509968"},{"changes-only":false,"checkall":"true","id":"ee71f446.fa4548","inputs":1,"name":"","namespace":"basic-logic","output-false":false,"output-true":false,"outputs":3,"property":"payload","rules":[{"t":"nnull"},{"t":"true"},{"t":"false"}],"type":"switch","wires":[[{"id":"529cdca5.49524c","port":0},{"id":"8128d6e1.3c6cc8","port":0},{"id":"dcc67809.461278","port":0},{"id":"cc65e918.5e8228","port":0},{"id":"f5cfb96d.9288c","port":0},{"id":"c5f4cb83.e4019","port":0},{"id":"9abdd774.3d4ac","port":0},{"id":"e0126bf8.c888e","port":0},{"id":"8afe0828.477898","port":0},{"id":"a90983b3.8d292","port":0},{"id":"fa144af1.4dbff8","port":0},{"id":"743cf121.55c95","port":0},{"id":"f5072222.cf81b8","port":0},{"id":"9d68e026.988f1","port":0},{"id":"d4701f42.3e9dc8","port":0},{"id":"db6ccfd0.147","port":0},{"id":"38779491.2f67e4","port":0},{"id":"34864f4.a4044b","port":0},{"id":"b811f6c0.955588","port":0}],[{"id":"7ded81be.9043c","port":1}],[{"id":"75665009.0cf2","port":1}]],"x":430,"y":50,"z":"3050d780.509968"},{"id":"7ded81be.9043c","name":"","namespace":"passthrough","onboolean":false,"type":"passthrough","wires":[[{"id":"24b7b4f9.1d783c","port":0},{"id":"313385a3.7bd502","port":0},{"id":"8aa4d530.ff8cc8","port":0},{"id":"a7081992.d7c33","port":0},{"id":"a300af6.3b7885","port":0},{"id":"aed5a172.646c88","port":0}]],"x":235,"y":810,"z":"3050d780.509968"},{"id":"a5961f7f.3e4cd8","name":"","namespace":"variable","outputonstartup":true,"payload":"10000.0","payloadType":"float","type":"constant","wires":[[{"id":"7ded81be.9043c","port":0}]],"x":80,"y":800,"z":"3050d780.509968"},{"id":"d92f689e.6e8e8","name":"","namespace":"subflow:3050d780.509968","type":"subflow:3050d780.509968","wires":[],"x":700,"y":390,"z":"e75b7fd7.a33d6"},{"id":"e08dc887.7e7df8","info":"","name":"Alles ausschalten","namespace":"comment","type":"comment","wires":[],"x":110,"y":340,"z":"e75b7fd7.a33d6"},{"id":"fbcfc43.1273a38","info":"","name":"Aussenlampen nachts einschalten","namespace":"comment","type":"comment","wires":[],"x":150,"y":570,"z":"e75b7fd7.a33d6"},{"channel":"2","factor":"","family":"11","id":"afabef4b.0ac4c","inputs":1,"interval":"","lighttype":"switch","maxvalue":"","minvalue":"","name":"","namespace":"light","offvalue":"0","offvalue2":"","onvalue":"100","peerid":"1","step":"","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":640,"y":620,"z":"e75b7fd7.a33d6"},{"channel":"1","factor":"","family":"11","id":"162f0333.79fa65","inputs":1,"interval":"","lighttype":"switch","maxvalue":"","minvalue":"","name":"","namespace":"light","offvalue":"0","offvalue2":"","onvalue":"100","peerid":"12","step":"","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":640,"y":650,"z":"e75b7fd7.a33d6"},{"channel":"2","factor":"","family":"11","id":"2d3527a1.5e5938","inputs":1,"interval":"","lighttype":"switch","maxvalue":"","minvalue":"","name":"","namespace":"light","offvalue":"0","offvalue2":"","onvalue":"100","peerid":"12","step":"","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":640,"y":680,"z":"e75b7fd7.a33d6"},{"apr":true,"aug":true,"dec":true,"endoff":"-15","feb":true,"fri":true,"id":"87adecee.306ee8","jan":true,"jul":true,"jun":true,"lat":"54.28438","lon":"10.17234","mar":true,"may":true,"mon":true,"name":"","namespace":"timers","nov":true,"oct":true,"offtime":"sunrise","offtimetype":"suntime","ontime":"sunset","ontimetype":"suntime","sat":true,"sep":true,"startoff":"15","startup":true,"sun":true,"thu":true,"tue":true,"type":"timer","wed":true,"wires":[[{"id":"afabef4b.0ac4c","port":0},{"id":"162f0333.79fa65","port":0},{"id":"2d3527a1.5e5938","port":0},{"id":"61c30a7f.974664","port":0}]],"x":80,"y":620,"z":"e75b7fd7.a33d6"},{"id":"10723324.b343bd","info":"","name":"Klingel","namespace":"comment","type":"comment","wires":[],"x":80,"y":810,"z":"e75b7fd7.a33d6"},{"channel":"3","family":"11","id":"41c0f1e4.c9842","name":"","namespace":"variable","peerid":"18","refractoryperiod":"15000","type":"variable-in","variable":"STATE","variabletype":"device","wires":[[{"id":"d8d7ee04.4281d","port":0}]],"x":100,"y":900,"z":"e75b7fd7.a33d6"},{"channel":"1","family":"6","id":"3bbb13dc.1d96f4","name":"","namespace":"variable","peerid":"25","type":"variable-out","variable":"PLAY_AUDIO_FILE_VOLUME","variabletype":"device","wires":[],"x":590,"y":850,"z":"e75b7fd7.a33d6"},{"id":"10fdae98.ae5251","name":"","namespace":"variable","outputonstartup":true,"payload":"70","payloadType":"int","type":"constant","wires":[[{"id":"3bbb13dc.1d96f4","port":0}]],"x":350,"y":850,"z":"e75b7fd7.a33d6"},{"channel":"1","family":"6","id":"2e7b56d0.f5ad2a","name":"","namespace":"variable","peerid":"25","type":"variable-out","variable":"PLAY_AUDIO_FILE","variabletype":"device","wires":[],"x":620,"y":900,"z":"e75b7fd7.a33d6"},{"field":"payload","format":"handlebars","id":"d8d7ee04.4281d","name":"","namespace":"template","output":"str","syntax":"plain","template":"Doorbell.mp3","type":"template","wires":[[{"id":"2e7b56d0.f5ad2a","port":0}]],"x":350,"y":900,"z":"e75b7fd7.a33d6"},{"id":"352827c5.0de148","info":"","name":"Heizungsregler","namespace":"comment","type":"comment","wires":[],"x":100,"y":870,"z":"5e7e747b.a20d9c"},{"dutycyclemax":"100","dutycyclemin":"0","id":"3f6f614c.9ba796","name":"","namespace":"timers","period":"1800","type":"slow-pwm","wires":[[{"id":"3e7bdcb3.1315bc","port":0}]],"x":630,"y":940,"z":"5e7e747b.a20d9c"},{"channel":"2","family":"14","id":"3e7bdcb3.1315bc","name":"","namespace":"variable","peerid":"100","type":"variable-out","variable":"VALVE_STATE_INPUT","variabletype":"device","wires":[],"x":840,"y":940,"z":"5e7e747b.a20d9c"},{"decalcificationday":"5","decalcificationhour":"15","heatingtype":"manual","id":"e0aaa262.aac008","kp":"75","name":"","namespace":"heating","rcwlp":"1200","td":"180","tn":"14400","type":"heating-controller","uvalvelprc":"60","wires":[[{"id":"3f6f614c.9ba796","port":0},{"id":"eb7731bd.17fe68","port":0},{"id":"322d5f47.5b4d1","port":0}]],"x":440,"y":940,"ylprc":"60","z":"5e7e747b.a20d9c"},{"channel":"10","family":"14","id":"d54195f7.2da4c","loopprevention":false,"looppreventiongroup":"cab7665b.af1d4","name":"","namespace":"variable","outputonstartup":false,"peerid":"33","refractoryperiod":"200","type":"variable-in","variable":"ACTUAL_TEMPERATURE","variabletype":"device","wires":[[{"id":"e0aaa262.aac008","port":1}]],"x":150,"y":920,"z":"5e7e747b.a20d9c"},{"channel":"10","family":"14","id":"6d49474c.6c083","loopprevention":false,"looppreventiongroup":"cab7665b.af1d4","name":"","namespace":"variable","outputonstartup":false,"peerid":"33","refractoryperiod":"200","type":"variable-in","variable":"SETPOINT_TEMPERATURE_OUT","variabletype":"device","wires":[[{"id":"e0aaa262.aac008","port":2}]],"x":170,"y":970,"z":"5e7e747b.a20d9c"},{"channel":"10","family":"14","id":"af7def9f.72032","name":"","namespace":"variable","peerid":"33","refractoryperiod":"200","type":"variable-in","variable":"CURRENT_SETPOINT","variabletype":"device","wires":[[{"id":"9d38e6f2.41eb6","port":0}]],"x":140,"y":1080,"z":"5e7e747b.a20d9c"},{"func":"$t = $message['payload'];\nif($t == 16.0)\n{\n    $t = getNodeData(\"SETPOINT\");\n    if($t == 16.0 || !$t) $t = 21.0;\n    $message['payload'] = $t;\n    return $message;\n}\nelse setNodeData(\"SETPOINT\", $t);","id":"9d38e6f2.41eb6","inputs":1,"name":"","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[{"id":"a632abdd.9f097","port":0}]],"x":370,"y":1080,"z":"5e7e747b.a20d9c"},{"channel":"10","family":"14","id":"a632abdd.9f097","name":"","namespace":"variable","peerid":"33","type":"variable-out","variable":"BASE_SETPOINT","variabletype":"device","wires":[],"x":610,"y":1080,"z":"5e7e747b.a20d9c"},{"broker":"951b3e2.1a5d3c","id":"eb7731bd.17fe68","name":"","namespace":"mqtt","retain":"true","topic":"nodeblue/1/plain/33/10/VALVE_STATE","type":"mqtt-out","wires":[],"x":700,"y":990,"z":"5e7e747b.a20d9c"},{"id":"2557715d.458c5e","info":"","name":"Solltemperaturaktualisierung","namespace":"comment","type":"comment","wires":[],"x":130,"y":1030,"z":"5e7e747b.a20d9c"},{"id":"48e34be6.363244","interval":"43200000","name":"","namespace":"timers","resetafter":"0","type":"interval","wires":[[{"id":"b33e0c60.31c54","port":0}],[]],"x":80,"y":110,"z":"1755f935.cee76f"},{"id":"9cd0fb74.1cc1b8","info":"","name":"Uhrzeit und Datum auf allen Wandthermostaten setzen","namespace":"comment","type":"comment","wires":[],"x":200,"y":50,"z":"1755f935.cee76f"},{"func":"$peers = array(30, 31, 32, 34);\n\nforeach($peers as $peer)\n{\n    $time = time();\n    $hg->setValue($peer, 11, \"DATE.DAY\", (int)date(\"j\", $time));\n    $hg->setValue($peer, 11, \"DATE.MONTH\", (int)date(\"n\", $time));\n    $hg->setValue($peer, 11, \"DATE.YEAR\", (int)date(\"y\", $time));\n    $hg->setValue($peer, 11, \"DATE.SUBMIT\", true);\n    \n    $hg->setValue($peer, 11, \"TIME.DAY\", (int)date(\"N\", $time));\n    $hg->setValue($peer, 11, \"TIME.HOURS\", (int)date(\"G\", $time));\n    $hg->setValue($peer, 11, \"TIME.MINUTES\", (int)date(\"i\", $time));\n    $hg->setValue($peer, 11, \"TIME.SECONDS\", (int)date(\"s\", $time));\n    $hg->setValue($peer, 11, \"TIME.SUBMIT\", true);\n    sleep(5);\n}","id":"b33e0c60.31c54","inputs":1,"name":"","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[]],"x":280,"y":110,"z":"1755f935.cee76f"},{"id":"98377f6e.156d7","info":"","name":"Heizungsregler","namespace":"comment","type":"comment","wires":[],"x":100,"y":520,"z":"c0d2bbb9.a687a"},{"dutycyclemax":"100","dutycyclemin":"0","id":"46d448e6.4a1d98","name":"","namespace":"timers","period":"1800","type":"slow-pwm","wires":[[{"id":"6691a9c7.194568","port":0}]],"x":550,"y":590,"z":"c0d2bbb9.a687a"},{"channel":"10","family":"14","id":"6691a9c7.194568","name":"","namespace":"variable","peerid":"32","type":"variable-out","variable":"VALVE_STATE_INPUT","variabletype":"device","wires":[],"x":760,"y":590,"z":"c0d2bbb9.a687a"},{"decalcificationday":"5","decalcificationhour":"13","heatingtype":"manual","id":"b04e686.97adc98","kp":"75","name":"","namespace":"heating","rcwlp":"1200","td":"180","tn":"14400","type":"heating-controller","uvalvelprc":"60","wires":[[{"id":"46d448e6.4a1d98","port":0},{"id":"c526d8b1.195538","port":0},{"id":"52c9a9ae.1a60d8","port":0}]],"x":355,"y":590,"ylprc":"60","z":"c0d2bbb9.a687a"},{"channel":"10","family":"14","id":"c82409db.a9e278","loopprevention":false,"looppreventiongroup":"cab7665b.af1d4","name":"","namespace":"variable","outputonstartup":false,"peerid":"32","refractoryperiod":"200","type":"variable-in","variable":"TEMPERATURE","variabletype":"device","wires":[[{"id":"b04e686.97adc98","port":1}]],"x":120,"y":570,"z":"c0d2bbb9.a687a"},{"channel":"10","family":"14","id":"f7072879.195f1","name":"","namespace":"variable","peerid":"32","refractoryperiod":"200","type":"variable-in","variable":"CURRENT_SETPOINT","variabletype":"device","wires":[[{"id":"b04e686.97adc98","port":2}]],"x":140,"y":620,"z":"c0d2bbb9.a687a"},{"channel":"10","family":"14","id":"5fecd8b2.7f0788","name":"","namespace":"variable","peerid":"32","refractoryperiod":"200","type":"variable-in","variable":"CURRENT_SETPOINT","variabletype":"device","wires":[[{"id":"a89c0164.a4f628","port":0}]],"x":140,"y":730,"z":"c0d2bbb9.a687a"},{"func":"$t = $message['payload'];\nif($t == 16.0)\n{\n    $t = getNodeData(\"SETPOINT\");\n    if($t == 16.0 || !$t) $t = 21.0;\n    $message['payload'] = $t;\n    return $message;\n}\nelse setNodeData(\"SETPOINT\", $t);","id":"a89c0164.a4f628","inputs":1,"name":"","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[{"id":"1a12eac3.3a5f15","port":0}]],"x":370,"y":730,"z":"c0d2bbb9.a687a"},{"channel":"10","family":"14","id":"1a12eac3.3a5f15","name":"","namespace":"variable","peerid":"32","type":"variable-out","variable":"BASE_SETPOINT","variabletype":"device","wires":[],"x":610,"y":730,"z":"c0d2bbb9.a687a"},{"broker":"951b3e2.1a5d3c","id":"c526d8b1.195538","name":"","namespace":"mqtt","retain":"true","topic":"nodeblue/1/plain/32/10/VALVE_STATE","type":"mqtt-out","wires":[],"x":620,"y":640,"z":"c0d2bbb9.a687a"},{"id":"4a865a61.77204c","info":"","name":"Solltemperaturaktualisierung","namespace":"comment","type":"comment","wires":[],"x":130,"y":680,"z":"c0d2bbb9.a687a"},{"id":"3611d1f7.8e2c0e","info":"","name":"Heizungsregler","namespace":"comment","type":"comment","wires":[],"x":100,"y":2630,"z":"cc109e74.5fbec"},{"dutycyclemax":"100","dutycyclemin":"0","id":"a772a9e0.302238","name":"","namespace":"timers","period":"1800","type":"slow-pwm","wires":[[{"id":"74b2f931.ee038","port":0}]],"x":550,"y":2700,"z":"cc109e74.5fbec"},{"channel":"2","family":"14","id":"74b2f931.ee038","name":"","namespace":"variable","peerid":"20","type":"variable-out","variable":"VALVE_STATE_INPUT","variabletype":"device","wires":[],"x":760,"y":2700,"z":"cc109e74.5fbec"},{"decalcificationday":"5","decalcificationhour":"11","heatingtype":"manual","id":"dd418e7b.b8aa58","kp":"75","name":"","namespace":"heating","rcwlp":"1200","td":"180","tn":"14400","type":"heating-controller","uvalvelprc":"60","wires":[[{"id":"a772a9e0.302238","port":0},{"id":"2b8be848.46aa88","port":0},{"id":"5d0f6913.da583","port":0}]],"x":390,"y":2700,"ylprc":"60","z":"cc109e74.5fbec"},{"channel":"10","family":"14","id":"d0ba7b60.e54d18","loopprevention":false,"looppreventiongroup":"","name":"","namespace":"variable","outputonstartup":false,"peerid":"51","refractoryperiod":"200","type":"variable-in","variable":"TEMPERATURE","variabletype":"device","wires":[[{"id":"564de489.9a52fc","port":0},{"id":"dd418e7b.b8aa58","port":1}]],"x":120,"y":2680,"z":"cc109e74.5fbec"},{"channel":"10","family":"14","id":"36598f3c.edda08","loopprevention":false,"looppreventiongroup":"","name":"","namespace":"variable","outputonstartup":false,"peerid":"19","refractoryperiod":"0","type":"variable-in","variable":"SETPOINT_TEMPERATURE","variabletype":"device","wires":[[{"id":"dd418e7b.b8aa58","port":2}]],"x":155,"y":2730,"z":"cc109e74.5fbec"},{"broker":"951b3e2.1a5d3c","id":"2b8be848.46aa88","name":"","namespace":"mqtt","retain":"true","topic":"nodeblue/1/plain/19/10/VALVE_STATE","type":"mqtt-out","wires":[],"x":620,"y":2750,"z":"cc109e74.5fbec"},{"channel":"10","family":"14","id":"dd9e76f2.4a04f","name":"","namespace":"variable","peerid":"31","refractoryperiod":0,"type":"variable-in","variable":"TEMPERATURE","variabletype":"device","wires":[[{"id":"f7ddd6f0.9187c8","port":0}]],"x":120,"y":450,"z":"9cd3b032.f95e28"},{"channel":"11","family":"14","id":"2d191109.a8f59e","name":"","namespace":"variable","peerid":"31","type":"variable-out","variable":"SETPOINT_INFO","variabletype":"device","wires":[],"x":470,"y":450,"z":"9cd3b032.f95e28"},{"func":"$message['payload'] = 'Ist: '.round($message['payload'], 1).' \u00B0C';\nreturn $message;","id":"f7ddd6f0.9187c8","inputs":1,"name":"","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[{"id":"2d191109.a8f59e","port":0}]],"x":290,"y":450,"z":"9cd3b032.f95e28"},{"id":"46cee587.7135d4","info":"","name":"Temperaturanzeige Wandthermostat","namespace":"comment","type":"comment","wires":[],"x":160,"y":400,"z":"9cd3b032.f95e28"},{"id":"c6a4213d.35e28","info":"","name":"Heizungsregler","namespace":"comment","type":"comment","wires":[],"x":100,"y":500,"z":"9cd3b032.f95e28"},{"dutycyclemax":"100","dutycyclemin":"0","id":"4b9f2d1a.520e34","name":"","namespace":"timers","period":"1800","type":"slow-pwm","wires":[[{"id":"e2b6da9a.8cb99","port":0}]],"x":550,"y":570,"z":"9cd3b032.f95e28"},{"channel":"10","family":"14","id":"e2b6da9a.8cb99","name":"","namespace":"variable","peerid":"31","type":"variable-out","variable":"VALVE_STATE_INPUT","variabletype":"device","wires":[],"x":760,"y":570,"z":"9cd3b032.f95e28"},{"decalcificationday":"5","decalcificationhour":"14","heatingtype":"manual","id":"14ce9cea.6569a3","kp":"75","name":"","namespace":"heating","rcwlp":"1200","td":"180","tn":"14400","type":"heating-controller","uvalvelprc":"60","wires":[[{"id":"4b9f2d1a.520e34","port":0},{"id":"97707457.73b7","port":0},{"id":"385c5b1.c3d2424","port":0}]],"x":360,"y":570,"ylprc":"60","z":"9cd3b032.f95e28"},{"channel":"10","family":"14","id":"6d66b995.04778","name":"","namespace":"variable","peerid":"31","refractoryperiod":"200","type":"variable-in","variable":"TEMPERATURE","variabletype":"device","wires":[[{"id":"14ce9cea.6569a3","port":1}]],"x":120,"y":550,"z":"9cd3b032.f95e28"},{"channel":"10","family":"14","id":"cb84fe59.f3d31","name":"","namespace":"variable","peerid":"31","refractoryperiod":"200","type":"variable-in","variable":"CURRENT_SETPOINT","variabletype":"device","wires":[[{"id":"14ce9cea.6569a3","port":2}]],"x":140,"y":600,"z":"9cd3b032.f95e28"},{"channel":"10","family":"14","id":"27476e90.72668a","name":"","namespace":"variable","peerid":"31","refractoryperiod":"200","type":"variable-in","variable":"CURRENT_SETPOINT","variabletype":"device","wires":[[{"id":"8dcae172.0d9028","port":0}]],"x":140,"y":710,"z":"9cd3b032.f95e28"},{"func":"$t = $message['payload'];\nif($t == 16.0)\n{\n    $t = getNodeData(\"SETPOINT\");\n    if($t == 16.0 || !$t) $t = 21.0;\n    $message['payload'] = $t;\n    return $message;\n}\nelse setNodeData(\"SETPOINT\", $t);","id":"8dcae172.0d9028","inputs":1,"name":"","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[{"id":"9d44ff6f.b29758","port":0}]],"x":370,"y":710,"z":"9cd3b032.f95e28"},{"channel":"10","family":"14","id":"9d44ff6f.b29758","name":"","namespace":"variable","peerid":"31","type":"variable-out","variable":"BASE_SETPOINT","variabletype":"device","wires":[],"x":610,"y":710,"z":"9cd3b032.f95e28"},{"broker":"951b3e2.1a5d3c","id":"97707457.73b7","name":"","namespace":"mqtt","retain":"true","topic":"nodeblue/1/plain/31/10/VALVE_STATE","type":"mqtt-out","wires":[],"x":620,"y":620,"z":"9cd3b032.f95e28"},{"id":"8e51f3f1.8f7578","info":"","name":"Solltemperaturaktualisierung","namespace":"comment","type":"comment","wires":[],"x":130,"y":660,"z":"9cd3b032.f95e28"},{"channel":"10","family":"14","id":"af245196.fef098","name":"","namespace":"variable","peerid":"34","refractoryperiod":0,"type":"variable-in","variable":"TEMPERATURE","variabletype":"device","wires":[[{"id":"f1a16cf6.3737d","port":0}]],"x":120,"y":830,"z":"822c4be8.2ccc28"},{"channel":"11","family":"14","id":"9e000a70.9256d","name":"","namespace":"variable","peerid":"34","type":"variable-out","variable":"SETPOINT_INFO","variabletype":"device","wires":[],"x":580,"y":840,"z":"822c4be8.2ccc28"},{"id":"b8b6e06.bddea2","info":"","name":"Temperaturanzeige Wandthermostat","namespace":"comment","type":"comment","wires":[],"x":160,"y":780,"z":"822c4be8.2ccc28"},{"id":"f92b6ccd.19c558","info":"","name":"Heizungsregler","namespace":"comment","type":"comment","wires":[],"x":100,"y":930,"z":"822c4be8.2ccc28"},{"dutycyclemax":"100","dutycyclemin":"0","id":"f14b8765.ef1d28","name":"","namespace":"timers","period":"1800","type":"slow-pwm","wires":[[{"id":"9b55bbf6.70334","port":0}]],"x":550,"y":1000,"z":"822c4be8.2ccc28"},{"channel":"10","family":"14","id":"9b55bbf6.70334","name":"","namespace":"variable","peerid":"34","type":"variable-out","variable":"VALVE_STATE_INPUT","variabletype":"device","wires":[],"x":760,"y":1000,"z":"822c4be8.2ccc28"},{"decalcificationday":"5","decalcificationhour":"16","heatingtype":"manual","id":"da91e238.fffe58","kp":"75","name":"","namespace":"heating","rcwlp":"1200","td":"180","tn":"14400","type":"heating-controller","uvalvelprc":"60","wires":[[{"id":"f14b8765.ef1d28","port":0},{"id":"59397b97.3b9e44","port":0},{"id":"3521a15f.7a7e36","port":0}]],"x":360,"y":1000,"ylprc":"60","z":"822c4be8.2ccc28"},{"channel":"10","family":"14","id":"414a0708.adfc2","name":"","namespace":"variable","peerid":"34","refractoryperiod":"200","type":"variable-in","variable":"TEMPERATURE","variabletype":"device","wires":[[{"id":"da91e238.fffe58","port":1}]],"x":120,"y":980,"z":"822c4be8.2ccc28"},{"channel":"10","family":"14","id":"c79da753.843cc","name":"","namespace":"variable","peerid":"34","refractoryperiod":"200","type":"variable-in","variable":"CURRENT_SETPOINT","variabletype":"device","wires":[[{"id":"da91e238.fffe58","port":2}]],"x":140,"y":1030,"z":"822c4be8.2ccc28"},{"channel":"10","family":"14","id":"402efc0.a872384","name":"","namespace":"variable","peerid":"34","refractoryperiod":"200","type":"variable-in","variable":"CURRENT_SETPOINT","variabletype":"device","wires":[[{"id":"a2e63b0a.22ec28","port":0}]],"x":140,"y":1140,"z":"822c4be8.2ccc28"},{"func":"$t = $message['payload'];\nif($t == 16.0)\n{\n    $t = getNodeData(\"SETPOINT\");\n    if($t == 16.0 || !$t) $t = 21.0;\n    $message['payload'] = $t;\n    return $message;\n}\nelse setNodeData(\"SETPOINT\", $t);","id":"a2e63b0a.22ec28","inputs":1,"name":"","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[{"id":"7efa4f15.ce815","port":0}]],"x":370,"y":1140,"z":"822c4be8.2ccc28"},{"channel":"10","family":"14","id":"7efa4f15.ce815","name":"","namespace":"variable","peerid":"34","type":"variable-out","variable":"BASE_SETPOINT","variabletype":"device","wires":[],"x":610,"y":1140,"z":"822c4be8.2ccc28"},{"broker":"951b3e2.1a5d3c","id":"59397b97.3b9e44","name":"","namespace":"mqtt","retain":"true","topic":"nodeblue/1/plain/34/10/VALVE_STATE","type":"mqtt-out","wires":[],"x":620,"y":1050,"z":"822c4be8.2ccc28"},{"id":"5fef162b.e19ea8","info":"","name":"Solltemperaturaktualisierung","namespace":"comment","type":"comment","wires":[],"x":130,"y":1090,"z":"822c4be8.2ccc28"},{"channel":"10","family":"14","id":"c6eaaf26.a84cd","loopprevention":false,"looppreventiongroup":"4a09f7fb.c09be","name":"","namespace":"variable","outputonstartup":false,"peerid":"30","refractoryperiod":0,"type":"variable-in","variable":"TEMPERATURE","variabletype":"device","wires":[[{"id":"27a41df0.c63f7a","port":0}]],"x":120,"y":420,"z":"b9b74dfe.3575c"},{"channel":"11","family":"14","id":"801be67b.a2ae58","name":"","namespace":"variable","peerid":"30","type":"variable-out","variable":"SETPOINT_INFO","variabletype":"device","wires":[],"x":470,"y":420,"z":"b9b74dfe.3575c"},{"func":"$message['payload'] = 'Ist: '.round($message['payload'], 1).' \u00B0C';\nreturn $message;","id":"27a41df0.c63f7a","inputs":1,"name":"","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[{"id":"801be67b.a2ae58","port":0}]],"x":290,"y":420,"z":"b9b74dfe.3575c"},{"id":"e9f6ae2d.fbfb48","info":"","name":"Temperaturanzeige Wandthermostat","namespace":"comment","type":"comment","wires":[],"x":160,"y":370,"z":"b9b74dfe.3575c"},{"id":"b8ee012a.3aacc","info":"","name":"Heizungsregler","namespace":"comment","type":"comment","wires":[],"x":100,"y":470,"z":"b9b74dfe.3575c"},{"dutycyclemax":"100","dutycyclemin":"0","id":"bc20a151.c8bdb8","name":"","namespace":"timers","period":"1800","type":"slow-pwm","wires":[[{"id":"7798f7f9.1b8128","port":0}]],"x":545,"y":540,"z":"b9b74dfe.3575c"},{"channel":"3","family":"14","id":"7798f7f9.1b8128","name":"","namespace":"variable","peerid":"20","type":"variable-out","variable":"VALVE_STATE_INPUT","variabletype":"device","wires":[],"x":760,"y":540,"z":"b9b74dfe.3575c"},{"decalcificationday":"5","decalcificationhour":"12","heatingtype":"manual","id":"e442c274.52fa1","kp":"75","name":"","namespace":"heating","rcwlp":"1200","td":"180","tn":"14400","type":"heating-controller","uvalvelprc":"60","wires":[[{"id":"bc20a151.c8bdb8","port":0},{"id":"2a71dd34.71f782","port":0},{"id":"79e2e59a.5ceccc","port":0}]],"x":350,"y":540,"ylprc":"60","z":"b9b74dfe.3575c"},{"channel":"10","family":"14","id":"6a3a9806.8961c8","loopprevention":false,"looppreventiongroup":"4a09f7fb.c09be","name":"","namespace":"variable","outputonstartup":false,"peerid":"30","refractoryperiod":"200","type":"variable-in","variable":"TEMPERATURE","variabletype":"device","wires":[[{"id":"e442c274.52fa1","port":1}]],"x":120,"y":520,"z":"b9b74dfe.3575c"},{"channel":"10","family":"14","id":"491899b7.f37fd","loopprevention":false,"looppreventiongroup":"4a09f7fb.c09be","name":"","namespace":"variable","outputonstartup":false,"peerid":"30","refractoryperiod":"200","type":"variable-in","variable":"CURRENT_SETPOINT","variabletype":"device","wires":[[{"id":"e442c274.52fa1","port":2}]],"x":140,"y":570,"z":"b9b74dfe.3575c"},{"channel":"10","family":"14","id":"eb78752d.074758","name":"","namespace":"variable","peerid":"30","refractoryperiod":"200","type":"variable-in","variable":"CURRENT_SETPOINT","variabletype":"device","wires":[[{"id":"bed9bd9e.00f198","port":0}]],"x":140,"y":680,"z":"b9b74dfe.3575c"},{"func":"$t = $message['payload'];\nif($t == 16.0)\n{\n    $t = getNodeData(\"SETPOINT\");\n    if($t == 16.0 || !$t) $t = 21.0;\n    $message['payload'] = $t;\n    return $message;\n}\nelse setNodeData(\"SETPOINT\", $t);","id":"bed9bd9e.00f198","inputs":1,"name":"","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[{"id":"3a6dfcf8.e1b0cc","port":0}]],"x":370,"y":680,"z":"b9b74dfe.3575c"},{"channel":"10","family":"14","id":"3a6dfcf8.e1b0cc","name":"","namespace":"variable","peerid":"30","type":"variable-out","variable":"BASE_SETPOINT","variabletype":"device","wires":[],"x":610,"y":680,"z":"b9b74dfe.3575c"},{"broker":"951b3e2.1a5d3c","id":"2a71dd34.71f782","name":"","namespace":"mqtt","retain":"true","topic":"nodeblue/1/plain/30/10/VALVE_STATE","type":"mqtt-out","wires":[],"x":620,"y":590,"z":"b9b74dfe.3575c"},{"id":"6a3c9fed.64472","info":"","name":"Solltemperaturaktualisierung","namespace":"comment","type":"comment","wires":[],"x":130,"y":630,"z":"b9b74dfe.3575c"},{"id":"8ddfc859.70ab68","info":"* `19`: Hauptwandtaster\n* `50`: Wandtaster Nordost\n* `51`: Wandtaster Nordwest\n* `16`: Esstisch (Dimmer)\n* `72.1`: Strahler (ausser Schiefer)\n* `17.1`: Strahler (Schiefer)\n* `7.1`: Setzkaesten\n* `12.2`: Nordwestaussenwand\n* `12.1`: Nordostaussenwand\n* `3.4`: Fliesen-LEDs","name":"Lichter","namespace":"comment","type":"comment","wires":[],"x":80,"y":50,"z":"cc109e74.5fbec"},{"id":"8ca4e596.fd032","info":"","name":"Nachttischlampen","namespace":"comment","type":"comment","wires":[],"x":110,"y":480,"z":"822c4be8.2ccc28"},{"channel":"2","family":"14","id":"1368c0ff.79e66f","name":"","namespace":"variable","peerid":"34","refractoryperiod":0,"type":"variable-in","variable":"STATE","variabletype":"device","wires":[[{"id":"2c68dc8c.bcc2d4","port":0},{"id":"73c8de0d.09aa88","port":0}]],"x":100,"y":530,"z":"822c4be8.2ccc28"},{"channel":"2","family":"15","id":"d5799b84.f94db8","loopprevention":false,"looppreventiongroup":"cab7665b.af1d4","name":"","namespace":"variable","outputonstartup":false,"peerid":"61","refractoryperiod":"1000","type":"variable-in","variable":"STATE","variabletype":"device","wires":[[{"id":"c0196811.057f2","port":0}]],"x":95,"y":580,"z":"822c4be8.2ccc28"},{"channel":"1","family":"15","id":"421aadd2.1453bc","loopprevention":false,"looppreventiongroup":"cab7665b.af1d4","name":"","namespace":"variable","outputonstartup":false,"peerid":"61","refractoryperiod":"1000","type":"variable-in","variable":"STATE","variabletype":"device","wires":[[{"id":"3e39bd71.2271da","port":0}]],"x":95,"y":680,"z":"822c4be8.2ccc28"},{"channel":"1","factor":"","family":"5","id":"2c68dc8c.bcc2d4","inputs":1,"interval":"","lighttype":"switch","maxvalue":"","minvalue":"","name":"","namespace":"light","offvalue":"0","offvalue2":"","onvalue":"100","peerid":"70","step":"","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":505,"y":530,"z":"822c4be8.2ccc28"},{"channel":"1","family":"14","id":"f6dfde4e.29692","loopprevention":true,"looppreventiongroup":"dfc2bc9b.417f1","name":"","namespace":"variable","outputonstartup":false,"peerid":"19","refractoryperiod":"0","type":"variable-in","variable":"SPOTS_NONSLATE","variabletype":"device","wires":[[{"id":"fe57daac.b3526","port":0}]],"x":130,"y":100,"z":"cc109e74.5fbec"},{"channel":"1","family":"14","id":"64602c61.0176e4","name":"","namespace":"variable","peerid":"50","refractoryperiod":"0","type":"variable-in","variable":"STATE","variabletype":"device","wires":[[{"id":"f776bd7f.5cbd5","port":0}]],"x":100,"y":1940,"z":"cc109e74.5fbec"},{"channel":"1","factor":"0.03","family":"11","id":"f776bd7f.5cbd5","inputs":1,"interval":"100","lighttype":"switch","maxvalue":"100","minvalue":"15","name":"","namespace":"light","offvalue":"0","offvalue2":"0","onvalue":"100","peerid":"7","step":"1","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":680,"y":1940,"z":"cc109e74.5fbec"},{"channel":"1","family":"14","id":"8f091ed7.1a9408","name":"","namespace":"variable","peerid":"51","refractoryperiod":"0","type":"variable-in","variable":"DIM_STEP.RAW","variabletype":"device","wires":[[{"id":"e44a1fd4.536a2","port":0}]],"x":120,"y":2090,"z":"cc109e74.5fbec"},{"channel":"1","family":"14","id":"ca6a74a4.c52aa","name":"","namespace":"variable","peerid":"51","refractoryperiod":"0","type":"variable-in","variable":"STATE","variabletype":"device","wires":[[{"id":"62e25804.e62ff","port":0}]],"x":100,"y":2040,"z":"cc109e74.5fbec"},{"channel":"2","family":"14","id":"ee20ace.f282bd","name":"","namespace":"variable","peerid":"51","refractoryperiod":"0","type":"variable-in","variable":"STATE","variabletype":"device","wires":[[{"id":"a789c31d.748a1","port":0}]],"x":100,"y":2140,"z":"cc109e74.5fbec"},{"channel":"2","factor":"0.03","family":"11","id":"a789c31d.748a1","inputs":1,"interval":"100","lighttype":"switch","maxvalue":"100","minvalue":"15","name":"","namespace":"light","offvalue":"0","offvalue2":"0","onvalue":"100","peerid":"12","step":"1","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":680,"y":2140,"z":"cc109e74.5fbec"},{"channel":"2","family":"14","id":"596b325a.6222ec","name":"","namespace":"variable","peerid":"50","refractoryperiod":"0","type":"variable-in","variable":"STATE","variabletype":"device","wires":[[{"id":"c112bf25.2ce8b","port":0}]],"x":100,"y":1990,"z":"cc109e74.5fbec"},{"channel":"1","factor":"0.03","family":"11","id":"c112bf25.2ce8b","inputs":1,"interval":"100","lighttype":"switch","maxvalue":"100","minvalue":"15","name":"","namespace":"light","offvalue":"0","offvalue2":"0","onvalue":"100","peerid":"12","step":"1","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":680,"y":1990,"z":"cc109e74.5fbec"},{"channel":"1","family":"14","id":"16d6fc0.3793904","loopprevention":false,"looppreventiongroup":"","name":"","namespace":"variable","outputonstartup":false,"peerid":"19","refractoryperiod":"0","type":"variable-in","variable":"SCENE_OFF","variabletype":"device","wires":[[{"id":"5a26b9a.a3bd6c8","port":0},{"id":"d9bbce11.10043","port":0}]],"x":110,"y":1600,"z":"cc109e74.5fbec"},{"channel":"1","factor":"0.01","family":"11","id":"62e25804.e62ff","inputs":3,"interval":"50","lighttype":"dimmer","maxvalue":"10000.0","minvalue":"2000.0","name":"","namespace":"light","offvalue":"0","offvalue2":"0.0","onvalue":"100","peerid":"16","step":"1","twoinputs":false,"type":"light","variable":"LEVEL","variabletype":"device","wires":[],"x":680,"y":2060,"z":"cc109e74.5fbec"},{"channel":"11","family":"14","id":"db277a68.5423d8","loopprevention":false,"looppreventiongroup":"dfc2bc9b.417f1","name":"","namespace":"variable","outputonstartup":false,"peerid":"19","refractoryperiod":"0","type":"variable-in","variable":"PLAY","variabletype":"device","wires":[[{"id":"48e25d1a.6d4acc","port":0}]],"x":90,"y":2240,"z":"cc109e74.5fbec"},{"id":"2998452a.f86272","info":"","name":"Sonos","namespace":"comment","type":"comment","wires":[],"x":80,"y":2190,"z":"cc109e74.5fbec"},{"channel":"1","family":"14","id":"434cd4a4.a35bd4","name":"","namespace":"variable","peerid":"29","refractoryperiod":"0","type":"variable-in","variable":"DIM_STEP.RAW","variabletype":"device","wires":[[{"id":"b17fd372.54d45","port":0}]],"x":120,"y":490,"z":"302d5ee5.37b1aa"},{"id":"21dc9218.db4ec6","info":"* `19`: Wandtaster\n* `15`: Deckenlicht\n* `3.4`: Fliesen-LEDs\n* `28.1`: Haengeschraenke","name":"Lichter","namespace":"comment","type":"comment","wires":[],"x":80,"y":50,"z":"302d5ee5.37b1aa"},{"channel":"1","family":"14","id":"adf4a542.d244e","name":"","namespace":"variable","peerid":"29","refractoryperiod":"0","type":"variable-in","variable":"STATE","variabletype":"device","wires":[[{"id":"117d679a.8d231","port":0}]],"x":100,"y":440,"z":"302d5ee5.37b1aa"},{"channel":"1","factor":"0.01","family":"11","id":"117d679a.8d231","inputs":3,"interval":"50","lighttype":"dimmer","maxvalue":"10000.0","minvalue":"2000.0","name":"","namespace":"light","offvalue":"0","offvalue2":"0.0","onvalue":"100","peerid":"15","step":"1","twoinputs":false,"type":"light","variable":"LEVEL","variabletype":"device","wires":[],"x":1030,"y":460,"z":"302d5ee5.37b1aa"},{"id":"b6821584.3cdd3","info":"","name":"Deckenlicht","namespace":"comment","type":"comment","wires":[],"x":90,"y":50,"z":"4d2cb67e.e7f9b"},{"channel":"1","family":"14","id":"2658153f.21c7a2","name":"","namespace":"variable","peerid":"30","refractoryperiod":"0","type":"variable-in","variable":"STATE","variabletype":"device","wires":[[{"id":"184333e3.d270f4","port":0}]],"x":100,"y":100,"z":"b9b74dfe.3575c"},{"channel":"2","factor":"0.03","family":"11","id":"1c41d7b8.d980c8","inputs":1,"interval":"100","lighttype":"switch","maxvalue":"100","minvalue":"15","name":"","namespace":"light","offvalue":"0","offvalue2":"0","onvalue":"100","peerid":"3","step":"1","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":910,"y":100,"z":"b9b74dfe.3575c"},{"id":"9505ed59.3a8738","info":"","name":"Deckenlicht","namespace":"comment","type":"comment","wires":[],"x":90,"y":50,"z":"b9b74dfe.3575c"},{"id":"1754574b.d730d9","info":"","name":"Deckenlicht","namespace":"comment","type":"comment","wires":[],"x":90,"y":50,"z":"9cd3b032.f95e28"},{"changes-only":false,"checkall":"false","id":"4f865d75.03262c","inputs":1,"name":"","namespace":"basic-logic","output-false":false,"output-true":true,"outputs":3,"property":"payload","rules":[{"t":"eq","v":"9","vt":"int"},{"t":"eq","v":"1","vt":"int"},{"t":"else"}],"type":"switch","wires":[[],[],[{"id":"6454a276.ab605c","port":0}]],"x":210,"y":90,"z":"8dfedcf0.6ae18"},{"id":"6454a276.ab605c","name":"","namespace":"basic-logic","type":"not","wires":[[]],"x":360,"y":140,"z":"8dfedcf0.6ae18"},{"id":"e44a1fd4.536a2","namespace":"subflow:8dfedcf0.6ae18","type":"subflow:8dfedcf0.6ae18","wires":[[{"id":"62e25804.e62ff","port":1}],[{"id":"62e25804.e62ff","port":2}]],"x":340,"y":2070,"z":"cc109e74.5fbec"},{"id":"b17fd372.54d45","name":"","namespace":"subflow:8dfedcf0.6ae18","type":"subflow:8dfedcf0.6ae18","wires":[[{"id":"117d679a.8d231","port":1}],[{"id":"117d679a.8d231","port":2}]],"x":360,"y":470,"z":"302d5ee5.37b1aa"},{"channel":"1","family":"14","id":"20fc088c.cc449","name":"","namespace":"variable","peerid":"34","refractoryperiod":"0","type":"variable-in","variable":"DIM_STEP.RAW","variabletype":"device","wires":[[{"id":"d9af6192.b1aa1","port":0}]],"x":120,"y":150,"z":"822c4be8.2ccc28"},{"channel":"1","factor":"0.01","family":"11","id":"3dba1c03.3be4fc","inputs":3,"interval":"50","lighttype":"dimmer","maxvalue":"10000.0","minvalue":"1100.0","name":"","namespace":"light","offvalue":"0","offvalue2":"0.0","onvalue":"100","peerid":"43","step":"1","twoinputs":false,"type":"light","variable":"LEVEL","variabletype":"device","wires":[],"x":680,"y":120,"z":"822c4be8.2ccc28"},{"id":"d9af6192.b1aa1","namespace":"subflow:8dfedcf0.6ae18","type":"subflow:8dfedcf0.6ae18","wires":[[{"id":"3dba1c03.3be4fc","port":1}],[{"id":"3dba1c03.3be4fc","port":2}]],"x":340,"y":130,"z":"822c4be8.2ccc28"},{"channel":"3","family":"14","id":"b4e71c5b.91422","name":"","namespace":"variable","peerid":"34","refractoryperiod":"0","type":"variable-in","variable":"STATE","variabletype":"device","wires":[[{"id":"3df3fab9.16a526","port":0},{"id":"e2a18ca6.203318","port":0}]],"x":100,"y":200,"z":"822c4be8.2ccc28"},{"channel":"4","factor":"","family":"11","id":"3df3fab9.16a526","inputs":1,"interval":"","lighttype":"switch","maxvalue":"","minvalue":"","name":"","namespace":"light","offvalue":"0","offvalue2":"","onvalue":"100","peerid":"4","step":"","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":680,"y":200,"z":"822c4be8.2ccc28"},{"channel":"1","family":"14","id":"77470f3e.48a028","name":"","namespace":"variable","peerid":"35","refractoryperiod":"0","type":"variable-in","variable":"STATE","variabletype":"device","wires":[[]],"x":100,"y":100,"z":"69ea3b1f.befffc"},{"channel":"1","family":"14","id":"befc866e.4d186","name":"","namespace":"variable","peerid":"36","refractoryperiod":"0","type":"variable-in","variable":"STATE","variabletype":"device","wires":[[]],"x":100,"y":150,"z":"69ea3b1f.befffc"},{"channel":"1","family":"14","id":"3110840c.242d3c","name":"","namespace":"variable","peerid":"37","refractoryperiod":"0","type":"variable-in","variable":"STATE","variabletype":"device","wires":[[]],"x":100,"y":200,"z":"69ea3b1f.befffc"},{"channel":"1","family":"14","id":"ba8de970.12c1b","loopprevention":false,"looppreventiongroup":"4a09f7fb.c09be","name":"","namespace":"variable","outputonstartup":false,"peerid":"94","refractoryperiod":"0","type":"variable-in","variable":"STATE","variabletype":"device","wires":[[{"id":"200e60c.8db8da","port":0}]],"x":100,"y":300,"z":"69ea3b1f.befffc"},{"channel":"1","factor":"0.01","family":"11","id":"8b96a942.b74918","inputs":3,"interval":"50","lighttype":"dimmer","maxvalue":"10000.0","minvalue":"1100.0","name":"","namespace":"light","offvalue":"0","offvalue2":"0.0","onvalue":"100","peerid":"43","step":"1","twoinputs":false,"type":"light","variable":"LEVEL","variabletype":"device","wires":[],"x":645,"y":290,"z":"69ea3b1f.befffc"},{"id":"53e00116.9f6b48","info":"* `35`: Schalter unten\n* `36`: Schalter 1. OG nach unten\n* `37`: Schalter 1. OG nach oben\n* `94`: Schalter oben\n* `43`: Deckenlicht Schlafzimmer\n* `2.3`: Treppen-LEDs\n* `1.4`: Wandlampe unten\n* `2.4`: Wandlampe oben\n* `1.3`: (1. OG Flur)","name":"Licht","namespace":"comment","type":"comment","wires":[],"x":80,"y":50,"z":"69ea3b1f.befffc"},{"func":"$hg->setValue(1, 4, \"STATE\", \"!\");\n$hg->setValue(2, 3, \"STATE\", \"!\");\n$hg->setValue(2, 4, \"STATE\", \"!\");\nreturn array('payload' => $hg->getValue(1, 4, \"STATE\"));","id":"2a531dff.e88f0a","inputs":1,"name":"Treppenhauslicht-Umschalter","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[{"id":"b470e2ce.0eebc8","port":0}]],"x":610,"y":150,"z":"69ea3b1f.befffc"},{"channel":"2","family":"14","id":"bff1b9ed.791528","name":"","namespace":"variable","peerid":"38","refractoryperiod":"0","type":"variable-in","variable":"STATE","variabletype":"device","wires":[[]],"x":100,"y":250,"z":"69ea3b1f.befffc"},{"apr":true,"aug":true,"dec":true,"endoff":"0","feb":true,"fri":true,"id":"baf55df4.d97de","jan":true,"jul":true,"jun":true,"lat":"54.28438","lon":"10.17234","mar":true,"may":true,"mon":true,"name":"","namespace":"timers","nov":true,"oct":true,"offtime":"02:00","offtimetype":"time","ontime":"05:00","ontimetype":"time","sat":true,"sep":true,"startoff":"0","startup":false,"sun":true,"thu":true,"tue":true,"type":"timer","wed":true,"wires":[[{"id":"61c30a7f.974664","port":1}]],"x":80,"y":680,"z":"e75b7fd7.a33d6"},{"func":"if($inputIndex == 0)\n{\n    setNodeData('STATE', $message['payload']);\n}\nelse\n{\n    $state = getNodeData('STATE');\n    if(!$message['payload'])\n    {\n        if($message['payload'] != $state) return $message;\n    }\n    else\n    {\n        if($message['payload'] == $state) return $message;\n    }\n}\n","id":"61c30a7f.974664","inputs":"2","name":"","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[{"id":"afabef4b.0ac4c","port":0},{"id":"162f0333.79fa65","port":0},{"id":"2d3527a1.5e5938","port":0},{"id":"f473f662.73e788","port":0},{"id":"4497479c.13de3","port":0}]],"x":220,"y":680,"z":"e75b7fd7.a33d6"},{"id":"7e84c974.a0b698","info":"","name":"Luefter","namespace":"comment","type":"comment","wires":[],"x":80,"y":250,"z":"4d2cb67e.e7f9b"},{"channel":"1","family":"15","id":"cda94019.9ab6","name":"","namespace":"variable","peerid":"52","refractoryperiod":"0","type":"variable-in","variable":"HUMIDITY","variabletype":"device","wires":[[{"id":"78005caf.c9472c","port":0}]],"x":110,"y":300,"z":"4d2cb67e.e7f9b"},{"changes-only":true,"checkall":"true","id":"78005caf.c9472c","inputs":1,"name":"","namespace":"basic-logic","output-false":true,"output-true":true,"outputs":1,"property":"payload","rules":[{"t":"gte","v":"60","vt":"int"}],"type":"switch","wires":[[{"id":"baaf1d87.1aa62","port":0}]],"x":270,"y":300,"z":"4d2cb67e.e7f9b"},{"channel":"3","family":"11","id":"baaf1d87.1aa62","name":"","namespace":"variable","peerid":"12","type":"variable-out","variable":"STATE","variabletype":"device","wires":[],"x":670,"y":300,"z":"4d2cb67e.e7f9b"},{"channel":"1","family":"15","id":"3afa5e8d.1488ea","name":"","namespace":"variable","peerid":"74","refractoryperiod":"200","type":"variable-in","variable":"HUMIDITY","variabletype":"device","wires":[[{"id":"5e623f2c.aaa9f","port":0}]],"x":110,"y":650,"z":"5e7e747b.a20d9c"},{"changes-only":true,"checkall":"true","id":"5e623f2c.aaa9f","inputs":1,"name":">= 60","namespace":"basic-logic","output-false":true,"output-true":true,"outputs":1,"property":"payload","rules":[{"t":"gte","v":"65.0","vt":"float"}],"type":"switch","wires":[[{"id":"6460c7a9.5ea87","port":0},{"id":"ce5e0367.6a7068","port":0}]],"x":280,"y":650,"z":"5e7e747b.a20d9c"},{"apr":true,"aug":true,"dec":true,"endoff":"+15","feb":true,"fri":true,"id":"c22c3978.bb82f8","jan":true,"jul":true,"jun":true,"lat":"54.28502","lon":"10.1502","mar":true,"may":true,"mon":true,"name":"","namespace":"timers","nov":true,"oct":true,"offtime":"sunrise","offtimetype":"suntime","ontime":"sunset","ontimetype":"suntime","sat":true,"sep":true,"startoff":"-15","startup":true,"sun":true,"thu":true,"tue":true,"type":"timer","wed":true,"wires":[[{"id":"5a242994.0f8e38","port":0}]],"x":80,"y":220,"z":"1755f935.cee76f"},{"id":"2a6127f4.61a558","info":"","name":"Zuschaltung Sonos","namespace":"comment","type":"comment","wires":[],"x":110,"y":730,"z":"b9b74dfe.3575c"},{"channel":"3","family":"14","id":"ca08f9c5.d5505","name":"","namespace":"variable","peerid":"76","refractoryperiod":"5000","type":"variable-in","variable":"MOTION","variabletype":"device","wires":[[{"id":"63cd6d37.f9597c","port":0}]],"x":100,"y":780,"z":"b9b74dfe.3575c"},{"func":"if($inputIndex == 0)\n{\n    if(getNodeData('added')) return NULL;\n    setNodeData('added', true);\n    $hg->setValue(25, 1, 'ADD_SPEAKER', 73);\n    $hg->setValue(73, 1, 'VOLUME', 12);\n}\nelse\n{\n    if(!getNodeData('added')) return NULL;\n    setNodeData('added', false);\n    $hg->setValue(25, 1, 'REMOVE_SPEAKER', 73);\n}","id":"cd9985d6.fa6e","inputs":"2","name":"","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[]],"x":560,"y":790,"z":"b9b74dfe.3575c"},{"id":"354c22a3.bb7d4e","interval":"5000","name":"","namespace":"timers","resetafter":"180000","type":"interval","wires":[[],[{"id":"cd9985d6.fa6e","port":1}]],"x":400,"y":790,"z":"b9b74dfe.3575c"},{"changes-only":false,"checkall":"true","id":"63cd6d37.f9597c","inputs":1,"name":"is true","namespace":"basic-logic","output-false":false,"output-true":false,"outputs":1,"property":"payload","rules":[{"t":"true"}],"type":"switch","wires":[[{"id":"354c22a3.bb7d4e","port":0},{"id":"cd9985d6.fa6e","port":0},{"id":"354c22a3.bb7d4e","port":1}]],"x":260,"y":780,"z":"b9b74dfe.3575c"},{"field":"","format":"handlebars","id":"ab5ab8ed.9520c","name":"","namespace":"template","output":"json","syntax":"mustache","template":"{\"payload\":100}","type":"template","wires":[[{"id":"3d53d13.d2838ae","port":0}]],"x":550,"y":640,"z":"5e7e747b.a20d9c"},{"changes-only":false,"checkall":"false","id":"ce5e0367.6a7068","inputs":1,"name":"","namespace":"basic-logic","output-false":false,"output-true":false,"outputs":2,"property":"payload","rules":[{"t":"true"},{"t":"false"}],"type":"switch","wires":[[{"id":"ab5ab8ed.9520c","port":0}],[{"id":"34c7a2c.2a35cde","port":0}]],"x":410,"y":650,"z":"5e7e747b.a20d9c"},{"field":"","format":"handlebars","id":"34c7a2c.2a35cde","name":"","namespace":"template","output":"json","syntax":"mustache","template":"{\"payload\":0}","type":"template","wires":[[{"id":"3d53d13.d2838ae","port":0}]],"x":550,"y":690,"z":"5e7e747b.a20d9c"},{"channel":"14","family":"14","id":"3d53d13.d2838ae","name":"","namespace":"variable","peerid":"33","type":"variable-out","variable":"STATE","variabletype":"device","wires":[],"x":760,"y":640,"z":"5e7e747b.a20d9c"},{"func":"if($inputIndex == 0) setNodeData('t', $message['payload']);\nelse setNodeData('h', $message['payload']);\n\n$message['payload'] = round(getNodeData('t'), 1).'\u00B0C / '.round(getNodeData('h'), 0).'%';\nreturn $message;","id":"f1a16cf6.3737d","inputs":"2","name":"","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[{"id":"9e000a70.9256d","port":0}]],"x":350,"y":840,"z":"822c4be8.2ccc28"},{"channel":"1","family":"15","id":"531ad080.a61028","name":"","namespace":"variable","peerid":"75","refractoryperiod":"200","type":"variable-in","variable":"HUMIDITY","variabletype":"device","wires":[[{"id":"f1a16cf6.3737d","port":1}]],"x":110,"y":880,"z":"822c4be8.2ccc28"},{"channel":"3","family":"14","id":"ac075d04.51d198","name":"","namespace":"variable","peerid":"78","refractoryperiod":"0","type":"variable-in","variable":"MOTION","variabletype":"device","wires":[[{"id":"2159e08c.dc3cb8","port":0}]],"x":100,"y":200,"z":"e75b7fd7.a33d6"},{"id":"3dcef173.939806","name":"","namespace":"timers","off-delay":"180000","type":"off-delay","wires":[[{"id":"2a6b7442.926964","port":0}],[]],"x":980,"y":210,"z":"e75b7fd7.a33d6"},{"channel":"3","family":"14","id":"e139b459.ea28f8","name":"","namespace":"variable","peerid":"76","refractoryperiod":"0","type":"variable-in","variable":"MOTION","variabletype":"device","wires":[[{"id":"f91cef31.221e48","port":0}]],"x":100,"y":220,"z":"b9b74dfe.3575c"},{"id":"4808bb60.328bac","name":"","namespace":"timers","off-delay":"180000","type":"off-delay","wires":[[{"id":"5599110b.c64588","port":0}],[]],"x":840,"y":230,"z":"b9b74dfe.3575c"},{"func":"if($inputIndex == 0)\n{\n    $manual = getFlowData('light.1.1.manual');\n    if($message['payload'])\n    {\n        if($manual == 0)\n        {\n            setFlowData('light.1.1.manual', 1);\n            $hg->setValue(39, 1, 'LED_STATE', 100);\n            return array($message, array('payload' => false));\n        }\n        else if($manual == -1)\n        {\n            setFlowData('light.1.1.manual', 0);\n            $hg->setValue(39, 1, 'LED_STATE', 0);\n            return array($message, NULL);\n        }\n    }\n    else\n    {\n        if($manual == 1)\n        {\n            setFlowData('light.1.1.manual', 0);\n            $hg->setValue(39, 1, 'LED_STATE', 0);\n            return array(NULL, array('payload' => true));\n        }\n        else if($manual == 0)\n        {\n            setFlowData('light.1.1.manual', -1);\n            $hg->setValue(39, 1, 'LED_STATE', 1);\n            return array($message, array('payload' => true));\n        }\n    }\n}\nelse if(!$message['payload'] && getFlowData('light.1.1.manual') == 1)\n{\n    setFlowData('light.1.1.manual', 0);\n    $hg->setValue(39, 1, 'LED_STATE', 0);\n    return array($message, array('payload' => true));\n}","id":"85dcf59.9e05108","inputs":"2","name":"","namespace":"function","noerr":0,"outputs":"2","type":"function","wires":[[{"id":"2a6b7442.926964","port":0}],[{"id":"9b7f6d40.5f4938","port":0}]],"x":520,"y":110,"z":"e75b7fd7.a33d6"},{"id":"9b7f6d40.5f4938","name":"","namespace":"timers","off-delay":"14400000","type":"off-delay","wires":[[{"id":"85dcf59.9e05108","port":1}],[]],"x":650,"y":140,"z":"e75b7fd7.a33d6"},{"func":"if($inputIndex == 0)\n{\n    $manual = getFlowData('light.3.2.manual');\n    if($message['payload'])\n    {\n        if($manual == 0)\n        {\n            setFlowData('light.3.2.manual', 1);\n            $hg->setValue(30, 1, 'LED_STATE', 100);\n            return array($message, array('payload' => false));\n        }\n        else if($manual == -1)\n        {\n            setFlowData('light.3.2.manual', 0);\n            $hg->setValue(30, 1, 'LED_STATE', 0);\n            return array($message, NULL);\n        }\n    }\n    else\n    {\n        if($manual == 1)\n        {\n            setFlowData('light.3.2.manual', 0);\n            $hg->setValue(30, 1, 'LED_STATE', 0);\n            return array(NULL, array('payload' => true));\n        }\n        else if($manual == 0)\n        {\n            setFlowData('light.3.2.manual', -1);\n            $hg->setValue(30, 1, 'LED_STATE', 1);\n            return array($message, array('payload' => true));\n        }\n    }\n}\nelse if(!$message['payload'] && getFlowData('light.3.2.manual') == 1)\n{\n    setFlowData('light.3.2.manual', 0);\n    $hg->setValue(30, 1, 'LED_STATE', 0);\n    return array($message, array('payload' => true));\n}","id":"184333e3.d270f4","inputs":"2","name":"","namespace":"function","noerr":0,"outputs":2,"type":"function","wires":[[{"id":"5599110b.c64588","port":0}],[{"id":"f7606aa4.cb2458","port":0}]],"x":300,"y":110,"z":"b9b74dfe.3575c"},{"id":"f7606aa4.cb2458","name":"","namespace":"timers","off-delay":"14400000","type":"off-delay","wires":[[{"id":"184333e3.d270f4","port":1}],[]],"x":480,"y":160,"z":"b9b74dfe.3575c"},{"changes-only":false,"checkall":"true","id":"2a6b7442.926964","inputs":1,"name":"","namespace":"basic-logic","output-false":false,"output-true":false,"outputs":1,"property":"payload","rules":[{"t":"nnull"}],"type":"switch","wires":[[{"id":"560b2276.91011c","port":0}]],"x":810,"y":100,"z":"e75b7fd7.a33d6"},{"changes-only":false,"checkall":"true","id":"5599110b.c64588","inputs":1,"name":"","namespace":"basic-logic","output-false":false,"output-true":false,"outputs":1,"property":"payload","rules":[{"t":"nnull"}],"type":"switch","wires":[[{"id":"1c41d7b8.d980c8","port":0},{"id":"14643676.22248a","port":0}]],"x":580,"y":100,"z":"b9b74dfe.3575c"},{"channel":"2","family":"11","id":"ef8fce74.f87158","name":"","namespace":"variable","peerid":"18","refractoryperiod":"10","type":"variable-in","variable":"STATE","variabletype":"device","wires":[[{"id":"e1413254.5f7b2","port":0},{"id":"c0b1bd2.ba1c24","port":0}]],"x":100,"y":100,"z":"1d6097ff.a1be1"},{"id":"cca9b9aa.fd297","info":"","name":"Deckenlicht","namespace":"comment","type":"comment","wires":[],"x":90,"y":50,"z":"1d6097ff.a1be1"},{"channel":"3","factor":"0.03","family":"11","id":"e1413254.5f7b2","inputs":1,"interval":"100","lighttype":"switch","maxvalue":"100","minvalue":"15","name":"","namespace":"light","offvalue":"0","offvalue2":"0","onvalue":"100","peerid":"4","step":"1","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":760,"y":100,"z":"1d6097ff.a1be1"},{"channel":"2","family":"14","id":"2089486d.e0338","loopprevention":false,"looppreventiongroup":"4a09f7fb.c09be","name":"Gaeste-WC Praesenz","namespace":"variable","outputonstartup":false,"peerid":"76","refractoryperiod":"0","type":"variable-in","variable":"MOTION","variabletype":"device","wires":[[{"id":"554a7db4.da993c","port":0}]],"x":110,"y":380,"z":"1755f935.cee76f"},{"channel":"2","family":"14","id":"f805e0a4.9e44b8","loopprevention":false,"looppreventiongroup":"4a09f7fb.c09be","name":"Suedzimmer Praesenz","namespace":"variable","outputonstartup":false,"peerid":"77","refractoryperiod":"0","type":"variable-in","variable":"MOTION","variabletype":"device","wires":[[{"id":"bcc2e816.6ee68","port":0}]],"x":110,"y":430,"z":"1755f935.cee76f"},{"channel":"2","family":"14","id":"695d6f58.e8e62","loopprevention":false,"looppreventiongroup":"4a09f7fb.c09be","name":"EG Flur Praesenz","namespace":"variable","outputonstartup":false,"peerid":"78","refractoryperiod":"0","type":"variable-in","variable":"MOTION","variabletype":"device","wires":[[{"id":"3f7d1ce.be5c9e4","port":0}]],"x":100,"y":480,"z":"1755f935.cee76f"},{"changes-only":false,"id":"7639a51f.cabbcc","inputs":"6","name":"","namespace":"basic-logic","output-false":true,"type":"and","wires":[[]],"x":430,"y":450,"z":"1755f935.cee76f"},{"id":"7a6aa8bc.1ff57","name":"","namespace":"basic-logic","type":"not","wires":[[{"id":"7639a51f.cabbcc","port":0}]],"x":280,"y":330,"z":"1755f935.cee76f"},{"id":"554a7db4.da993c","name":"","namespace":"basic-logic","type":"not","wires":[[{"id":"7639a51f.cabbcc","port":1}]],"x":280,"y":380,"z":"1755f935.cee76f"},{"id":"bcc2e816.6ee68","name":"","namespace":"basic-logic","type":"not","wires":[[{"id":"7639a51f.cabbcc","port":2}]],"x":280,"y":430,"z":"1755f935.cee76f"},{"id":"3f7d1ce.be5c9e4","name":"","namespace":"basic-logic","type":"not","wires":[[{"id":"7639a51f.cabbcc","port":3}]],"x":280,"y":480,"z":"1755f935.cee76f"},{"id":"c8b10c32.fc1a08","info":"","name":"Nachtvariable setzen","namespace":"comment","type":"comment","wires":[],"x":120,"y":170,"z":"1755f935.cee76f"},{"id":"a9d97282.d5aaa8","info":"","name":"Schlafmodus setzen","namespace":"comment","type":"comment","wires":[],"x":110,"y":280,"z":"1755f935.cee76f"},{"channel":"2","family":"14","id":"7665e70d.556348","name":"","namespace":"variable","peerid":"29","refractoryperiod":"0","type":"variable-in","variable":"STATE","variabletype":"device","wires":[[{"id":"d96c248d.5d5d48","port":0}]],"x":100,"y":100,"z":"302d5ee5.37b1aa"},{"channel":"1","factor":"","family":"15","id":"4541b19a.ff1c7","inputs":1,"interval":"","lighttype":"switch","maxvalue":"","minvalue":"","name":"","namespace":"light","offvalue":"0","offvalue2":"","onvalue":"100","peerid":"28","step":"","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":1030,"y":100,"z":"302d5ee5.37b1aa"},{"channel":"3","family":"14","id":"a03d0099.99eae8","name":"","namespace":"variable","peerid":"82","refractoryperiod":"0","type":"variable-in","variable":"MOTION","variabletype":"device","wires":[[{"id":"6ad99bfe.08cfb4","port":0}]],"x":100,"y":200,"z":"302d5ee5.37b1aa"},{"id":"39fa65aa.e2791a","name":"","namespace":"timers","off-delay":"180000","type":"off-delay","wires":[[{"id":"4fd0aafe.1d939c","port":0}],[]],"x":890,"y":210,"z":"302d5ee5.37b1aa"},{"func":"if($inputIndex == 0)\n{\n    $manual = getFlowData('light.28.1.manual');\n    if($message['payload'])\n    {\n        if($manual == 0)\n        {\n            setFlowData('light.28.1.manual', 1);\n            $hg->setValue(29, 2, 'LED_STATE', 100);\n            return array($message, array('payload' => false));\n        }\n        else if($manual == -1)\n        {\n            setFlowData('light.28.1.manual', 0);\n            $hg->setValue(29, 2, 'LED_STATE', 0);\n            return array($message, NULL);\n        }\n    }\n    else\n    {\n        if($manual == 1)\n        {\n            setFlowData('light.28.1.manual', 0);\n            $hg->setValue(29, 2, 'LED_STATE', 0);\n            return array(NULL, array('payload' => true));\n        }\n        else if($manual == 0)\n        {\n            setFlowData('light.28.1.manual', -1);\n            $hg->setValue(29, 2, 'LED_STATE', 1);\n            return array($message, array('payload' => true));\n        }\n    }\n}\nelse if(!$message['payload'] && getFlowData('light.28.1.manual') == 1)\n{\n    setFlowData('light.28.1.manual', 0);\n    $hg->setValue(29, 2, 'LED_STATE', 0);\n    return array($message, array('payload' => true));\n}","id":"d96c248d.5d5d48","inputs":"2","name":"","namespace":"function","noerr":0,"outputs":"2","type":"function","wires":[[{"id":"4fd0aafe.1d939c","port":0}],[{"id":"b15dc72d.7d7a9","port":0}]],"x":440,"y":110,"z":"302d5ee5.37b1aa"},{"id":"b15dc72d.7d7a9","name":"","namespace":"timers","off-delay":"14400000","type":"off-delay","wires":[[{"id":"d96c248d.5d5d48","port":1}],[]],"x":650,"y":140,"z":"302d5ee5.37b1aa"},{"changes-only":false,"checkall":"true","id":"4fd0aafe.1d939c","inputs":1,"name":"","namespace":"basic-logic","output-false":false,"output-true":false,"outputs":1,"property":"payload","rules":[{"t":"nnull"}],"type":"switch","wires":[[{"id":"4541b19a.ff1c7","port":0},{"id":"117d679a.8d231","port":0}]],"x":810,"y":100,"z":"302d5ee5.37b1aa"},{"id":"efd83737.044538","name":"","namespace":"basic-logic","type":"not","wires":[[{"id":"7639a51f.cabbcc","port":4}]],"x":280,"y":530,"z":"1755f935.cee76f"},{"channel":"2","factor":"","family":"11","id":"38779491.2f67e4","inputs":1,"interval":"","lighttype":"switch","maxvalue":"","minvalue":"","name":"","namespace":"light","offvalue":"0","offvalue2":"","onvalue":"100","peerid":"2","step":"","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":725,"y":150,"z":"3050d780.509968"},{"channel":"3","factor":"","family":"11","id":"34864f4.a4044b","inputs":1,"interval":"","lighttype":"switch","maxvalue":"","minvalue":"","name":"","namespace":"light","offvalue":"0","offvalue2":"","onvalue":"100","peerid":"4","step":"","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":725,"y":450,"z":"3050d780.509968"},{"channel":"1","family":"11","id":"9a8ab35d.fee008","name":"","namespace":"variable","peerid":"18","refractoryperiod":"10","type":"variable-in","variable":"STATE","variabletype":"device","wires":[[{"id":"a3de26e5.33268","port":0},{"id":"c738dc62.54289","port":0}]],"x":100,"y":100,"z":"71b14382.55983c"},{"id":"6e33e35b.96a2e4","info":"","name":"Licht","namespace":"comment","type":"comment","wires":[],"x":80,"y":50,"z":"71b14382.55983c"},{"channel":"2","factor":"0.03","family":"11","id":"a3de26e5.33268","inputs":1,"interval":"100","lighttype":"switch","maxvalue":"100","minvalue":"15","name":"","namespace":"light","offvalue":"0","offvalue2":"0","onvalue":"100","peerid":"2","step":"1","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":740,"y":100,"z":"71b14382.55983c"},{"channel":"1","family":"14","id":"48cf7407.ca82c4","name":"","namespace":"variable","peerid":"41","refractoryperiod":"0","type":"variable-in","variable":"STATE","variabletype":"device","wires":[[{"id":"171392e0.a2ab05","port":0}]],"x":100,"y":100,"z":"4d2cb67e.e7f9b"},{"channel":"2","family":"14","id":"7a2b0d1.5fcb2f4","name":"","namespace":"variable","peerid":"39","refractoryperiod":"0","type":"variable-in","variable":"STATE","variabletype":"device","wires":[[{"id":"171392e0.a2ab05","port":0}]],"x":100,"y":150,"z":"4d2cb67e.e7f9b"},{"channel":"1","factor":"","family":"11","id":"b9da8e44.40881","inputs":1,"interval":"","lighttype":"switch","maxvalue":"","minvalue":"","name":"","namespace":"light","offvalue":"0","offvalue2":"","onvalue":"100","peerid":"3","step":"","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":970,"y":100,"z":"4d2cb67e.e7f9b"},{"channel":"3","family":"14","id":"e0b00484.e43578","name":"","namespace":"variable","outputonstartup":false,"peerid":"83","refractoryperiod":"0","type":"variable-in","variable":"MOTION","variabletype":"device","wires":[[{"id":"93d20b5e.1caa","port":0}]],"x":100,"y":200,"z":"4d2cb67e.e7f9b"},{"id":"4245d7ac.7af81","name":"","namespace":"timers","off-delay":"180000","type":"off-delay","wires":[[{"id":"77094058.ff2a28","port":0}],[]],"x":980,"y":210,"z":"4d2cb67e.e7f9b"},{"func":"if($inputIndex == 0)\n{\n    $manual = getFlowData('light.3.1.manual');\n    if($message['payload'])\n    {\n        if($manual == 0)\n        {\n            setFlowData('light.3.1.manual', 1);\n            $hg->setValue(39, 2, 'LED_STATE', 100);\n            $hg->setValue(41, 1, 'LED_STATE', 100);\n            return array($message, array('payload' => false));\n        }\n        else if($manual == -1)\n        {\n            setFlowData('light.3.1.manual', 0);\n            $hg->setValue(39, 2, 'LED_STATE', 0);\n            $hg->setValue(41, 1, 'LED_STATE', 0);\n            return array($message, NULL);\n        }\n    }\n    else\n    {\n        if($manual == 1)\n        {\n            setFlowData('light.3.1.manual', 0);\n            $hg->setValue(39, 2, 'LED_STATE', 0);\n            $hg->setValue(41, 1, 'LED_STATE', 0);\n            return array(NULL, array('payload' => true));\n        }\n        else if($manual == 0)\n        {\n            setFlowData('light.3.1.manual', -1);\n            $hg->setValue(39, 2, 'LED_STATE', 1);\n            $hg->setValue(41, 1, 'LED_STATE', 1);\n            return array($message, array('payload' => true));\n        }\n    }\n}\nelse if(!$message['payload'] && getFlowData('light.3.1.manual') == 1)\n{\n    setFlowData('light.3.1.manual', 0);\n    $hg->setValue(39, 2, 'LED_STATE', 0);\n    $hg->setValue(41, 1, 'LED_STATE', 0);\n    return array($message, array('payload' => true));\n}","id":"171392e0.a2ab05","inputs":"2","name":"","namespace":"function","noerr":0,"outputs":"2","type":"function","wires":[[{"id":"77094058.ff2a28","port":0}],[{"id":"46fb05b2.fb78b4","port":0}]],"x":520,"y":110,"z":"4d2cb67e.e7f9b"},{"id":"46fb05b2.fb78b4","name":"","namespace":"timers","off-delay":"14400000","type":"off-delay","wires":[[{"id":"171392e0.a2ab05","port":1}],[]],"x":645,"y":140,"z":"4d2cb67e.e7f9b"},{"changes-only":false,"checkall":"true","id":"77094058.ff2a28","inputs":1,"name":"","namespace":"basic-logic","output-false":false,"output-true":false,"outputs":1,"property":"payload","rules":[{"t":"nnull"}],"type":"switch","wires":[[{"id":"b9da8e44.40881","port":0}]],"x":810,"y":100,"z":"4d2cb67e.e7f9b"},{"channel":"1","family":"6","id":"ef8a6b5d.4a239","name":"","namespace":"variable","peerid":"25","type":"variable-out","variable":"PLAY","variabletype":"device","wires":[],"x":500,"y":2240,"z":"cc109e74.5fbec"},{"func":"$manual = getFlowData('light.3.2.manual');\nif($manual == 1) return NULL;\nelse if($manual == -1) return NULL;\nelse if(getGlobalData('night') || getFlowData('isDark'))\n{\n    setNodeData('lastState', $message['payload']);\n    return array('payload' => $message['payload']);\n}\nelse\n{\n    $lastState = getNodeData('lastState');\n    if($lastState)\n    {\n        setNodeData('lastState', false);\n        return array('payload' => false);\n    }\n}","id":"f91cef31.221e48","inputs":1,"name":"","namespace":"function","noerr":0,"outputs":"1","type":"function","wires":[[{"id":"4808bb60.328bac","port":0},{"id":"252b2dab.7171c2","port":0},{"id":"252b2dab.7171c2","port":1}]],"x":290,"y":220,"z":"b9b74dfe.3575c"},{"func":"$manual = getFlowData('light.3.1.manual');\nif($manual == 1) return NULL;\nelse if($manual == -1) return NULL;\nelse return array('payload' => $message['payload']);","id":"93d20b5e.1caa","inputs":1,"name":"","namespace":"function","noerr":0,"outputs":"1","type":"function","wires":[[{"id":"4245d7ac.7af81","port":0},{"id":"7e139dd2.4aaf14","port":0},{"id":"7e139dd2.4aaf14","port":1}]],"x":320,"y":200,"z":"4d2cb67e.e7f9b"},{"func":"$manual = getFlowData('light.28.1.manual');\nif($manual == 1) return NULL;\nelse if($manual == -1) return NULL;\nelse if(getGlobalData('night') || getFlowData('isDark'))\n{\n    setNodeData('lastState', $message['payload']);\n    return array('payload' => $message['payload']);\n}\nelse\n{\n    $lastState = getNodeData('lastState');\n    if($lastState)\n    {\n        setNodeData('lastState', false);\n        return array('payload' => false);\n    }\n}","id":"6ad99bfe.08cfb4","inputs":1,"name":"","namespace":"function","noerr":0,"outputs":"1","type":"function","wires":[[{"id":"39fa65aa.e2791a","port":0},{"id":"7da49dbb.e3a4d4","port":0},{"id":"7da49dbb.e3a4d4","port":1}]],"x":320,"y":200,"z":"302d5ee5.37b1aa"},{"func":"$manual = getFlowData('light.1.1.manual');\nif($manual == 1) return NULL;\nelse if($manual == -1) return NULL;\nelse if(getGlobalData('night') || getFlowData('isDark'))\n{\n    setNodeData('lastState', $message['payload']);\n    return array('payload' => $message['payload']);\n}\nelse\n{\n    $lastState = getNodeData('lastState');\n    if($lastState)\n    {\n        setNodeData('lastState', false);\n        return array('payload' => false);\n    }\n}","id":"2159e08c.dc3cb8","inputs":1,"name":"","namespace":"function","noerr":0,"outputs":"1","type":"function","wires":[[{"id":"3dcef173.939806","port":0},{"id":"b433ed95.8b949","port":0},{"id":"b433ed95.8b949","port":1}]],"x":320,"y":200,"z":"e75b7fd7.a33d6"},{"channel":"1","family":"14","id":"cb273f79.8d48b","loopprevention":false,"looppreventiongroup":"cab7665b.af1d4","name":"","namespace":"variable","outputonstartup":false,"peerid":"32","refractoryperiod":"0","type":"variable-in","variable":"STATE","variabletype":"device","wires":[[{"id":"b5d82407.f5537","port":0}]],"x":95,"y":150,"z":"c0d2bbb9.a687a"},{"channel":"3","factor":"0.03","family":"11","id":"9ba38d15.691cf","inputs":1,"interval":"100","lighttype":"switch","maxvalue":"100","minvalue":"15","name":"","namespace":"light","offvalue":"0","offvalue2":"0","onvalue":"100","peerid":"5","step":"1","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":610,"y":200,"z":"c0d2bbb9.a687a"},{"channel":"3","family":"14","id":"f8d58ef6.ef5cb","name":"","namespace":"variable","outputonstartup":false,"peerid":"84","refractoryperiod":"0","type":"variable-in","variable":"MOTION","variabletype":"device","wires":[[{"id":"413d6872.48eb1","port":3}]],"x":100,"y":350,"z":"c0d2bbb9.a687a"},{"func":"$lightOn = getFlowData('lightOn');\n$lightOff = getFlowData('lightOff');\nif($message['payload'])\n{\n    if(!$lightOff)\n    {\n        setFlowData('lightOn', true);\n        $hg->setValue(32, 12, 'STATE', 100);\n    }\n    else\n    {\n        setFlowData('lightOff', false);\n        $hg->setValue(32, 12, 'STATE', 0);\n    }\n}\nelse\n{\n    if($lightOn)\n    {\n        setFlowData('lightOn', false);\n        $hg->setValue(32, 12, 'STATE', 0);\n    }\n    else\n    {\n        setFlowData('lightOff', true);\n        $hg->setValue(32, 12, 'STATE', 1);\n    }\n}","id":"b5d82407.f5537","inputs":"1","name":"","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[]],"x":290,"y":150,"z":"c0d2bbb9.a687a"},{"channel":"2","family":"14","id":"eb3b8e9.d66cef","loopprevention":false,"looppreventiongroup":"4a09f7fb.c09be","name":"Nordzimmer Praesenz","namespace":"variable","outputonstartup":false,"peerid":"84","refractoryperiod":"0","type":"variable-in","variable":"MOTION","variabletype":"device","wires":[[{"id":"ef1b0ae8.9414d8","port":0}]],"x":120,"y":580,"z":"1755f935.cee76f"},{"id":"ef1b0ae8.9414d8","name":"","namespace":"basic-logic","type":"not","wires":[[{"id":"7639a51f.cabbcc","port":5}]],"x":280,"y":580,"z":"1755f935.cee76f"},{"id":"eb257cee.680f9","message":"","name":"","namespace":"notification","recipient":"sathya@jabb3r.de","server":"cfef0792.97ae9","type":"xmpp","wires":[],"x":580,"y":70,"z":"524cbef6.e505b8"},{"id":"cf112f88.3dd26","name":"","namespace":"variable","outputonstartup":true,"payload":"true","payloadType":"bool","type":"constant","wires":[[{"id":"5c14ad42.7339f4","port":0}]],"x":200,"y":70,"z":"524cbef6.e505b8"},{"func":"$message['xmpp-message'] = \"Flows restarted\";\nreturn $message;","id":"5c14ad42.7339f4","inputs":1,"name":"","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[{"id":"eb257cee.680f9","port":0}]],"x":380,"y":70,"z":"524cbef6.e505b8"},{"id":"79e2e59a.5ceccc","measurement":"gaeste-wc_ventilstellung","name":"","namespace":"influxdb","type":"influxdb","wires":[],"x":540,"y":490,"z":"b9b74dfe.3575c"},{"id":"5d0f6913.da583","measurement":"wohnzimmer_ventilstellung","name":"","namespace":"influxdb","type":"influxdb","wires":[],"x":540,"y":2650,"z":"cc109e74.5fbec"},{"id":"52c9a9ae.1a60d8","measurement":"zimmer-nord_ventilstellung","name":"","namespace":"influxdb","type":"influxdb","wires":[],"x":540,"y":540,"z":"c0d2bbb9.a687a"},{"id":"385c5b1.c3d2424","measurement":"zimmer-sued_ventilstellung","name":"","namespace":"influxdb","type":"influxdb","wires":[],"x":540,"y":520,"z":"9cd3b032.f95e28"},{"id":"322d5f47.5b4d1","measurement":"bad_ventilstellung","name":"","namespace":"influxdb","type":"influxdb","wires":[],"x":620,"y":890,"z":"5e7e747b.a20d9c"},{"id":"3521a15f.7a7e36","measurement":"schlafzimmer_ventilstellung","name":"","namespace":"influxdb","type":"influxdb","wires":[],"x":540,"y":950,"z":"822c4be8.2ccc28"},{"channel":"1","family":"14","id":"e1e53954.3135","loopprevention":false,"looppreventiongroup":"","name":"","namespace":"variable","outputonstartup":false,"peerid":"78","refractoryperiod":"180000","type":"variable-in","variable":"BRIGHTNESS","variabletype":"device","wires":[[{"id":"1ae0162c.ba05da","port":0}]],"x":120,"y":250,"z":"e75b7fd7.a33d6"},{"func":"$isDarkGlobal = getGlobalData('isDark');\nif(!is_array($isDarkGlobal)) $isDarkGlobal = array();\n\nif(getGlobalData('night'))\n{\n    setFlowData('lastBrightnesses', array());\n    setFlowData('isDark', false);\n}\nelse if(!$hg->getValue(1, 1, 'STATE'))\n{\n    $brightnesses = getFlowData('lastBrightnesses');\n    if(!is_array($brightnesses)) $brightnesses = array($message['payload']);\n    else array_push($brightnesses, $message['payload']);\n    if(count($brightnesses) > 6) array_shift($brightnesses);\n    setFlowData('lastBrightnesses', $brightnesses);\n    foreach($brightnesses as $brightness)\n    {\n        if($brightness < 9000)\n        {\n            setFlowData('isDark', true);\n            $isDarkGlobal['EG Flur'] = true;\n            setGlobalData('isDark', $isDarkGlobal);\n            return NULL;\n        }\n    }\n    \n    $isDarkGlobal['EG Flur'] = false;\n    setGlobalData('isDark', $isDarkGlobal);\n    \n    foreach($isDarkGlobal as $room => $isDark)\n    {\n        if($room != 'EG Flur' && $isDark)\n        {\n            setFlowData('isDark', true);\n            return NULL;\n        }\n    }\n    \n    setFlowData('isDark', false);\n}\nelse\n{\n    $isDarkGlobal['EG Flur'] = false;\n    setGlobalData('isDark', $isDarkGlobal);\n}","id":"1ae0162c.ba05da","inputs":1,"name":"","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[]],"x":320,"y":250,"z":"e75b7fd7.a33d6"},{"channel":"1","family":"14","id":"3e90a607.d7a552","loopprevention":false,"looppreventiongroup":"","name":"","namespace":"variable","outputonstartup":false,"peerid":"84","refractoryperiod":"180000","type":"variable-in","variable":"BRIGHTNESS","variabletype":"device","wires":[[{"id":"67145a58.2dd5ac","port":0}]],"x":115,"y":100,"z":"c0d2bbb9.a687a"},{"func":"$isDarkGlobal = getGlobalData('isDark');\nif(!is_array($isDarkGlobal)) $isDarkGlobal = array();\n\nif(getGlobalData('night'))\n{\n    setFlowData('lastBrightnesses', array());\n    setFlowData('isDark', false);\n}\nelse\n{\n    $brightnesses = getFlowData('lastBrightnesses');\n    if(!is_array($brightnesses)) $brightnesses = array($message['payload']);\n    else array_push($brightnesses, $message['payload']);\n    if(count($brightnesses) > 6) array_shift($brightnesses);\n    setFlowData('lastBrightnesses', $brightnesses);\n    foreach($brightnesses as $brightness)\n    {\n        if($brightness < 11000)\n        {\n            setFlowData('isDark', true);\n            $isDarkGlobal['Nordzimmer'] = true;\n            setGlobalData('isDark', $isDarkGlobal);\n            return NULL;\n        }\n    }\n    \n    $isDarkGlobal['Nordzimmer'] = false;\n    setGlobalData('isDark', $isDarkGlobal);\n    \n    foreach($isDarkGlobal as $room => $isDark)\n    {\n        if($room != 'Nordzimmer' && $isDark)\n        {\n            setFlowData('isDark', true);\n            return NULL;\n        }\n    }\n    \n    setFlowData('isDark', false);\n}","id":"67145a58.2dd5ac","inputs":1,"name":"Set flow.isDark and global.isDark","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[]],"x":360,"y":100,"z":"c0d2bbb9.a687a"},{"channel":"1","family":"14","id":"55164e0b.3dac5","loopprevention":false,"looppreventiongroup":"","name":"","namespace":"variable","outputonstartup":false,"peerid":"79","refractoryperiod":"180000","type":"variable-in","variable":"BRIGHTNESS","variabletype":"device","wires":[[{"id":"6676de4b.f7fa98","port":0}]],"x":120,"y":100,"z":"5e7e747b.a20d9c"},{"func":"$isDarkGlobal = getGlobalData('isDark');\nif(!is_array($isDarkGlobal)) $isDarkGlobal = array();\n\nif(getGlobalData('night'))\n{\n    setFlowData('lastBrightnesses', array());\n    setFlowData('isDark', false);\n}\nelse if(!$hg->getValue(6, 3, 'STATE') && !$hg->getValue(6, 1, 'STATE') && !$hg->getValue(56, 1, 'STATE'))\n{\n    $brightnesses = getFlowData('lastBrightnesses');\n    if(!is_array($brightnesses)) $brightnesses = array($message['payload']);\n    else array_push($brightnesses, $message['payload']);\n    if(count($brightnesses) > 6) array_shift($brightnesses);\n    setFlowData('lastBrightnesses', $brightnesses);\n    foreach($brightnesses as $brightness)\n    {\n        if($brightness < 12000)\n        {\n            setFlowData('isDark', true);\n            if($brightness < 9000)\n            {\n                $isDarkGlobal['Bad'] = true;\n                setGlobalData('isDark', $isDarkGlobal);\n            }\n            else\n            {\n                $isDarkGlobal['Bad'] = false;\n                setGlobalData('isDark', $isDarkGlobal);\n            }\n            return NULL;\n        }\n    }\n    \n    $isDarkGlobal['Bad'] = false;\n    setGlobalData('isDark', $isDarkGlobal);\n    \n    foreach($isDarkGlobal as $room => $isDark)\n    {\n        if($room != 'Bad' && $isDark)\n        {\n            setFlowData('isDark', true);\n            return NULL;\n        }\n    }\n    \n    setFlowData('isDark', false);\n}\nelse\n{\n    $isDarkGlobal['Bad'] = false;\n    setGlobalData('isDark', $isDarkGlobal);\n}","id":"6676de4b.f7fa98","inputs":1,"name":"Set flow.isDark and global.isDark","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[]],"x":360,"y":100,"z":"5e7e747b.a20d9c"},{"channel":"1","family":"14","id":"9dc66e60.d81b5","loopprevention":false,"looppreventiongroup":"","name":"","namespace":"variable","outputonstartup":false,"peerid":"82","refractoryperiod":"180000","type":"variable-in","variable":"BRIGHTNESS","variabletype":"device","wires":[[{"id":"3adc3dad.be7a6a","port":0}]],"x":115,"y":250,"z":"302d5ee5.37b1aa"},{"func":"$isDarkGlobal = getGlobalData('isDark');\nif(!is_array($isDarkGlobal)) $isDarkGlobal = array();\n\nif(getGlobalData('night'))\n{\n    setFlowData('lastBrightnesses', array());\n    setFlowData('isDark', false);\n}\nelse if(!$hg->getValue(28, 1, 'STATE') && !$hg->getValue(3, 4, 'STATE') && !$hg->getValue(15, 1, 'LEVEL') && !$hg->getValue(16, 1, 'LEVEL') && !$hg->getValue(17, 1, 'LEVEL') && !$hg->getValue(72, 1, 'LEVEL'))\n{\n    $brightnesses = getFlowData('lastBrightnesses');\n    if(!is_array($brightnesses)) $brightnesses = array($message['payload']);\n    else array_push($brightnesses, $message['payload']);\n    if(count($brightnesses) > 6) array_shift($brightnesses);\n    setFlowData('lastBrightnesses', $brightnesses);\n    foreach($brightnesses as $brightness)\n    {\n        if($brightness < 11000)\n        {\n            setFlowData('isDark', true);\n            $isDarkGlobal['Kueche'] = true;\n            setGlobalData('isDark', $isDarkGlobal);\n            return array('payload' => 1);\n        }\n    }\n    \n    $isDarkGlobal['Kueche'] = false;\n    setGlobalData('isDark', $isDarkGlobal);\n    \n    foreach($isDarkGlobal as $room => $isDark)\n    {\n        if($room != 'Kueche' && $isDark)\n        {\n            setFlowData('isDark', true);\n            return array('payload' => 2);\n        }\n    }\n    \n    setFlowData('isDark', false);\n    return array('payload' => 0);\n}\n\n$isDarkGlobal['Kueche'] = false;\nsetGlobalData('isDark', $isDarkGlobal);\nreturn array('payload' => -1);","id":"3adc3dad.be7a6a","inputs":1,"name":"","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[]],"x":320,"y":250,"z":"302d5ee5.37b1aa"},{"channel":"1","family":"14","id":"8ea712de.71ae6","loopprevention":false,"looppreventiongroup":"","name":"","namespace":"variable","outputonstartup":false,"peerid":"76","refractoryperiod":"180000","type":"variable-in","variable":"BRIGHTNESS","variabletype":"device","wires":[[{"id":"ab0e6632.cbf2b","port":0}]],"x":120,"y":270,"z":"b9b74dfe.3575c"},{"func":"$isDarkGlobal = getGlobalData('isDark');\nif(!is_array($isDarkGlobal)) $isDarkGlobal = array();\n\nif(getGlobalData('night'))\n{\n    setFlowData('lastBrightnesses', array());\n    setFlowData('isDark', false);\n}\nelse if(!$hg->getValue(3, 2, 'STATE'))\n{\n    $brightnesses = getFlowData('lastBrightnesses');\n    if(!is_array($brightnesses)) $brightnesses = array($message['payload']);\n    else array_push($brightnesses, $message['payload']);\n    if(count($brightnesses) > 6) array_shift($brightnesses);\n    setFlowData('lastBrightnesses', $brightnesses);\n    foreach($brightnesses as $brightness)\n    {\n        if($brightness < 9000)\n        {\n            setFlowData('isDark', true);\n            $isDarkGlobal['Gaeste-WC'] = true;\n            setGlobalData('isDark', $isDarkGlobal);\n            return NULL;\n        }\n    }\n    \n    $isDarkGlobal['Gaeste-WC'] = false;\n    setGlobalData('isDark', $isDarkGlobal);\n    \n    foreach($isDarkGlobal as $room => $isDark)\n    {\n        if($room != 'Gaeste-WC' && $isDark)\n        {\n            setFlowData('isDark', true);\n            return NULL;\n        }\n    }\n    \n    setFlowData('isDark', false);\n}\nelse\n{\n    $isDarkGlobal['Gaeste-WC'] = false;\n    setGlobalData('isDark', $isDarkGlobal);\n}","id":"ab0e6632.cbf2b","inputs":1,"name":"","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[]],"x":290,"y":270,"z":"b9b74dfe.3575c"},{"id":"1ed6a3e9.7b8d7c","info":"","name":"Zuschaltung Sonos","namespace":"comment","type":"comment","wires":[],"x":110,"y":1140,"z":"5e7e747b.a20d9c"},{"channel":"3","family":"14","id":"6e4f34b0.26f7bc","loopprevention":false,"looppreventiongroup":"","name":"","namespace":"variable","outputonstartup":false,"peerid":"79","refractoryperiod":"5000","type":"variable-in","variable":"MOTION","variabletype":"device","wires":[[{"id":"9b0b8e46.8f405","port":0}]],"x":100,"y":1190,"z":"5e7e747b.a20d9c"},{"func":"if($inputIndex == 0)\n{\n    $kitchenTransportState = $hg->getValue(25, 1, \"TRANSPORT_STATE\"); \n    $northRoomTransportState = $hg->getValue(89, 1, \"TRANSPORT_STATE\"); \n    $bathroomTransportState = $hg->getValue(85, 1, \"TRANSPORT_STATE\");\n    if(($kitchenTransportState == 0 || $kitchenTransportState == 1) && ($northRoomTransportState == 0 || $northRoomTransportState == 1))\n    {\n        return NULL;\n    }\n    if(getNodeData('added') || ($bathroomTransportState != 0 && $bathroomTransportState != 1)) return NULL;\n    setNodeData('added', true);\n    if(($kitchenTransportState == 0 || $kitchenTransportState == 1) && ($northRoomTransportState == 2 || $northRoomTransportState == 3))\n    {\n        $hg->setValue(89, 1, 'ADD_SPEAKER', 85);\n    }\n    else\n    {\n        $hg->setValue(25, 1, 'ADD_SPEAKER', 85);\n    }\n    $hg->setValue(85, 1, 'VOLUME', 12);\n}\nelse\n{\n    if(!getNodeData('added')) return NULL;\n    setNodeData('added', false);\n    $hg->setValue(25, 1, 'REMOVE_SPEAKER', 85);\n    $hg->setValue(89, 1, 'REMOVE_SPEAKER', 85);\n}","id":"753ca85e.dee2c8","inputs":"2","name":"","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[]],"x":560,"y":1200,"z":"5e7e747b.a20d9c"},{"id":"c020c89a.fa80c8","interval":"5000","name":"","namespace":"timers","resetafter":"300000","type":"interval","wires":[[],[{"id":"753ca85e.dee2c8","port":1}]],"x":400,"y":1200,"z":"5e7e747b.a20d9c"},{"changes-only":false,"checkall":"true","id":"9b0b8e46.8f405","inputs":1,"name":"is true","namespace":"basic-logic","output-false":false,"output-true":false,"outputs":1,"property":"payload","rules":[{"t":"true"}],"type":"switch","wires":[[{"id":"c020c89a.fa80c8","port":0},{"id":"753ca85e.dee2c8","port":0},{"id":"c020c89a.fa80c8","port":1}]],"x":260,"y":1190,"z":"5e7e747b.a20d9c"},{"channel":"1","family":"11","id":"87c4a6fb.860f38","name":"","namespace":"variable","peerid":"72","type":"variable-out","variable":"LEVEL","variabletype":"device","wires":[],"x":680,"y":100,"z":"cc109e74.5fbec"},{"func":"$value = $message['payload'];\nif($value > 0)\n{\n     $value /= 100;\n     $message['payload'] = ($value * (10000.0 - 1100.0)) + 1100.0;\n}\nreturn $message;","id":"fe57daac.b3526","inputs":1,"name":"","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[{"id":"87c4a6fb.860f38","port":0}]],"x":420,"y":100,"z":"cc109e74.5fbec"},{"channel":"1","family":"11","id":"34909fb7.a8592","name":"","namespace":"variable","peerid":"17","type":"variable-out","variable":"LEVEL","variabletype":"device","wires":[],"x":675,"y":200,"z":"cc109e74.5fbec"},{"func":"$value = $message['payload'];\nif($value > 0)\n{\n     $value /= 100;\n     $message['payload'] = ($value * (10000.0 - 1100.0)) + 1100.0;\n}\nreturn $message;","id":"9ddd5cb4.3823f","inputs":1,"name":"","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[{"id":"34909fb7.a8592","port":0}]],"x":420,"y":200,"z":"cc109e74.5fbec"},{"channel":"1","family":"14","id":"c432710b.b36c","loopprevention":true,"looppreventiongroup":"bed7cfec.848c98","name":"","namespace":"variable","outputonstartup":false,"peerid":"19","refractoryperiod":"0","type":"variable-in","variable":"SPOTS_SLATE","variabletype":"device","wires":[[{"id":"9ddd5cb4.3823f","port":0}]],"x":115,"y":200,"z":"cc109e74.5fbec"},{"field":"payload","format":"handlebars","id":"5a26b9a.a3bd6c8","name":"0","namespace":"template","output":"json","syntax":"mustache","template":"0","type":"template","wires":[[{"id":"b43cc3f9.3f96b","port":0},{"id":"eb82dda1.deed4","port":0},{"id":"a4e0a6e2.9901f8","port":0},{"id":"47da1f59.b8d8b","port":0}]],"x":420,"y":1600,"z":"cc109e74.5fbec"},{"channel":"1","family":"11","id":"da08072c.38e71","loopprevention":true,"looppreventiongroup":"dfc2bc9b.417f1","name":"","namespace":"variable","outputonstartup":false,"peerid":"72","refractoryperiod":"0","type":"variable-in","variable":"LEVEL","variabletype":"device","wires":[[{"id":"3b33a85f.4f44f8","port":0}]],"x":100,"y":150,"z":"cc109e74.5fbec"},{"func":"$value = $message['payload'];\nif($value > 0 && $value < 1100.0) $value = 1100.0;\nif($value > 0) $message['payload'] = (int)round(($value - 1100.0) / (10000.0 - 1100.0) * 100);\nreturn $message;","id":"3b33a85f.4f44f8","inputs":1,"name":"","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[{"id":"4d1c5ef7.b90b","port":0}]],"x":420,"y":150,"z":"cc109e74.5fbec"},{"channel":"1","family":"14","id":"4d1c5ef7.b90b","name":"","namespace":"variable","peerid":"19","type":"variable-out","variable":"SPOTS_NONSLATE","variabletype":"device","wires":[],"x":640,"y":150,"z":"cc109e74.5fbec"},{"channel":"1","family":"11","id":"58e94af9.0ea14c","loopprevention":true,"looppreventiongroup":"bed7cfec.848c98","name":"","namespace":"variable","outputonstartup":false,"peerid":"17","refractoryperiod":"0","type":"variable-in","variable":"LEVEL","variabletype":"device","wires":[[{"id":"90bb0893.1c6ad8","port":0}]],"x":100,"y":250,"z":"cc109e74.5fbec"},{"func":"$value = $message['payload'];\nif($value > 0 && $value < 1100.0) $value = 1100.0;\nif($value > 0) $message['payload'] = (int)round(($value - 1100.0) / (10000.0 - 1100.0) * 100);\nreturn $message;","id":"90bb0893.1c6ad8","inputs":1,"name":"","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[{"id":"9ae1057d.9be7d","port":0}]],"x":420,"y":250,"z":"cc109e74.5fbec"},{"channel":"1","family":"14","id":"9ae1057d.9be7d","name":"","namespace":"variable","peerid":"19","type":"variable-out","variable":"SPOTS_SLATE","variabletype":"device","wires":[],"x":660,"y":250,"z":"cc109e74.5fbec"},{"changes-only":false,"checkall":"true","id":"48e25d1a.6d4acc","inputs":1,"name":"","namespace":"basic-logic","output-false":false,"output-true":false,"outputs":1,"property":"payload","rules":[{"t":"true"}],"type":"switch","wires":[[{"id":"ef8a6b5d.4a239","port":0}]],"x":290,"y":2240,"z":"cc109e74.5fbec"},{"channel":"11","family":"14","id":"852f98b5.bdbfe8","loopprevention":false,"looppreventiongroup":"dfc2bc9b.417f1","name":"","namespace":"variable","outputonstartup":false,"peerid":"19","refractoryperiod":"0","type":"variable-in","variable":"PAUSE","variabletype":"device","wires":[[{"id":"c0358a34.46f7e","port":0}]],"x":95,"y":2290,"z":"cc109e74.5fbec"},{"channel":"1","family":"6","id":"e8b6ffef.97a0f8","name":"","namespace":"variable","peerid":"25","type":"variable-out","variable":"PAUSE","variabletype":"device","wires":[],"x":495,"y":2290,"z":"cc109e74.5fbec"},{"changes-only":false,"checkall":"true","id":"c0358a34.46f7e","inputs":1,"name":"","namespace":"basic-logic","output-false":false,"output-true":false,"outputs":1,"property":"payload","rules":[{"t":"true"}],"type":"switch","wires":[[{"id":"e8b6ffef.97a0f8","port":0}]],"x":290,"y":2290,"z":"cc109e74.5fbec"},{"channel":"11","family":"14","id":"3da61690.76176a","loopprevention":false,"looppreventiongroup":"dfc2bc9b.417f1","name":"","namespace":"variable","outputonstartup":false,"peerid":"19","refractoryperiod":"0","type":"variable-in","variable":"NEXT","variabletype":"device","wires":[[{"id":"41a6fa97.97ebd4","port":0}]],"x":95,"y":2340,"z":"cc109e74.5fbec"},{"channel":"1","family":"6","id":"348e4bb9.278854","name":"","namespace":"variable","peerid":"25","type":"variable-out","variable":"NEXT","variabletype":"device","wires":[],"x":495,"y":2340,"z":"cc109e74.5fbec"},{"changes-only":false,"checkall":"true","id":"41a6fa97.97ebd4","inputs":1,"name":"","namespace":"basic-logic","output-false":false,"output-true":false,"outputs":1,"property":"payload","rules":[{"t":"true"}],"type":"switch","wires":[[{"id":"348e4bb9.278854","port":0}]],"x":290,"y":2340,"z":"cc109e74.5fbec"},{"channel":"11","family":"14","id":"b0bdab47.887088","loopprevention":false,"looppreventiongroup":"dfc2bc9b.417f1","name":"","namespace":"variable","outputonstartup":false,"peerid":"19","refractoryperiod":"0","type":"variable-in","variable":"PREVIOUS","variabletype":"device","wires":[[{"id":"581092c1.1d5444","port":0}]],"x":110,"y":2390,"z":"cc109e74.5fbec"},{"channel":"1","family":"6","id":"a2d3a548.54b2e8","name":"","namespace":"variable","peerid":"25","type":"variable-out","variable":"PREVIOUS","variabletype":"device","wires":[],"x":480,"y":2390,"z":"cc109e74.5fbec"},{"changes-only":false,"checkall":"true","id":"581092c1.1d5444","inputs":1,"name":"","namespace":"basic-logic","output-false":false,"output-true":false,"outputs":1,"property":"payload","rules":[{"t":"true"}],"type":"switch","wires":[[{"id":"a2d3a548.54b2e8","port":0}]],"x":290,"y":2390,"z":"cc109e74.5fbec"},{"channel":"11","family":"14","id":"c3390704.d5424","loopprevention":true,"looppreventiongroup":"dfc2bc9b.417f1","name":"","namespace":"variable","outputonstartup":false,"peerid":"19","refractoryperiod":"0","type":"variable-in","variable":"VOLUME","variabletype":"device","wires":[[{"id":"79918f19.426f78","port":0}]],"x":105,"y":2440,"z":"cc109e74.5fbec"},{"channel":"1","family":"6","id":"79918f19.426f78","name":"","namespace":"variable","peerid":"25","type":"variable-out","variable":"VOLUME","variabletype":"device","wires":[],"x":485,"y":2440,"z":"cc109e74.5fbec"},{"channel":"1","family":"6","id":"4ee2a9c2.6efcd8","loopprevention":true,"looppreventiongroup":"dfc2bc9b.417f1","name":"","namespace":"variable","outputonstartup":false,"peerid":"25","refractoryperiod":"0","type":"variable-in","variable":"VOLUME","variabletype":"device","wires":[[{"id":"9126101f.a0c2a","port":0}]],"x":100,"y":2490,"z":"cc109e74.5fbec"},{"channel":"11","family":"14","id":"9126101f.a0c2a","name":"","namespace":"variable","peerid":"19","type":"variable-out","variable":"VOLUME","variabletype":"device","wires":[],"x":485,"y":2490,"z":"cc109e74.5fbec"},{"channel":"1","family":"14","id":"3e52ce9f.72d4d2","loopprevention":true,"looppreventiongroup":"4a09f7fb.c09be","name":"","namespace":"variable","outputonstartup":false,"peerid":"19","refractoryperiod":"0","type":"variable-in","variable":"RIMLIGHT_COLOR.SCENE","variabletype":"device","wires":[[{"id":"95a885b4.ba8138","port":0}]],"x":150,"y":300,"z":"cc109e74.5fbec"},{"broker":"951b3e2.1a5d3c","id":"95a885b4.ba8138","name":"","namespace":"mqtt","retain":"false","topic":"nodeblue/1/neopixel/scene","type":"mqtt-out","wires":[],"x":650,"y":300,"z":"cc109e74.5fbec"},{"channel":"1","family":"14","id":"b77bd0c.ec528b","loopprevention":true,"looppreventiongroup":"4a09f7fb.c09be","name":"","namespace":"variable","outputonstartup":false,"peerid":"19","refractoryperiod":"0","type":"variable-in","variable":"RIMLIGHT_BRIGHTNESS","variabletype":"device","wires":[[{"id":"7f7161dc.a81588","port":0}]],"x":145,"y":350,"z":"cc109e74.5fbec"},{"broker":"951b3e2.1a5d3c","id":"7f7161dc.a81588","name":"","namespace":"mqtt","retain":"false","topic":"nodeblue/1/neopixel/brightness","type":"mqtt-out","wires":[],"x":640,"y":350,"z":"cc109e74.5fbec"},{"channel":"1","family":"14","id":"ca1a8ae9.97075","loopprevention":true,"looppreventiongroup":"4a09f7fb.c09be","name":"","namespace":"variable","outputonstartup":false,"peerid":"19","refractoryperiod":"0","type":"variable-in","variable":"RIMLIGHT_TEMPERATURE","variabletype":"device","wires":[[{"id":"3c2ccf85.10922","port":0}]],"x":150,"y":400,"z":"cc109e74.5fbec"},{"broker":"951b3e2.1a5d3c","id":"3c2ccf85.10922","name":"","namespace":"mqtt","retain":"false","topic":"nodeblue/1/neopixel/temperature","type":"mqtt-out","wires":[],"x":635,"y":400,"z":"cc109e74.5fbec"},{"broker":"951b3e2.1a5d3c","id":"a300af6.3b7885","name":"","namespace":"mqtt","retain":"false","topic":"nodeblue/1/neopixel/brightness","type":"mqtt-out","wires":[],"x":690,"y":1250,"z":"3050d780.509968"},{"broker":"951b3e2.1a5d3c","id":"b811f6c0.955588","name":"","namespace":"mqtt","retain":"false","topic":"nodeblue/1/dotstar/state","type":"mqtt-out","wires":[],"x":705,"y":950,"z":"3050d780.509968"},{"broker":"951b3e2.1a5d3c","id":"b470e2ce.0eebc8","name":"","namespace":"mqtt","retain":"false","topic":"nodeblue/1/dotstar/state","type":"mqtt-out","wires":[],"x":885,"y":150,"z":"69ea3b1f.befffc"},{"broker":"951b3e2.1a5d3c","id":"b43cc3f9.3f96b","name":"","namespace":"mqtt","retain":"false","topic":"nodeblue/1/neopixel/brightness","type":"mqtt-out","wires":[],"x":640,"y":1690,"z":"cc109e74.5fbec"},{"channel":"1","family":"14","id":"b0ee9b15.ed65a8","loopprevention":false,"looppreventiongroup":"","name":"","namespace":"variable","outputonstartup":false,"peerid":"19","refractoryperiod":"0","type":"variable-in","variable":"SCENE_EATING","variabletype":"device","wires":[[{"id":"b4ecae44.9eea88","port":0},{"id":"2e7e34e4.25ffac","port":0},{"id":"9a4a87d6.59acc8","port":0},{"id":"e080b017.c250d8","port":0},{"id":"e00ce60b.48ac48","port":0}]],"x":120,"y":450,"z":"cc109e74.5fbec"},{"field":"payload","format":"handlebars","id":"d9bbce11.10043","name":"false","namespace":"template","output":"json","syntax":"mustache","template":"false","type":"template","wires":[[{"id":"8594f454.01586","port":0},{"id":"54ba3e2b.e51f58","port":0}]],"x":420,"y":1720,"z":"cc109e74.5fbec"},{"channel":"4","factor":"0.03","family":"11","id":"8594f454.01586","inputs":1,"interval":"100","lighttype":"switch","maxvalue":"100","minvalue":"15","name":"","namespace":"light","offvalue":"0","offvalue2":"0","onvalue":"100","peerid":"3","step":"1","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":685,"y":1720,"z":"cc109e74.5fbec"},{"field":"payload","format":"handlebars","id":"b4ecae44.9eea88","name":"10000","namespace":"template","output":"json","syntax":"mustache","template":"10000.0","type":"template","wires":[[{"id":"f1e9e243.99916","port":0}]],"x":420,"y":450,"z":"cc109e74.5fbec"},{"field":"payload","format":"handlebars","id":"9a4a87d6.59acc8","name":"true","namespace":"template","output":"json","syntax":"mustache","template":"true","type":"template","wires":[[{"id":"6ddfc4e.cc0753c","port":0},{"id":"c5fc5896.89fc9","port":0}]],"x":420,"y":550,"z":"cc109e74.5fbec"},{"field":"payload","format":"handlebars","id":"2e7e34e4.25ffac","name":"5000","namespace":"template","output":"json","syntax":"mustache","template":"5000.0","type":"template","wires":[[{"id":"578eb48e.c7dda4","port":0},{"id":"f772be45.c4bfe8","port":0}]],"x":420,"y":500,"z":"cc109e74.5fbec"},{"channel":"4","factor":"0.03","family":"11","id":"6ddfc4e.cc0753c","inputs":1,"interval":"100","lighttype":"switch","maxvalue":"100","minvalue":"15","name":"","namespace":"light","offvalue":"0","offvalue2":"0","onvalue":"100","peerid":"3","step":"1","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":680,"y":540,"z":"cc109e74.5fbec"},{"channel":"1","factor":"0.03","family":"11","id":"c5fc5896.89fc9","inputs":1,"interval":"100","lighttype":"switch","maxvalue":"100","minvalue":"15","name":"","namespace":"light","offvalue":"0","offvalue2":"0","onvalue":"100","peerid":"7","step":"1","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":685,"y":570,"z":"cc109e74.5fbec"},{"broker":"951b3e2.1a5d3c","id":"692c5fc3.eccad","name":"","namespace":"mqtt","retain":"false","topic":"nodeblue/1/neopixel/scene","type":"mqtt-out","wires":[],"x":650,"y":600,"z":"cc109e74.5fbec"},{"field":"payload","format":"handlebars","id":"e080b017.c250d8","name":"0","namespace":"template","output":"json","syntax":"mustache","template":"0","type":"template","wires":[[{"id":"692c5fc3.eccad","port":0}]],"x":420,"y":600,"z":"cc109e74.5fbec"},{"broker":"951b3e2.1a5d3c","id":"b1c75a29.6eb54","name":"","namespace":"mqtt","retain":"false","topic":"nodeblue/1/neopixel/brightness","type":"mqtt-out","wires":[],"x":640,"y":630,"z":"cc109e74.5fbec"},{"field":"payload","format":"handlebars","id":"e00ce60b.48ac48","name":"50","namespace":"template","output":"json","syntax":"mustache","template":"50","type":"template","wires":[[{"id":"b1c75a29.6eb54","port":0}]],"x":420,"y":650,"z":"cc109e74.5fbec"},{"channel":"1","family":"14","id":"5270e9b9.9579a8","loopprevention":false,"looppreventiongroup":"","name":"","namespace":"variable","outputonstartup":false,"peerid":"19","refractoryperiod":"0","type":"variable-in","variable":"SCENE_CLEANING","variabletype":"device","wires":[[{"id":"108b16de.b857c1","port":0},{"id":"a5c1c23e.1e8a4","port":0},{"id":"e12d53cc.0a1da","port":0},{"id":"258997ea.97d6d","port":0},{"id":"96ad8c6a.1de6d","port":0}]],"x":130,"y":700,"z":"cc109e74.5fbec"},{"field":"payload","format":"handlebars","id":"108b16de.b857c1","name":"10000","namespace":"template","output":"json","syntax":"mustache","template":"10000.0","type":"template","wires":[[{"id":"c7c3b23.e5321d","port":0}]],"x":420,"y":700,"z":"cc109e74.5fbec"},{"field":"payload","format":"handlebars","id":"e12d53cc.0a1da","name":"true","namespace":"template","output":"json","syntax":"mustache","template":"true","type":"template","wires":[[{"id":"c1b14372.256fe8","port":0},{"id":"25054aa.38447b6","port":0}]],"x":420,"y":800,"z":"cc109e74.5fbec"},{"field":"payload","format":"handlebars","id":"a5c1c23e.1e8a4","name":"10000","namespace":"template","output":"json","syntax":"mustache","template":"10000.0","type":"template","wires":[[{"id":"38d35f58.41487","port":0},{"id":"fc9ea62f.05feb8","port":0}]],"x":420,"y":750,"z":"cc109e74.5fbec"},{"channel":"4","factor":"0.03","family":"11","id":"c1b14372.256fe8","inputs":1,"interval":"100","lighttype":"switch","maxvalue":"100","minvalue":"15","name":"","namespace":"light","offvalue":"0","offvalue2":"0","onvalue":"100","peerid":"3","step":"1","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":680,"y":790,"z":"cc109e74.5fbec"},{"channel":"1","factor":"0.03","family":"11","id":"25054aa.38447b6","inputs":1,"interval":"100","lighttype":"switch","maxvalue":"100","minvalue":"15","name":"","namespace":"light","offvalue":"0","offvalue2":"0","onvalue":"100","peerid":"7","step":"1","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":680,"y":820,"z":"cc109e74.5fbec"},{"broker":"951b3e2.1a5d3c","id":"89c177cb.44ab38","name":"","namespace":"mqtt","retain":"false","topic":"nodeblue/1/neopixel/temperature","type":"mqtt-out","wires":[],"x":635,"y":850,"z":"cc109e74.5fbec"},{"field":"payload","format":"handlebars","id":"258997ea.97d6d","name":"5000","namespace":"template","output":"json","syntax":"mustache","template":"5000","type":"template","wires":[[{"id":"89c177cb.44ab38","port":0}]],"x":420,"y":850,"z":"cc109e74.5fbec"},{"broker":"951b3e2.1a5d3c","id":"b00dc6e5.b71e48","name":"","namespace":"mqtt","retain":"false","topic":"nodeblue/1/neopixel/brightness","type":"mqtt-out","wires":[],"x":640,"y":880,"z":"cc109e74.5fbec"},{"field":"payload","format":"handlebars","id":"96ad8c6a.1de6d","name":"100","namespace":"template","output":"json","syntax":"mustache","template":"100","type":"template","wires":[[{"id":"b00dc6e5.b71e48","port":0}]],"x":420,"y":900,"z":"cc109e74.5fbec"},{"channel":"1","family":"14","id":"55efa44b.eaca34","loopprevention":false,"looppreventiongroup":"","name":"","namespace":"variable","outputonstartup":false,"peerid":"19","refractoryperiod":"0","type":"variable-in","variable":"SCENE_TV","variabletype":"device","wires":[[{"id":"a23390e8.754bb8","port":0},{"id":"c9cc8e83.a5d1d","port":0},{"id":"73cf8c0.e674674","port":0},{"id":"c416a8.bf3e0958","port":0},{"id":"90466c02.185f18","port":0}]],"x":105,"y":950,"z":"cc109e74.5fbec"},{"field":"payload","format":"handlebars","id":"a23390e8.754bb8","name":"0","namespace":"template","output":"json","syntax":"mustache","template":"0.0","type":"template","wires":[[{"id":"df2ea62d.591868","port":0}]],"x":420,"y":950,"z":"cc109e74.5fbec"},{"field":"payload","format":"handlebars","id":"73cf8c0.e674674","name":"true","namespace":"template","output":"json","syntax":"mustache","template":"true","type":"template","wires":[[{"id":"59b03772.8ca62","port":0}]],"x":420,"y":1050,"z":"cc109e74.5fbec"},{"field":"payload","format":"handlebars","id":"c9cc8e83.a5d1d","name":"0","namespace":"template","output":"json","syntax":"mustache","template":"0.0","type":"template","wires":[[{"id":"bd87eb1.4606b18","port":0},{"id":"f5074447.61513","port":0}]],"x":420,"y":1000,"z":"cc109e74.5fbec"},{"channel":"4","factor":"0.03","family":"11","id":"59b03772.8ca62","inputs":1,"interval":"100","lighttype":"switch","maxvalue":"100","minvalue":"15","name":"","namespace":"light","offvalue":"0","offvalue2":"0","onvalue":"100","peerid":"3","step":"1","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":680,"y":1040,"z":"cc109e74.5fbec"},{"channel":"1","factor":"0.03","family":"11","id":"cfab0902.89d938","inputs":1,"interval":"100","lighttype":"switch","maxvalue":"100","minvalue":"15","name":"","namespace":"light","offvalue":"0","offvalue2":"0","onvalue":"100","peerid":"7","step":"1","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":680,"y":1070,"z":"cc109e74.5fbec"},{"broker":"951b3e2.1a5d3c","id":"e192ed1.14eb19","name":"","namespace":"mqtt","retain":"false","topic":"nodeblue/1/neopixel/brightness","type":"mqtt-out","wires":[],"x":640,"y":1130,"z":"cc109e74.5fbec"},{"field":"payload","format":"handlebars","id":"c416a8.bf3e0958","name":"0","namespace":"template","output":"json","syntax":"mustache","template":"0","type":"template","wires":[[{"id":"e192ed1.14eb19","port":0}]],"x":420,"y":1150,"z":"cc109e74.5fbec"},{"field":"payload","format":"handlebars","id":"90466c02.185f18","name":"false","namespace":"template","output":"json","syntax":"mustache","template":"false","type":"template","wires":[[{"id":"cfab0902.89d938","port":0}]],"x":420,"y":1100,"z":"cc109e74.5fbec"},{"channel":"1","factor":"0.03","family":"11","id":"54ba3e2b.e51f58","inputs":1,"interval":"100","lighttype":"switch","maxvalue":"100","minvalue":"15","name":"","namespace":"light","offvalue":"0","offvalue2":"0","onvalue":"100","peerid":"7","step":"1","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":685,"y":1750,"z":"cc109e74.5fbec"},{"channel":"1","family":"14","id":"d2f6d3e.401ebb","loopprevention":false,"looppreventiongroup":"","name":"","namespace":"variable","outputonstartup":false,"peerid":"19","refractoryperiod":"0","type":"variable-in","variable":"SCENE_COSY","variabletype":"device","wires":[[{"id":"31ff0d63.87a282","port":0},{"id":"ce1b549b.a46fd","port":0},{"id":"42c0b02.9373fd","port":0},{"id":"e3158c4d.015088","port":0}]],"x":115,"y":1200,"z":"cc109e74.5fbec"},{"field":"payload","format":"handlebars","id":"31ff0d63.87a282","name":"0","namespace":"template","output":"json","syntax":"mustache","template":"0.0","type":"template","wires":[[{"id":"a45ae70e.5c2318","port":0}]],"x":420,"y":1200,"z":"cc109e74.5fbec"},{"field":"payload","format":"handlebars","id":"42c0b02.9373fd","name":"true","namespace":"template","output":"json","syntax":"mustache","template":"true","type":"template","wires":[[{"id":"7d57ffbd.92bf8","port":0},{"id":"7d715088.4970b","port":0}]],"x":420,"y":1300,"z":"cc109e74.5fbec"},{"field":"payload","format":"handlebars","id":"ce1b549b.a46fd","name":"3000","namespace":"template","output":"json","syntax":"mustache","template":"3000.0","type":"template","wires":[[{"id":"cec98e42.d967e","port":0},{"id":"ac88b913.400a38","port":0}]],"x":420,"y":1250,"z":"cc109e74.5fbec"},{"channel":"4","factor":"0.03","family":"11","id":"7d57ffbd.92bf8","inputs":1,"interval":"100","lighttype":"switch","maxvalue":"100","minvalue":"15","name":"","namespace":"light","offvalue":"0","offvalue2":"0","onvalue":"100","peerid":"3","step":"1","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":680,"y":1290,"z":"cc109e74.5fbec"},{"channel":"1","factor":"0.03","family":"11","id":"7d715088.4970b","inputs":1,"interval":"100","lighttype":"switch","maxvalue":"100","minvalue":"15","name":"","namespace":"light","offvalue":"0","offvalue2":"0","onvalue":"100","peerid":"7","step":"1","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":680,"y":1320,"z":"cc109e74.5fbec"},{"broker":"951b3e2.1a5d3c","id":"5cf75134.fafac","name":"","namespace":"mqtt","retain":"false","topic":"nodeblue/1/neopixel/brightness","type":"mqtt-out","wires":[],"x":640,"y":1350,"z":"cc109e74.5fbec"},{"field":"payload","format":"handlebars","id":"e3158c4d.015088","name":"0","namespace":"template","output":"json","syntax":"mustache","template":"0","type":"template","wires":[[{"id":"5cf75134.fafac","port":0}]],"x":420,"y":1350,"z":"cc109e74.5fbec"},{"channel":"1","family":"14","id":"b503486.ee3e8b8","loopprevention":false,"looppreventiongroup":"","name":"","namespace":"variable","outputonstartup":false,"peerid":"19","refractoryperiod":"0","type":"variable-in","variable":"SCENE_READING","variabletype":"device","wires":[[{"id":"30127c84.61de5c","port":0},{"id":"7ccd9516.008a7c","port":0},{"id":"6eb1ab21.c55f3c","port":0},{"id":"a43ddded.beb87","port":0}]],"x":125,"y":1400,"z":"cc109e74.5fbec"},{"field":"payload","format":"handlebars","id":"30127c84.61de5c","name":"0","namespace":"template","output":"json","syntax":"mustache","template":"0.0","type":"template","wires":[[{"id":"7dbb1fef.10f2d","port":0}]],"x":420,"y":1400,"z":"cc109e74.5fbec"},{"field":"payload","format":"handlebars","id":"6eb1ab21.c55f3c","name":"true","namespace":"template","output":"json","syntax":"mustache","template":"true","type":"template","wires":[[{"id":"8bab08f8.690378","port":0},{"id":"94feb91a.96e158","port":0}]],"x":420,"y":1500,"z":"cc109e74.5fbec"},{"field":"payload","format":"handlebars","id":"7ccd9516.008a7c","name":"10000","namespace":"template","output":"json","syntax":"mustache","template":"10000.0","type":"template","wires":[[{"id":"4a7cfec4.42a288","port":0},{"id":"d420849a.6610d","port":0}]],"x":420,"y":1450,"z":"cc109e74.5fbec"},{"channel":"4","factor":"0.03","family":"11","id":"8bab08f8.690378","inputs":1,"interval":"100","lighttype":"switch","maxvalue":"100","minvalue":"15","name":"","namespace":"light","offvalue":"0","offvalue2":"0","onvalue":"100","peerid":"3","step":"1","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":680,"y":1490,"z":"cc109e74.5fbec"},{"channel":"1","factor":"0.03","family":"11","id":"94feb91a.96e158","inputs":1,"interval":"100","lighttype":"switch","maxvalue":"100","minvalue":"15","name":"","namespace":"light","offvalue":"0","offvalue2":"0","onvalue":"100","peerid":"7","step":"1","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":680,"y":1520,"z":"cc109e74.5fbec"},{"broker":"951b3e2.1a5d3c","id":"e307ee31.9aca1","name":"","namespace":"mqtt","retain":"false","topic":"nodeblue/1/neopixel/brightness","type":"mqtt-out","wires":[],"x":640,"y":1550,"z":"cc109e74.5fbec"},{"field":"payload","format":"handlebars","id":"a43ddded.beb87","name":"0","namespace":"template","output":"json","syntax":"mustache","template":"0","type":"template","wires":[[{"id":"e307ee31.9aca1","port":0}]],"x":420,"y":1550,"z":"cc109e74.5fbec"},{"channel":"1","family":"11","id":"f1e9e243.99916","name":"","namespace":"variable","peerid":"16","type":"variable-out","variable":"LEVEL","variabletype":"device","wires":[],"x":685,"y":450,"z":"cc109e74.5fbec"},{"channel":"1","family":"11","id":"578eb48e.c7dda4","name":"","namespace":"variable","peerid":"72","type":"variable-out","variable":"LEVEL","variabletype":"device","wires":[],"x":685,"y":480,"z":"cc109e74.5fbec"},{"channel":"1","family":"11","id":"f772be45.c4bfe8","name":"","namespace":"variable","peerid":"17","type":"variable-out","variable":"LEVEL","variabletype":"device","wires":[],"x":685,"y":510,"z":"cc109e74.5fbec"},{"channel":"1","family":"11","id":"c7c3b23.e5321d","name":"","namespace":"variable","peerid":"16","type":"variable-out","variable":"LEVEL","variabletype":"device","wires":[],"x":680,"y":700,"z":"cc109e74.5fbec"},{"channel":"1","family":"11","id":"38d35f58.41487","name":"","namespace":"variable","peerid":"72","type":"variable-out","variable":"LEVEL","variabletype":"device","wires":[],"x":680,"y":730,"z":"cc109e74.5fbec"},{"channel":"1","family":"11","id":"fc9ea62f.05feb8","name":"","namespace":"variable","peerid":"17","type":"variable-out","variable":"LEVEL","variabletype":"device","wires":[],"x":680,"y":760,"z":"cc109e74.5fbec"},{"channel":"1","family":"11","id":"df2ea62d.591868","name":"","namespace":"variable","peerid":"16","type":"variable-out","variable":"LEVEL","variabletype":"device","wires":[],"x":680,"y":950,"z":"cc109e74.5fbec"},{"channel":"1","family":"11","id":"bd87eb1.4606b18","name":"","namespace":"variable","peerid":"72","type":"variable-out","variable":"LEVEL","variabletype":"device","wires":[],"x":680,"y":980,"z":"cc109e74.5fbec"},{"channel":"1","family":"11","id":"f5074447.61513","name":"","namespace":"variable","peerid":"17","type":"variable-out","variable":"LEVEL","variabletype":"device","wires":[],"x":680,"y":1010,"z":"cc109e74.5fbec"},{"channel":"1","family":"11","id":"a45ae70e.5c2318","name":"","namespace":"variable","peerid":"16","type":"variable-out","variable":"LEVEL","variabletype":"device","wires":[],"x":680,"y":1200,"z":"cc109e74.5fbec"},{"channel":"1","family":"11","id":"cec98e42.d967e","name":"","namespace":"variable","peerid":"72","type":"variable-out","variable":"LEVEL","variabletype":"device","wires":[],"x":680,"y":1230,"z":"cc109e74.5fbec"},{"channel":"1","family":"11","id":"ac88b913.400a38","name":"","namespace":"variable","peerid":"17","type":"variable-out","variable":"LEVEL","variabletype":"device","wires":[],"x":680,"y":1260,"z":"cc109e74.5fbec"},{"channel":"1","family":"11","id":"7dbb1fef.10f2d","name":"","namespace":"variable","peerid":"16","type":"variable-out","variable":"LEVEL","variabletype":"device","wires":[],"x":680,"y":1400,"z":"cc109e74.5fbec"},{"channel":"1","family":"11","id":"4a7cfec4.42a288","name":"","namespace":"variable","peerid":"72","type":"variable-out","variable":"LEVEL","variabletype":"device","wires":[],"x":680,"y":1430,"z":"cc109e74.5fbec"},{"channel":"1","family":"11","id":"d420849a.6610d","name":"","namespace":"variable","peerid":"17","type":"variable-out","variable":"LEVEL","variabletype":"device","wires":[],"x":680,"y":1460,"z":"cc109e74.5fbec"},{"channel":"1","family":"11","id":"eb82dda1.deed4","name":"","namespace":"variable","peerid":"16","type":"variable-out","variable":"LEVEL","variabletype":"device","wires":[],"x":680,"y":1600,"z":"cc109e74.5fbec"},{"channel":"1","family":"11","id":"a4e0a6e2.9901f8","name":"","namespace":"variable","peerid":"72","type":"variable-out","variable":"LEVEL","variabletype":"device","wires":[],"x":680,"y":1630,"z":"cc109e74.5fbec"},{"channel":"1","family":"11","id":"47da1f59.b8d8b","name":"","namespace":"variable","peerid":"17","type":"variable-out","variable":"LEVEL","variabletype":"device","wires":[],"x":680,"y":1660,"z":"cc109e74.5fbec"},{"id":"9b955e9f.b3ed48","name":"Siemens SENTRON PAC3200","namespace":"modbus","outputs":14,"registers":[{"c":"2","ib":false,"ir":false,"mt":0,"r":"19","t":"float"},{"c":"2","ib":false,"ir":false,"mt":0,"r":"21","t":"float"},{"c":"2","ib":false,"ir":false,"mt":0,"r":"23","t":"float"},{"c":"2","ib":false,"ir":false,"mt":0,"r":"25","t":"float"},{"c":"2","ib":false,"ir":false,"mt":0,"r":"27","t":"float"},{"c":"2","ib":false,"ir":false,"mt":0,"r":"29","t":"float"},{"c":"2","ib":false,"ir":false,"mt":0,"r":"31","t":"float"},{"c":"2","ib":false,"ir":false,"mt":0,"r":"33","t":"float"},{"c":"2","ib":false,"ir":false,"mt":0,"r":"35","t":"float"},{"c":"2","ib":false,"ir":false,"mt":0,"r":"63","t":"float"},{"c":"2","ib":false,"ir":false,"mt":0,"r":"65","t":"float"},{"c":"2","ib":false,"ir":false,"mt":0,"r":"67","t":"float"},{"c":"4","ib":false,"ir":false,"mt":0,"r":"801","t":"float"},{"c":"4","ib":false,"ir":false,"mt":0,"r":"805","t":"float"}],"server":"e384e937.c38998","type":"modbus-in","wires":[[{"id":"b0aaa59c.12c578","port":0}],[{"id":"c6a8871e.086028","port":0}],[{"id":"e814c9a4.46b988","port":0}],[{"id":"6d7ad8b8.15ce9","port":0}],[{"id":"db2639e6.5abf3","port":0}],[{"id":"c9a6eacb.e2043","port":0}],[{"id":"30f4560.93703aa","port":0}],[{"id":"cf54b3a5.aa02e","port":0}],[{"id":"7adc2dd8.104324","port":0}],[{"id":"1d421e15.f7ac22","port":0}],[{"id":"e65c9337.f83ba8","port":0}],[{"id":"b2b2affe.46b9b8","port":0}],[{"id":"144b77ed.26ea18","port":0},{"id":"d7cbf398.5486a8","port":0}],[{"id":"cbfeaa35.65d25","port":0}]],"x":140,"y":240,"z":"fee4d3bf.0b14a8"},{"id":"b0aaa59c.12c578","measurement":"Scheinleistung.L1","name":"Scheinleistung L1","namespace":"influxdb","type":"influxdb","wires":[],"x":490,"y":40,"z":"fee4d3bf.0b14a8"},{"id":"c6a8871e.086028","measurement":"Scheinleistung.L2","name":"Scheinleistung L2","namespace":"influxdb","type":"influxdb","wires":[],"x":490,"y":70,"z":"fee4d3bf.0b14a8"},{"id":"e814c9a4.46b988","measurement":"Scheinleistung.L3","name":"Scheinleistung L3","namespace":"influxdb","type":"influxdb","wires":[],"x":490,"y":100,"z":"fee4d3bf.0b14a8"},{"id":"6d7ad8b8.15ce9","measurement":"Wirkleistung.L1","name":"Wirkleistung L1","namespace":"influxdb","type":"influxdb","wires":[],"x":480,"y":130,"z":"fee4d3bf.0b14a8"},{"id":"db2639e6.5abf3","measurement":"Wirkleistung.L2","name":"Wirkleistung L2","namespace":"influxdb","type":"influxdb","wires":[],"x":480,"y":160,"z":"fee4d3bf.0b14a8"},{"id":"c9a6eacb.e2043","measurement":"Wirkleistung.L3","name":"Wirkleistung L3","namespace":"influxdb","type":"influxdb","wires":[],"x":480,"y":190,"z":"fee4d3bf.0b14a8"},{"id":"30f4560.93703aa","measurement":"Blindleistung.L1","name":"Blindleistung L1","namespace":"influxdb","type":"influxdb","wires":[],"x":480,"y":220,"z":"fee4d3bf.0b14a8"},{"id":"cf54b3a5.aa02e","measurement":"Blindleistung.L2","name":"Blindleistung L2","namespace":"influxdb","type":"influxdb","wires":[],"x":480,"y":250,"z":"fee4d3bf.0b14a8"},{"id":"7adc2dd8.104324","measurement":"Blindleistung.L3","name":"Blindleistung L3","namespace":"influxdb","type":"influxdb","wires":[],"x":480,"y":280,"z":"fee4d3bf.0b14a8"},{"id":"1d421e15.f7ac22","measurement":"Scheinleistung.L1-3","name":"Scheinleistung Summe","namespace":"influxdb","type":"influxdb","wires":[],"x":500,"y":310,"z":"fee4d3bf.0b14a8"},{"id":"e65c9337.f83ba8","measurement":"Wirkleistung.L1-3","name":"Wirkleistung Summe","namespace":"influxdb","type":"influxdb","wires":[],"x":500,"y":340,"z":"fee4d3bf.0b14a8"},{"id":"b2b2affe.46b9b8","measurement":"Blindleistung.L1-3","name":"Blindleistung Summe","namespace":"influxdb","type":"influxdb","wires":[],"x":500,"y":370,"z":"fee4d3bf.0b14a8"},{"id":"144b77ed.26ea18","measurement":"Wirkarbeit.Bezug.Tarif1","name":"Wirkarbeit HT","namespace":"influxdb","type":"influxdb","wires":[],"x":480,"y":400,"z":"fee4d3bf.0b14a8"},{"id":"cbfeaa35.65d25","measurement":"Wirkarbeit.Bezug.Tarif2","name":"Wirkarbeit NT","namespace":"influxdb","type":"influxdb","wires":[],"x":480,"y":460,"z":"fee4d3bf.0b14a8"},{"channel":"12","family":"14","id":"5bd68efb.8f03a","name":"Wirkarbeit","namespace":"variable","peerid":"19","type":"variable-out","variable":"WORK","variabletype":"device","wires":[],"x":620,"y":430,"z":"fee4d3bf.0b14a8"},{"channel":"12","family":"14","id":"564de489.9a52fc","name":"","namespace":"variable","peerid":"19","type":"variable-out","variable":"TEMPERATURE","variabletype":"device","wires":[],"x":355,"y":2640,"z":"cc109e74.5fbec"},{"func":"$offset = (int)getFlowData('lastWorkOffset');\n$lastValue = getFlowData('lastWorkValue');\n$message['payload'] = (int)round($message['payload'] / 1000.0);\nif($lastValue == $message['payload']) return NULL;\nsetFlowData('lastWorkValue', $message['payload']);\n$message['payload'] -= $offset;\nreturn $message;","id":"d7cbf398.5486a8","inputs":1,"name":"","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[{"id":"5bd68efb.8f03a","port":0}]],"x":460,"y":430,"z":"fee4d3bf.0b14a8"},{"id":"83ff5ada.9ff708","name":"","namespace":"timers","timestamp":true,"type":"clock","units":"dom","wires":[[{"id":"15b24558.a3379b","port":0}]],"x":80,"y":510,"z":"fee4d3bf.0b14a8"},{"func":"$localtime = localtime(time());\nif(($localtime[2] == 23 && $localtime[1] > 50) || ($localtime[2] == 0 && $localtime[1] < 10))\n{\n    setFlowData('lastWorkOffset', getFlowData('lastWorkValue'));\n}","id":"15b24558.a3379b","inputs":1,"name":"","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[]],"x":230,"y":510,"z":"fee4d3bf.0b14a8"},{"channel":"1","family":"14","id":"d4625947.358778","loopprevention":false,"looppreventiongroup":"4a09f7fb.c09be","name":"","namespace":"variable","outputonstartup":false,"peerid":"35","refractoryperiod":"0","type":"variable-in","variable":"STATE","variabletype":"device","wires":[[{"id":"e92fecb7.1c53d8","port":0}]],"x":95,"y":450,"z":"69ea3b1f.befffc"},{"channel":"1","family":"14","id":"9ecba362.98b928","loopprevention":false,"looppreventiongroup":"4a09f7fb.c09be","name":"","namespace":"variable","outputonstartup":false,"peerid":"36","refractoryperiod":"0","type":"variable-in","variable":"STATE","variabletype":"device","wires":[[{"id":"288cac96.d1a6a4","port":0}]],"x":100,"y":500,"z":"69ea3b1f.befffc"},{"channel":"3","factor":"","family":"11","id":"68528422.c83754","inputs":1,"interval":"","lighttype":"switch","maxvalue":"","minvalue":"","name":"","namespace":"light","offvalue":"0","offvalue2":"","onvalue":"100","peerid":"2","step":"","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":1010,"y":490,"z":"69ea3b1f.befffc"},{"channel":"3","family":"14","id":"380f1abf.174ebe","loopprevention":false,"looppreventiongroup":"4a09f7fb.c09be","name":"","namespace":"variable","outputonstartup":false,"peerid":"81","refractoryperiod":"0","type":"variable-in","variable":"MOTION","variabletype":"device","wires":[[{"id":"af7b0410.31b6b","port":0},{"id":"ab2ba03.c3fd2e","port":0}]],"x":100,"y":650,"z":"69ea3b1f.befffc"},{"id":"c174338b.b621c8","name":"","namespace":"timers","off-delay":"60000","type":"off-delay","wires":[[{"id":"bab3fbe1.d965c8","port":0}],[]],"x":720,"y":660,"z":"69ea3b1f.befffc"},{"func":"if($inputIndex == 0)\n{\n    $manual = getFlowData('light.1.3.manual');\n    if($message['payload'])\n    {\n        if($manual == 0)\n        {\n            setFlowData('light.1.3.manual', 1);\n            $hg->setValue(36, 12, 'STATE', 100);\n            $hg->setValue(37, 12, 'STATE', 100);\n            return array($message, array('payload' => false));\n        }\n        else if($manual == -1)\n        {\n            setFlowData('light.1.3.manual', 0);\n            $hg->setValue(36, 12, 'STATE', 0);\n            $hg->setValue(37, 12, 'STATE', 0);\n            return array($message, NULL);\n        }\n    }\n    else\n    {\n        if($manual == 1)\n        {\n            setFlowData('light.1.3.manual', 0);\n            $hg->setValue(36, 12, 'STATE', 0);\n            $hg->setValue(37, 12, 'STATE', 0);\n            return array(NULL, array('payload' => true));\n        }\n        else if($manual == 0)\n        {\n            setFlowData('light.1.3.manual', -1);\n            $hg->setValue(36, 12, 'STATE', 1);\n            $hg->setValue(37, 12, 'STATE', 1);\n            return array($message, array('payload' => true));\n        }\n    }\n}\nelse if(!$message['payload'] && getFlowData('light.1.3.manual') == 1)\n{\n    setFlowData('light.1.3.manual', 0);\n    $hg->setValue(36, 12, 'STATE', 0);\n    $hg->setValue(37, 12, 'STATE', 0);\n    return array($message, array('payload' => true));\n}","id":"288cac96.d1a6a4","inputs":"2","name":"","namespace":"function","noerr":0,"outputs":"2","type":"function","wires":[[{"id":"bab3fbe1.d965c8","port":0},{"id":"303ff1f.b98cc0e","port":0}],[{"id":"4e8ad8c5.26c318","port":0}]],"x":520,"y":460,"z":"69ea3b1f.befffc"},{"id":"4e8ad8c5.26c318","name":"","namespace":"timers","off-delay":"14400000","type":"off-delay","wires":[[{"id":"288cac96.d1a6a4","port":1}],[]],"x":645,"y":490,"z":"69ea3b1f.befffc"},{"changes-only":false,"checkall":"true","id":"bab3fbe1.d965c8","inputs":1,"name":"","namespace":"basic-logic","output-false":false,"output-true":false,"outputs":1,"property":"payload","rules":[{"t":"nnull"}],"type":"switch","wires":[[{"id":"68528422.c83754","port":0},{"id":"2e5e5357.a10dfc","port":0},{"id":"6c453e9d.226148","port":0}]],"x":810,"y":450,"z":"69ea3b1f.befffc"},{"func":"$manual = getFlowData('light.1.3.manual');\nif($manual == 1) return NULL;\nelse if($manual == -1) return NULL;\nelse if((getGlobalData('night') || getFlowData('isDark')) && !getGlobalData('sleeping'))\n{\n    setNodeData('lastState', $message['payload']);\n    return array('payload' => $message['payload']);\n}\nelse\n{\n    $lastState = getNodeData('lastState');\n    if($lastState)\n    {\n        setNodeData('lastState', false);\n        return array('payload' => false);\n    }\n}","id":"ab2ba03.c3fd2e","inputs":1,"name":"","namespace":"function","noerr":0,"outputs":"1","type":"function","wires":[[{"id":"c174338b.b621c8","port":0},{"id":"3927af4a.d8ed68","port":0},{"id":"3927af4a.d8ed68","port":1}]],"x":320,"y":650,"z":"69ea3b1f.befffc"},{"channel":"1","family":"14","id":"3e75c483.610ca4","loopprevention":false,"looppreventiongroup":"","name":"","namespace":"variable","outputonstartup":false,"peerid":"81","refractoryperiod":"180000","type":"variable-in","variable":"BRIGHTNESS","variabletype":"device","wires":[[{"id":"2e96fb6f.e5b9bc","port":0}]],"x":115,"y":880,"z":"69ea3b1f.befffc"},{"func":"$isDarkGlobal = getGlobalData('isDark');\nif(!is_array($isDarkGlobal)) $isDarkGlobal = array();\n\nif(getGlobalData('night'))\n{\n    setFlowData('lastBrightnesses', array());\n    setFlowData('isDark', false);\n}\nelse if(!$hg->getValue(1, 4, 'STATE') && !$hg->getValue(2, 3, 'STATE') && !$hg->getValue(2, 4, 'STATE'))\n{\n    $brightnesses = getFlowData('lastBrightnesses');\n    if(!is_array($brightnesses)) $brightnesses = array($message['payload']);\n    else array_push($brightnesses, $message['payload']);\n    if(count($brightnesses) > 6) array_shift($brightnesses);\n    setFlowData('lastBrightnesses', $brightnesses);\n    foreach($brightnesses as $brightness)\n    {\n        if($brightness < 7000)\n        {\n            setFlowData('isDark', true);\n            return NULL;\n        }\n    }\n    \n    foreach($isDarkGlobal as $room => $isDark)\n    {\n        if($room != 'Treppenhaus' && $isDark)\n        {\n            setFlowData('isDark', true);\n            return NULL;\n        }\n    }\n    \n    setFlowData('isDark', false);\n}","id":"2e96fb6f.e5b9bc","inputs":1,"name":"","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[]],"x":320,"y":880,"z":"69ea3b1f.befffc"},{"channel":"1","family":"14","id":"7ea833d2.762294","loopprevention":false,"looppreventiongroup":"4a09f7fb.c09be","name":"","namespace":"variable","outputonstartup":false,"peerid":"37","refractoryperiod":"0","type":"variable-in","variable":"STATE","variabletype":"device","wires":[[{"id":"288cac96.d1a6a4","port":0}]],"x":100,"y":550,"z":"69ea3b1f.befffc"},{"channel":"2","family":"14","id":"266f0e0f.1cd1ca","loopprevention":false,"looppreventiongroup":"4a09f7fb.c09be","name":"","namespace":"variable","outputonstartup":false,"peerid":"94","refractoryperiod":"0","type":"variable-in","variable":"STATE","variabletype":"device","wires":[[{"id":"7380fa60.ae841c","port":0}]],"x":100,"y":600,"z":"69ea3b1f.befffc"},{"channel":"4","factor":"","family":"11","id":"2e5e5357.a10dfc","inputs":1,"interval":"","lighttype":"switch","maxvalue":"","minvalue":"","name":"","namespace":"light","offvalue":"0","offvalue2":"","onvalue":"100","peerid":"1","step":"","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":1010,"y":450,"z":"69ea3b1f.befffc"},{"channel":"4","factor":"","family":"11","id":"6c453e9d.226148","inputs":1,"interval":"","lighttype":"switch","maxvalue":"","minvalue":"","name":"","namespace":"light","offvalue":"0","offvalue2":"","onvalue":"100","peerid":"2","step":"","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":1010,"y":530,"z":"69ea3b1f.befffc"},{"channel":"2","family":"14","id":"28f56d25.4b75f2","loopprevention":false,"looppreventiongroup":"4a09f7fb.c09be","name":"Kueche Praesenz","namespace":"variable","outputonstartup":false,"peerid":"82","refractoryperiod":"0","type":"variable-in","variable":"MOTION","variabletype":"device","wires":[[{"id":"efd83737.044538","port":0}]],"x":100,"y":530,"z":"1755f935.cee76f"},{"channel":"2","family":"14","id":"74ebebfe.33ec0c","loopprevention":false,"looppreventiongroup":"4a09f7fb.c09be","name":"Wohnzimmer Praesenz","namespace":"variable","outputonstartup":false,"peerid":"63","refractoryperiod":"0","type":"variable-in","variable":"MOTION","variabletype":"device","wires":[[{"id":"7a6aa8bc.1ff57","port":0}]],"x":120,"y":330,"z":"1755f935.cee76f"},{"id":"e076a297.11dbf8","name":"","namespace":"timers","off-delay":"60000","type":"off-delay","wires":[[{"id":"303ff1f.b98cc0e","port":0}],[]],"x":720,"y":720,"z":"69ea3b1f.befffc"},{"func":"$manual = getFlowData('light.1.3.manual');\nif($manual == 1) return NULL;\nelse if($manual == -1) return NULL;\nelse return array('payload' => $message['payload']);","id":"af7b0410.31b6b","inputs":1,"name":"","namespace":"function","noerr":0,"outputs":"1","type":"function","wires":[[{"id":"e076a297.11dbf8","port":0},{"id":"fc097922.cdf6b8","port":0},{"id":"fc097922.cdf6b8","port":1}]],"x":320,"y":710,"z":"69ea3b1f.befffc"},{"broker":"951b3e2.1a5d3c","id":"54d2e4e0.bf695c","name":"","namespace":"mqtt","retain":"false","topic":"nodeblue/1/dotstar/state","type":"mqtt-out","wires":[],"x":1030,"y":720,"z":"69ea3b1f.befffc"},{"func":"if(getGlobalData('sleeping') && $message['payload']) $message['payload'] = 2;\nreturn $message;","id":"303ff1f.b98cc0e","inputs":1,"name":"","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[{"id":"54d2e4e0.bf695c","port":0}]],"x":870,"y":720,"z":"69ea3b1f.befffc"},{"id":"7da49dbb.e3a4d4","name":"","namespace":"timers","on-delay":"100","type":"on-delay","wires":[[{"id":"cf695765.99132","port":0}],[]],"x":465,"y":250,"z":"302d5ee5.37b1aa"},{"changes-only":false,"checkall":"true","id":"cf695765.99132","inputs":1,"name":"","namespace":"basic-logic","output-false":false,"output-true":false,"outputs":1,"property":"payload","rules":[{"t":"true"}],"type":"switch","wires":[[{"id":"b451c1cd.c5f54","port":0}]],"x":595,"y":240,"z":"302d5ee5.37b1aa"},{"id":"b451c1cd.c5f54","name":"","namespace":"basic-logic","type":"not","wires":[[{"id":"39fa65aa.e2791a","port":0}]],"x":715,"y":240,"z":"302d5ee5.37b1aa"},{"id":"3927af4a.d8ed68","name":"","namespace":"timers","on-delay":"100","type":"on-delay","wires":[[{"id":"dc9b691e.57d8","port":0}],[]],"x":445,"y":590,"z":"69ea3b1f.befffc"},{"changes-only":false,"checkall":"true","id":"dc9b691e.57d8","inputs":1,"name":"","namespace":"basic-logic","output-false":false,"output-true":false,"outputs":1,"property":"payload","rules":[{"t":"true"}],"type":"switch","wires":[[{"id":"e8c731f4.10ade8","port":0}]],"x":585,"y":580,"z":"69ea3b1f.befffc"},{"id":"e8c731f4.10ade8","name":"","namespace":"basic-logic","type":"not","wires":[[{"id":"c174338b.b621c8","port":0}]],"x":705,"y":580,"z":"69ea3b1f.befffc"},{"id":"fc097922.cdf6b8","name":"","namespace":"timers","on-delay":"100","type":"on-delay","wires":[[{"id":"117f0b74.9f4e15","port":0}],[]],"x":450,"y":780,"z":"69ea3b1f.befffc"},{"changes-only":false,"checkall":"true","id":"117f0b74.9f4e15","inputs":1,"name":"","namespace":"basic-logic","output-false":false,"output-true":false,"outputs":1,"property":"payload","rules":[{"t":"true"}],"type":"switch","wires":[[{"id":"a52720bf.6404e8","port":0}]],"x":585,"y":770,"z":"69ea3b1f.befffc"},{"id":"a52720bf.6404e8","name":"","namespace":"basic-logic","type":"not","wires":[[{"id":"e076a297.11dbf8","port":0}]],"x":705,"y":770,"z":"69ea3b1f.befffc"},{"id":"252b2dab.7171c2","name":"","namespace":"timers","on-delay":"100","type":"on-delay","wires":[[{"id":"4b5f5aec.55118c","port":0}],[]],"x":445,"y":270,"z":"b9b74dfe.3575c"},{"changes-only":false,"checkall":"true","id":"4b5f5aec.55118c","inputs":1,"name":"","namespace":"basic-logic","output-false":false,"output-true":false,"outputs":1,"property":"payload","rules":[{"t":"true"}],"type":"switch","wires":[[{"id":"56b6d7e3.8c7c6","port":0}]],"x":575,"y":260,"z":"b9b74dfe.3575c"},{"id":"56b6d7e3.8c7c6","name":"","namespace":"basic-logic","type":"not","wires":[[{"id":"4808bb60.328bac","port":0}]],"x":695,"y":260,"z":"b9b74dfe.3575c"},{"id":"7e139dd2.4aaf14","name":"","namespace":"timers","on-delay":"100","type":"on-delay","wires":[[{"id":"743c559c.b55af4","port":0}],[]],"x":515,"y":240,"z":"4d2cb67e.e7f9b"},{"changes-only":false,"checkall":"true","id":"743c559c.b55af4","inputs":1,"name":"","namespace":"basic-logic","output-false":false,"output-true":false,"outputs":1,"property":"payload","rules":[{"t":"true"}],"type":"switch","wires":[[{"id":"e4ea52d.fd9f23","port":0}]],"x":645,"y":230,"z":"4d2cb67e.e7f9b"},{"id":"e4ea52d.fd9f23","name":"","namespace":"basic-logic","type":"not","wires":[[{"id":"4245d7ac.7af81","port":0}]],"x":765,"y":230,"z":"4d2cb67e.e7f9b"},{"id":"b433ed95.8b949","name":"","namespace":"timers","on-delay":"100","type":"on-delay","wires":[[{"id":"1cfe9069.9eea58","port":0}],[]],"x":535,"y":250,"z":"e75b7fd7.a33d6"},{"changes-only":false,"checkall":"true","id":"1cfe9069.9eea58","inputs":1,"name":"","namespace":"basic-logic","output-false":false,"output-true":false,"outputs":1,"property":"payload","rules":[{"t":"true"}],"type":"switch","wires":[[{"id":"94b330af.0b7e48","port":0}]],"x":665,"y":240,"z":"e75b7fd7.a33d6"},{"id":"94b330af.0b7e48","name":"","namespace":"basic-logic","type":"not","wires":[[{"id":"3dcef173.939806","port":0}]],"x":785,"y":240,"z":"e75b7fd7.a33d6"},{"channel":"11","family":"14","id":"b8146ef4.01ae4","loopprevention":false,"looppreventiongroup":"dfc2bc9b.417f1","name":"","namespace":"variable","outputonstartup":false,"peerid":"40","refractoryperiod":"0","type":"variable-in","variable":"PLAY","variabletype":"device","wires":[[{"id":"1705e2a8.6d361d","port":0}]],"x":90,"y":1010,"z":"e75b7fd7.a33d6"},{"id":"c61ccbb2.16d308","info":"","name":"Sonos","namespace":"comment","type":"comment","wires":[],"x":80,"y":960,"z":"e75b7fd7.a33d6"},{"channel":"1","family":"6","id":"a68a256c.7e1c8","name":"","namespace":"variable","peerid":"25","type":"variable-out","variable":"PLAY","variabletype":"device","wires":[],"x":500,"y":1010,"z":"e75b7fd7.a33d6"},{"changes-only":false,"checkall":"true","id":"1705e2a8.6d361d","inputs":1,"name":"","namespace":"basic-logic","output-false":false,"output-true":false,"outputs":1,"property":"payload","rules":[{"t":"true"}],"type":"switch","wires":[[{"id":"a68a256c.7e1c8","port":0}]],"x":290,"y":1010,"z":"e75b7fd7.a33d6"},{"channel":"11","family":"14","id":"29fc1750.51d898","loopprevention":false,"looppreventiongroup":"dfc2bc9b.417f1","name":"","namespace":"variable","outputonstartup":false,"peerid":"40","refractoryperiod":"0","type":"variable-in","variable":"PAUSE","variabletype":"device","wires":[[{"id":"8be8eb1b.4b0a4","port":0}]],"x":95,"y":1060,"z":"e75b7fd7.a33d6"},{"channel":"1","family":"6","id":"cc7fb2da.89d9c","name":"","namespace":"variable","peerid":"25","type":"variable-out","variable":"PAUSE","variabletype":"device","wires":[],"x":490,"y":1060,"z":"e75b7fd7.a33d6"},{"changes-only":false,"checkall":"true","id":"8be8eb1b.4b0a4","inputs":1,"name":"","namespace":"basic-logic","output-false":false,"output-true":false,"outputs":1,"property":"payload","rules":[{"t":"true"}],"type":"switch","wires":[[{"id":"cc7fb2da.89d9c","port":0}]],"x":290,"y":1060,"z":"e75b7fd7.a33d6"},{"channel":"11","family":"14","id":"523be50a.19583c","loopprevention":false,"looppreventiongroup":"dfc2bc9b.417f1","name":"","namespace":"variable","outputonstartup":false,"peerid":"40","refractoryperiod":"0","type":"variable-in","variable":"NEXT","variabletype":"device","wires":[[{"id":"48013c22.f02424","port":0}]],"x":95,"y":1110,"z":"e75b7fd7.a33d6"},{"channel":"1","family":"6","id":"1361d8f8.60273f","name":"","namespace":"variable","peerid":"25","type":"variable-out","variable":"NEXT","variabletype":"device","wires":[],"x":490,"y":1110,"z":"e75b7fd7.a33d6"},{"changes-only":false,"checkall":"true","id":"48013c22.f02424","inputs":1,"name":"","namespace":"basic-logic","output-false":false,"output-true":false,"outputs":1,"property":"payload","rules":[{"t":"true"}],"type":"switch","wires":[[{"id":"1361d8f8.60273f","port":0}]],"x":290,"y":1110,"z":"e75b7fd7.a33d6"},{"channel":"11","family":"14","id":"a9d6d21d.0a5b08","loopprevention":false,"looppreventiongroup":"dfc2bc9b.417f1","name":"","namespace":"variable","outputonstartup":false,"peerid":"40","refractoryperiod":"0","type":"variable-in","variable":"PREVIOUS","variabletype":"device","wires":[[{"id":"5561803f.fd1598","port":0}]],"x":110,"y":1160,"z":"e75b7fd7.a33d6"},{"channel":"1","family":"6","id":"2d89d33c.040164","name":"","namespace":"variable","peerid":"25","type":"variable-out","variable":"PREVIOUS","variabletype":"device","wires":[],"x":480,"y":1160,"z":"e75b7fd7.a33d6"},{"changes-only":false,"checkall":"true","id":"5561803f.fd1598","inputs":1,"name":"","namespace":"basic-logic","output-false":false,"output-true":false,"outputs":1,"property":"payload","rules":[{"t":"true"}],"type":"switch","wires":[[{"id":"2d89d33c.040164","port":0}]],"x":290,"y":1160,"z":"e75b7fd7.a33d6"},{"channel":"11","family":"14","id":"c6562926.cb087","loopprevention":true,"looppreventiongroup":"dfc2bc9b.417f1","name":"","namespace":"variable","outputonstartup":false,"peerid":"40","refractoryperiod":"0","type":"variable-in","variable":"VOLUME","variabletype":"device","wires":[[{"id":"52113bd5.b142d4","port":0}]],"x":105,"y":1210,"z":"e75b7fd7.a33d6"},{"channel":"1","family":"6","id":"52113bd5.b142d4","name":"","namespace":"variable","peerid":"25","type":"variable-out","variable":"VOLUME","variabletype":"device","wires":[],"x":480,"y":1210,"z":"e75b7fd7.a33d6"},{"channel":"1","family":"6","id":"dc7d1e8f.4d0cc","loopprevention":true,"looppreventiongroup":"dfc2bc9b.417f1","name":"","namespace":"variable","outputonstartup":false,"peerid":"25","refractoryperiod":"0","type":"variable-in","variable":"VOLUME","variabletype":"device","wires":[[{"id":"f152be89.0290a","port":0}]],"x":100,"y":1260,"z":"e75b7fd7.a33d6"},{"channel":"11","family":"14","id":"f152be89.0290a","name":"","namespace":"variable","peerid":"40","type":"variable-out","variable":"VOLUME","variabletype":"device","wires":[],"x":485,"y":1260,"z":"e75b7fd7.a33d6"},{"channel":"1","family":"6","id":"5aa094f.8204bec","name":"","namespace":"variable","peerid":"25","type":"variable-out","variable":"PAUSE","variabletype":"device","wires":[],"x":700,"y":420,"z":"e75b7fd7.a33d6"},{"channel":"1","family":"14","id":"4d61f4ff.c3d714","loopprevention":false,"looppreventiongroup":"4a09f7fb.c09be","name":"","namespace":"variable","outputonstartup":false,"peerid":"40","refractoryperiod":"0","type":"variable-in","variable":"SCENE","variabletype":"device","wires":[[{"id":"c66688fd.57cfa","port":0}]],"x":100,"y":50,"z":"ed2293b3.9cd52"},{"changes-only":false,"checkall":"true","id":"c66688fd.57cfa","inputs":1,"name":"","namespace":"basic-logic","output-false":false,"output-true":true,"outputs":2,"property":"payload","rules":[{"t":"eq","v":"0","vt":"int"},{"t":"eq","v":"1","vt":"int"}],"type":"switch","wires":[[{"id":"1d41b70.fe79fc9","port":0},{"id":"c214d311.0887c","port":0}],[{"id":"639dab4a.4333e4","port":0},{"id":"4e5bbfb7.3a1b7","port":0},{"id":"23bc982c.55065","port":1},{"id":"f9df5da0.539778","port":0}]],"x":310,"y":50,"z":"ed2293b3.9cd52"},{"channel":"12","family":"14","id":"1d41b70.fe79fc9","name":"","namespace":"variable","peerid":"40","type":"variable-out","variable":"LOCK_SCREEN","variabletype":"device","wires":[],"x":670,"y":40,"z":"ed2293b3.9cd52"},{"func":"if($message['payload']) setGlobalData('AlarmEnabledExternal', true);","id":"89a124d5.23ca5","inputs":1,"name":"","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[]],"x":810,"y":120,"z":"ed2293b3.9cd52"},{"func":"if($message['payload']) setGlobalData('AlarmEnabledExternal', false);","id":"639dab4a.4333e4","inputs":1,"name":"","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[]],"x":460,"y":200,"z":"ed2293b3.9cd52"},{"channel":"1","factor":"","family":"11","id":"aed5a172.646c88","inputs":1,"interval":"","lighttype":"switch","maxvalue":"","minvalue":"","name":"","namespace":"light","offvalue":"0","offvalue2":"","onvalue":"100","peerid":"72","step":"","twoinputs":false,"type":"light","variable":"LEVEL","variabletype":"device","wires":[],"x":725,"y":1200,"z":"3050d780.509968"},{"field":"payload","format":"handlebars","id":"c30301de.c08c5","name":"false","namespace":"template","output":"json","syntax":"plain","template":"false","type":"template","wires":[[{"id":"d92f689e.6e8e8","port":0}]],"x":540,"y":390,"z":"e75b7fd7.a33d6"},{"channel":"1","family":"15","id":"f473f662.73e788","name":"","namespace":"variable","peerid":"87","type":"variable-out","variable":"STATE","variabletype":"device","wires":[],"x":640,"y":710,"z":"e75b7fd7.a33d6"},{"channel":"1","family":"5","id":"4497479c.13de3","name":"","namespace":"variable","peerid":"88","type":"variable-out","variable":"STATE","variabletype":"device","wires":[],"x":640,"y":740,"z":"e75b7fd7.a33d6"},{"apr":true,"aug":true,"dec":true,"endoff":"0","feb":true,"fri":true,"id":"74668fba.3b24a","jan":true,"jul":true,"jun":true,"lat":"54.28438","lon":"10.17234","mar":true,"may":true,"mon":true,"name":"","namespace":"timers","nov":true,"oct":true,"offtime":"sunrise","offtimetype":"suntime","ontime":"sunset","ontimetype":"suntime","sat":true,"sep":true,"startoff":"0","startup":true,"sun":true,"thu":true,"tue":true,"type":"timer","wed":true,"wires":[[{"id":"f473f662.73e788","port":0},{"id":"4497479c.13de3","port":0}]],"x":80,"y":730,"z":"e75b7fd7.a33d6"},{"id":"1b278bdf.10711c","name":"","namespace":"variable","outputonstartup":false,"payload":"false","payloadType":"bool","type":"constant","wires":[[{"id":"f473f662.73e788","port":0},{"id":"4497479c.13de3","port":0}]],"x":330,"y":770,"z":"e75b7fd7.a33d6"},{"channel":"2","family":"14","id":"1e390508.98e1b3","loopprevention":false,"looppreventiongroup":"4a09f7fb.c09be","name":"","namespace":"variable","outputonstartup":false,"peerid":"78","refractoryperiod":"0","type":"variable-in","variable":"MOTION","variabletype":"device","wires":[[{"id":"b9d82ad5.7f14a8","port":0}]],"x":100,"y":170,"z":"ed2293b3.9cd52"},{"channel":"2","family":"14","id":"d011e29b.a2ec38","loopprevention":false,"looppreventiongroup":"4a09f7fb.c09be","name":"","namespace":"variable","outputonstartup":false,"peerid":"63","refractoryperiod":"0","type":"variable-in","variable":"MOTION","variabletype":"device","wires":[[{"id":"b9d82ad5.7f14a8","port":0}]],"x":100,"y":220,"z":"ed2293b3.9cd52"},{"channel":"2","family":"14","id":"b95e5c59.6159","loopprevention":false,"looppreventiongroup":"4a09f7fb.c09be","name":"","namespace":"variable","outputonstartup":false,"peerid":"76","refractoryperiod":"0","type":"variable-in","variable":"MOTION","variabletype":"device","wires":[[{"id":"b9d82ad5.7f14a8","port":0}]],"x":100,"y":270,"z":"ed2293b3.9cd52"},{"channel":"2","family":"14","id":"e39fb0e7.843638","loopprevention":false,"looppreventiongroup":"4a09f7fb.c09be","name":"","namespace":"variable","outputonstartup":false,"peerid":"77","refractoryperiod":"0","type":"variable-in","variable":"MOTION","variabletype":"device","wires":[[{"id":"b9d82ad5.7f14a8","port":0}]],"x":100,"y":320,"z":"ed2293b3.9cd52"},{"channel":"2","family":"14","id":"ea2f5c2a.f6313","loopprevention":false,"looppreventiongroup":"4a09f7fb.c09be","name":"","namespace":"variable","outputonstartup":false,"peerid":"79","refractoryperiod":"0","type":"variable-in","variable":"MOTION","variabletype":"device","wires":[[{"id":"b9d82ad5.7f14a8","port":0}]],"x":100,"y":370,"z":"ed2293b3.9cd52"},{"channel":"2","family":"14","id":"be9ca451.50c2a8","loopprevention":false,"looppreventiongroup":"4a09f7fb.c09be","name":"","namespace":"variable","outputonstartup":false,"peerid":"80","refractoryperiod":"0","type":"variable-in","variable":"MOTION","variabletype":"device","wires":[[{"id":"b9d82ad5.7f14a8","port":0}]],"x":100,"y":420,"z":"ed2293b3.9cd52"},{"channel":"2","family":"14","id":"2b5dad65.887f42","loopprevention":false,"looppreventiongroup":"4a09f7fb.c09be","name":"","namespace":"variable","outputonstartup":false,"peerid":"81","refractoryperiod":"0","type":"variable-in","variable":"MOTION","variabletype":"device","wires":[[{"id":"b9d82ad5.7f14a8","port":0}]],"x":100,"y":470,"z":"ed2293b3.9cd52"},{"channel":"2","family":"14","id":"bab41a17.ebc698","loopprevention":false,"looppreventiongroup":"4a09f7fb.c09be","name":"","namespace":"variable","outputonstartup":false,"peerid":"82","refractoryperiod":"0","type":"variable-in","variable":"MOTION","variabletype":"device","wires":[[{"id":"b9d82ad5.7f14a8","port":0}]],"x":100,"y":520,"z":"ed2293b3.9cd52"},{"channel":"2","family":"14","id":"ffd4e41e.158f4","loopprevention":false,"looppreventiongroup":"4a09f7fb.c09be","name":"","namespace":"variable","outputonstartup":false,"peerid":"83","refractoryperiod":"0","type":"variable-in","variable":"MOTION","variabletype":"device","wires":[[{"id":"b9d82ad5.7f14a8","port":0}]],"x":100,"y":570,"z":"ed2293b3.9cd52"},{"channel":"2","family":"14","id":"d8885729.d483e","loopprevention":false,"looppreventiongroup":"4a09f7fb.c09be","name":"","namespace":"variable","outputonstartup":false,"peerid":"84","refractoryperiod":"0","type":"variable-in","variable":"MOTION","variabletype":"device","wires":[[{"id":"b9d82ad5.7f14a8","port":0}]],"x":100,"y":620,"z":"ed2293b3.9cd52"},{"func":"return array('payload' => ($message['payload'] && getGlobalData('AlarmEnabledExternal')));","id":"b9d82ad5.7f14a8","inputs":1,"name":"","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[{"id":"f4afae0b.d09e38","port":0}]],"x":350,"y":390,"z":"ed2293b3.9cd52"},{"id":"7252c2c9.10fb7c","impulse":"900000","name":"","namespace":"timers","type":"impulse","wires":[[{"id":"b9652aef.c3ee9","port":0}]],"x":1000,"y":390,"z":"ed2293b3.9cd52"},{"id":"a6b04466.afe5d","message":"","name":"","namespace":"notification","recipient":"sathya@jabb3r.de","server":"cfef0792.97ae9","type":"xmpp","wires":[],"x":1480,"y":380,"z":"ed2293b3.9cd52"},{"changes-only":false,"checkall":"true","id":"b9652aef.c3ee9","inputs":1,"name":"","namespace":"basic-logic","output-false":false,"output-true":false,"outputs":2,"property":"payload","rules":[{"t":"true"},{"t":"false"}],"type":"switch","wires":[[{"id":"ae7432f9.105a98","port":0},{"id":"a8d4093c.68cc1","port":0}],[{"id":"8a411b60.fc641","port":0},{"id":"f145d1b3.48f928","port":0},{"id":"61c83517.2cd39c","port":0}]],"x":1150,"y":390,"z":"ed2293b3.9cd52"},{"field":"xmpp-message","format":"handlebars","id":"ae7432f9.105a98","name":"","namespace":"template","output":"str","syntax":"plain","template":"Alarm ausgeloest","type":"template","wires":[[{"id":"a6b04466.afe5d","port":0}]],"x":1310,"y":380,"z":"ed2293b3.9cd52"},{"field":"xmpp-message","format":"handlebars","id":"8a411b60.fc641","name":"","namespace":"template","output":"str","syntax":"plain","template":"Alarm wieder aus","type":"template","wires":[[{"id":"a6b04466.afe5d","port":0}]],"x":1310,"y":430,"z":"ed2293b3.9cd52"},{"id":"23bc982c.55065","name":"","namespace":"timers","on-delay":"300000","type":"on-delay","wires":[[{"id":"89a124d5.23ca5","port":0}],[]],"x":635,"y":140,"z":"ed2293b3.9cd52"},{"id":"4e5bbfb7.3a1b7","name":"","namespace":"basic-logic","type":"not","wires":[[{"id":"7252c2c9.10fb7c","port":0},{"id":"a5f3e144.4fac58","port":0},{"id":"bf00d25e.2dfc68","port":0},{"id":"3e4c5d60.b235da","port":0}]],"x":400,"y":250,"z":"ed2293b3.9cd52"},{"id":"a5f3e144.4fac58","name":"","namespace":"timers","on-delay":"30000","type":"on-delay","wires":[[{"id":"7252c2c9.10fb7c","port":0}],[]],"x":755,"y":400,"z":"ed2293b3.9cd52"},{"id":"c214d311.0887c","impulse":"180000","name":"","namespace":"timers","type":"impulse","wires":[[{"id":"23bc982c.55065","port":0}]],"x":480,"y":140,"z":"ed2293b3.9cd52"},{"id":"c9689b52.cde4d","message":"","name":"","namespace":"notification","recipient":"sathya@jabb3r.de","server":"cfef0792.97ae9","type":"xmpp","wires":[],"x":760,"y":250,"z":"ed2293b3.9cd52"},{"field":"xmpp-message","format":"handlebars","id":"bf00d25e.2dfc68","name":"","namespace":"template","output":"str","syntax":"plain","template":"Alarm stumm","type":"template","wires":[[{"id":"c9689b52.cde4d","port":0}]],"x":600,"y":250,"z":"ed2293b3.9cd52"},{"field":"payload","format":"handlebars","id":"f9df5da0.539778","name":"","namespace":"template","output":"json","syntax":"plain","template":"false","type":"template","wires":[[{"id":"23bc982c.55065","port":0}]],"x":520,"y":90,"z":"ed2293b3.9cd52"},{"id":"f4afae0b.d09e38","impulse":"900000","name":"","namespace":"timers","type":"impulse","wires":[[{"id":"a5f3e144.4fac58","port":0},{"id":"3e4c5d60.b235da","port":0}]],"x":490,"y":390,"z":"ed2293b3.9cd52"},{"channel":"2","eventsource":"all","family":"14","id":"6bbfa8dc.d4ffe8","loopprevention":false,"looppreventiongroup":"4a09f7fb.c09be","name":"","namespace":"variable","outputonstartup":false,"peerid":"34","refractoryperiod":"0","type":"variable-in","variable":"STATE","variabletype":"device","wires":[[{"id":"2e5fb139.97dbae","port":0},{"id":"15c6c027.23d4b","port":0}]],"x":95,"y":640,"z":"1755f935.cee76f"},{"func":"setGlobalData('sleeping', $message['payload']);\n$hg->setValue(34, 13, 'STATE', $message['payload'] ? 50 : 0);","id":"305668d7.04fed8","inputs":1,"name":"","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[]],"x":1000,"y":450,"z":"1755f935.cee76f"},{"changes-only":false,"checkall":"true","id":"2e5fb139.97dbae","inputs":1,"name":"","namespace":"basic-logic","output-false":false,"output-true":false,"outputs":2,"property":"payload","rules":[{"t":"false"},{"t":"true"}],"type":"switch","wires":[[{"id":"a7c4ce2c.73b3a","port":0}],[{"id":"64da1949.a67aa8","port":0},{"id":"77c2f10a.beb478","port":0},{"id":"6ed89c87.eb6484","port":0},{"id":"79a1e001.fe6e8","port":0},{"id":"4783618f.e4c098","port":0},{"id":"22b7908a.52ef5","port":0}]],"x":400,"y":640,"z":"1755f935.cee76f"},{"channel":"1","family":"6","id":"96866a4e.d054c","name":"","namespace":"variable","peerid":"73","type":"variable-out","variable":"PAUSE","variabletype":"device","wires":[],"x":705,"y":450,"z":"e75b7fd7.a33d6"},{"channel":"1","family":"6","id":"45db47e5.463908","name":"","namespace":"variable","peerid":"85","type":"variable-out","variable":"PAUSE","variabletype":"device","wires":[],"x":705,"y":480,"z":"e75b7fd7.a33d6"},{"channel":"1","family":"6","id":"c6c1124c.0bac68","name":"","namespace":"variable","peerid":"89","type":"variable-out","variable":"PAUSE","variabletype":"device","wires":[],"x":705,"y":510,"z":"e75b7fd7.a33d6"},{"channel":"1","family":"6","id":"502c7b72.e05404","name":"","namespace":"variable","peerid":"90","type":"variable-out","variable":"PAUSE","variabletype":"device","wires":[],"x":705,"y":540,"z":"e75b7fd7.a33d6"},{"channel":"1","family":"6","id":"64da1949.a67aa8","name":"","namespace":"variable","peerid":"25","type":"variable-out","variable":"PAUSE","variabletype":"device","wires":[],"x":645,"y":690,"z":"1755f935.cee76f"},{"channel":"1","family":"6","id":"77c2f10a.beb478","name":"","namespace":"variable","peerid":"73","type":"variable-out","variable":"PAUSE","variabletype":"device","wires":[],"x":650,"y":720,"z":"1755f935.cee76f"},{"channel":"1","family":"6","id":"6ed89c87.eb6484","name":"","namespace":"variable","peerid":"85","type":"variable-out","variable":"PAUSE","variabletype":"device","wires":[],"x":650,"y":750,"z":"1755f935.cee76f"},{"channel":"1","family":"6","id":"79a1e001.fe6e8","name":"","namespace":"variable","peerid":"89","type":"variable-out","variable":"PAUSE","variabletype":"device","wires":[],"x":650,"y":780,"z":"1755f935.cee76f"},{"channel":"1","family":"6","id":"4783618f.e4c098","name":"","namespace":"variable","peerid":"90","type":"variable-out","variable":"PAUSE","variabletype":"device","wires":[],"x":650,"y":810,"z":"1755f935.cee76f"},{"channel":"13","family":"14","id":"340eb389.576f6c","name":"","namespace":"variable","peerid":"34","type":"variable-out","variable":"STATE","variabletype":"device","wires":[],"x":780,"y":650,"z":"1755f935.cee76f"},{"field":"payload","format":"text","id":"22b7908a.52ef5","name":"","namespace":"template","output":"json","syntax":"plain","template":"50","type":"template","wires":[[{"id":"340eb389.576f6c","port":0}]],"x":580,"y":650,"z":"1755f935.cee76f"},{"field":"payload","format":"text","id":"a7c4ce2c.73b3a","name":"","namespace":"template","output":"json","syntax":"plain","template":"0","type":"template","wires":[[{"id":"340eb389.576f6c","port":0}]],"x":580,"y":610,"z":"1755f935.cee76f"},{"channel":"1","factor":"","family":"5","id":"dd57959c.ef49b","inputs":1,"interval":"","lighttype":"switch","maxvalue":"","minvalue":"","name":"","namespace":"light","offvalue":0,"offvalue2":"","onvalue":"254","peerid":"92","step":"","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":1085,"y":90,"z":"b9b74dfe.3575c"},{"channel":"1","family":"5","id":"249366cf.2cdf52","name":"","namespace":"variable","peerid":"92","type":"variable-out","variable":"BRIGHTNESS","variabletype":"device","wires":[],"x":1295,"y":180,"z":"b9b74dfe.3575c"},{"id":"f4ea0cb0.683d7","name":"","namespace":"passthrough","onboolean":true,"type":"passthrough","wires":[[{"id":"249366cf.2cdf52","port":0}]],"x":1090,"y":180,"z":"b9b74dfe.3575c"},{"id":"74b33872.8afc3","name":"","namespace":"variable","outputonstartup":true,"payload":"254","payloadType":"int","type":"constant","wires":[[{"id":"f4ea0cb0.683d7","port":0}]],"x":1070,"y":130,"z":"b9b74dfe.3575c"},{"id":"14643676.22248a","name":"","namespace":"synchronous","outputs":"2","type":"synchronous","wires":[[{"id":"dd57959c.ef49b","port":0}],[{"id":"f4ea0cb0.683d7","port":1}]],"x":910,"y":150,"z":"b9b74dfe.3575c"},{"id":"ae8d15e2.81eb58","name":"","namespace":"timers","on-delay":"7200000","type":"on-delay","wires":[[{"id":"305668d7.04fed8","port":0}],[]],"x":795,"y":460,"z":"1755f935.cee76f"},{"func":"if($message['payload'])\n{\n    setNodeData('lastEvent', time());\n    return $message;\n}\nelse\n{\n    $time = getNodeData('lastEvent');\n    $newTime = time();\n    if($newTime - $time > 180)\n    {\n        setNodeData('lastEvent', $newTime);\n        return array('payload' => false);\n    }\n}","id":"d404972.9ccba68","inputs":1,"name":"","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[{"id":"ae8d15e2.81eb58","port":0},{"id":"ae8d15e2.81eb58","port":1}]],"x":600,"y":450,"z":"1755f935.cee76f"},{"id":"ef811c3c.31e498","name":"","namespace":"timers","off-delay":"3600000","type":"off-delay","wires":[[{"id":"fa48f18a.592b08","port":0}],[]],"x":420,"y":140,"z":"71b14382.55983c"},{"id":"c738dc62.54289","name":"","namespace":"basic-logic","type":"not","wires":[[{"id":"ef811c3c.31e498","port":0},{"id":"ef811c3c.31e498","port":1}]],"x":265,"y":130,"z":"71b14382.55983c"},{"changes-only":false,"checkall":"true","id":"fa48f18a.592b08","inputs":1,"name":"","namespace":"basic-logic","output-false":false,"output-true":false,"outputs":1,"property":"payload","rules":[{"t":"false"}],"type":"switch","wires":[[{"id":"a3de26e5.33268","port":0}]],"x":575,"y":130,"z":"71b14382.55983c"},{"id":"f1340ccc.64d218","name":"","namespace":"timers","off-delay":"3600000","type":"off-delay","wires":[[{"id":"a4c9adf6.618238","port":0}],[]],"x":430,"y":140,"z":"1d6097ff.a1be1"},{"id":"c0b1bd2.ba1c24","name":"","namespace":"basic-logic","type":"not","wires":[[{"id":"f1340ccc.64d218","port":0},{"id":"f1340ccc.64d218","port":1}]],"x":275,"y":130,"z":"1d6097ff.a1be1"},{"changes-only":false,"checkall":"true","id":"a4c9adf6.618238","inputs":1,"name":"","namespace":"basic-logic","output-false":false,"output-true":false,"outputs":1,"property":"payload","rules":[{"t":"false"}],"type":"switch","wires":[[{"id":"e1413254.5f7b2","port":0}]],"x":585,"y":130,"z":"1d6097ff.a1be1"},{"id":"ea80224e.30ece8","name":"","namespace":"timers","off-delay":"3600000","type":"off-delay","wires":[[{"id":"17a4142e.6bcbb4","port":0}],[]],"x":385,"y":240,"z":"822c4be8.2ccc28"},{"id":"e2a18ca6.203318","name":"","namespace":"basic-logic","type":"not","wires":[[{"id":"ea80224e.30ece8","port":0},{"id":"ea80224e.30ece8","port":1}]],"x":235,"y":230,"z":"822c4be8.2ccc28"},{"changes-only":false,"checkall":"true","id":"17a4142e.6bcbb4","inputs":1,"name":"","namespace":"basic-logic","output-false":false,"output-true":false,"outputs":1,"property":"payload","rules":[{"t":"false"}],"type":"switch","wires":[[{"id":"3df3fab9.16a526","port":0}]],"x":545,"y":230,"z":"822c4be8.2ccc28"},{"channel":"1","family":"14","id":"3e4c5d60.b235da","name":"","namespace":"variable","peerid":"93","type":"variable-out","variable":"INSTALL_TEST","variabletype":"device","wires":[],"x":790,"y":450,"z":"ed2293b3.9cd52"},{"channel":"1","family":"14","id":"f84a99c6.aa205","name":"","namespace":"variable","peerid":"93","type":"variable-out","variable":"INSTALL_TEST","variabletype":"device","wires":[],"x":1500,"y":580,"z":"ed2293b3.9cd52"},{"field":"","format":"json","id":"f145d1b3.48f928","name":"false","namespace":"template","output":"json","syntax":"plain","template":"false","type":"template","wires":[[{"id":"f84a99c6.aa205","port":0}]],"x":1310,"y":580,"z":"ed2293b3.9cd52"},{"field":"","format":"json","id":"6e732ba0.cce7cc","name":"true","namespace":"template","output":"json","syntax":"plain","template":"true","type":"template","wires":[[{"id":"f8137f86.997c4","port":0}]],"x":1310,"y":480,"z":"ed2293b3.9cd52"},{"channel":"1","family":"14","id":"f8137f86.997c4","name":"","namespace":"variable","peerid":"93","type":"variable-out","variable":"ALARM_TEST","variabletype":"device","wires":[],"x":1495,"y":480,"z":"ed2293b3.9cd52"},{"field":"","format":"json","id":"61c83517.2cd39c","name":"false","namespace":"template","output":"json","syntax":"plain","template":"false","type":"template","wires":[[{"id":"f8137f86.997c4","port":0}]],"x":1310,"y":530,"z":"ed2293b3.9cd52"},{"channel":"10","family":"14","id":"bc866070.455998","loopprevention":false,"looppreventiongroup":"4a09f7fb.c09be","name":"","namespace":"variable","outputonstartup":false,"peerid":"94","refractoryperiod":"0","type":"variable-in","variable":"PROXIMITY","variabletype":"device","wires":[[{"id":"ab2ba03.c3fd2e","port":0},{"id":"af7b0410.31b6b","port":0}]],"x":110,"y":700,"z":"69ea3b1f.befffc"},{"func":"if($message['payload'])\n{\n    $value = getNodeData('value');\n    $value = !$value;\n    setNodeData('value', $value);\n    return array('payload' => $value);\n}","id":"7380fa60.ae841c","inputs":1,"name":"toggle","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[{"id":"288cac96.d1a6a4","port":0}]],"x":270,"y":600,"z":"69ea3b1f.befffc"},{"func":"if($message['payload'])\n{\n    $value = $hg->getValue(43, 1, \"LEVEL\");\n    return array('payload' => ($value == 0 ? true : false));\n}","id":"200e60c.8db8da","inputs":1,"name":"toggle","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[{"id":"8b96a942.b74918","port":0}]],"x":270,"y":300,"z":"69ea3b1f.befffc"},{"func":"$value = $message['payload'];\nif($value > 0)\n{\n     $value /= 100;\n     $message['payload'] = ($value * (10000.0 - 1100.0)) + 1100.0;\n}\nreturn $message;","id":"d3c1dca4.2346b","inputs":1,"name":"","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[{"id":"8cfee3a5.59bc6","port":0}]],"x":270,"y":350,"z":"69ea3b1f.befffc"},{"channel":"1","family":"14","id":"220d2aca.64697e","loopprevention":true,"looppreventiongroup":"cab7665b.af1d4","name":"","namespace":"variable","outputonstartup":false,"peerid":"94","refractoryperiod":"0","type":"variable-in","variable":"LEVEL","variabletype":"device","wires":[[{"id":"d3c1dca4.2346b","port":0}]],"x":100,"y":350,"z":"69ea3b1f.befffc"},{"channel":"1","family":"11","id":"8cfee3a5.59bc6","name":"","namespace":"variable","peerid":"43","type":"variable-out","variable":"LEVEL","variabletype":"device","wires":[],"x":640,"y":350,"z":"69ea3b1f.befffc"},{"channel":"1","family":"11","id":"f0311243.dc8","loopprevention":true,"looppreventiongroup":"cab7665b.af1d4","name":"","namespace":"variable","outputonstartup":false,"peerid":"43","refractoryperiod":"0","type":"variable-in","variable":"LEVEL","variabletype":"device","wires":[[{"id":"b7c8cf99.a9847","port":0}]],"x":100,"y":400,"z":"69ea3b1f.befffc"},{"func":"$value = $message['payload'];\nif($value > 0 && $value < 1100.0) $value = 1100.0;\nif($value > 0) $message['payload'] = (int)round(($value - 1100.0) / (10000.0 - 1100.0) * 100);\nreturn $message;","id":"b7c8cf99.a9847","inputs":1,"name":"","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[{"id":"4b934783.0d14b8","port":0}]],"x":270,"y":400,"z":"69ea3b1f.befffc"},{"channel":"1","family":"14","id":"4b934783.0d14b8","name":"","namespace":"variable","peerid":"94","type":"variable-out","variable":"LEVEL","variabletype":"device","wires":[],"x":635,"y":400,"z":"69ea3b1f.befffc"},{"id":"a8d4093c.68cc1","name":"","namespace":"synchronous","outputs":2,"type":"synchronous","wires":[[{"id":"f145d1b3.48f928","port":0}],[{"id":"6e732ba0.cce7cc","port":0}]],"x":1115,"y":490,"z":"ed2293b3.9cd52"},{"func":"if($message['payload'])\n{\n    $value = getNodeData('value');\n    $value = !$value;\n    setNodeData('value', $value);\n    return array('payload' => $value);\n}","id":"e92fecb7.1c53d8","inputs":1,"name":"toggle","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[{"id":"288cac96.d1a6a4","port":0}]],"x":270,"y":450,"z":"69ea3b1f.befffc"},{"channel":"10","family":"14","id":"a8191e38.8332f8","loopprevention":false,"looppreventiongroup":"4a09f7fb.c09be","name":"","namespace":"variable","outputonstartup":false,"peerid":"35","refractoryperiod":"0","type":"variable-in","variable":"PROXIMITY","variabletype":"device","wires":[[{"id":"ab2ba03.c3fd2e","port":0},{"id":"af7b0410.31b6b","port":0}]],"x":110,"y":750,"z":"69ea3b1f.befffc"},{"changes-only":false,"checkall":"true","id":"88a01336.931648","inputs":1,"name":"","namespace":"basic-logic","output-false":true,"output-true":true,"outputs":2,"property":"payload","rules":[{"t":"true"},{"t":"false"}],"type":"switch","wires":[[{"id":"54e6ff25.9e87f","port":0}],[{"id":"d1920e23.9af86","port":0}]],"x":680,"y":140,"z":"d0956444.e19c88"},{"active":true,"complete":"false","console":"debtab","id":"54e6ff25.9e87f","loglevel":"info","name":"","namespace":"debug","type":"debug","wires":[],"x":890,"y":130,"z":"d0956444.e19c88"},{"id":"ffbc036f.899e08","name":"","namespace":"passthrough","onboolean":false,"type":"passthrough","wires":[[{"id":"88a01336.931648","port":0}]],"x":480,"y":140,"z":"d0956444.e19c88"},{"id":"a7ac5d70.2a6ff","name":"","namespace":"variable","outputonstartup":false,"payload":"true","payloadType":"bool","type":"constant","wires":[[{"id":"ffbc036f.899e08","port":0}]],"x":260,"y":70,"z":"d0956444.e19c88"},{"id":"5e8e19a4.6b00f","name":"","namespace":"variable","outputonstartup":false,"payload":"false","payloadType":"bool","type":"constant","wires":[[{"id":"ffbc036f.899e08","port":0}]],"x":260,"y":120,"z":"d0956444.e19c88"},{"id":"62c5476f.8a174","name":"","namespace":"variable","outputonstartup":false,"payload":"true","payloadType":"bool","type":"constant","wires":[[{"id":"ffbc036f.899e08","port":1}]],"x":260,"y":170,"z":"d0956444.e19c88"},{"id":"64584107.62baa8","name":"","namespace":"variable","outputonstartup":false,"payload":"false","payloadType":"bool","type":"constant","wires":[[{"id":"ffbc036f.899e08","port":1}]],"x":260,"y":220,"z":"d0956444.e19c88"},{"active":true,"complete":"false","console":"debtab","id":"d1920e23.9af86","loglevel":"info","name":"","namespace":"debug","type":"debug","wires":[],"x":890,"y":180,"z":"d0956444.e19c88"},{"channel":"1","family":"5","id":"397d4e8.3a1f732","name":"","namespace":"variable","peerid":"70","type":"toggle","variable":"STATE","variabletype":"device","wires":[[]],"x":505,"y":680,"z":"822c4be8.2ccc28"},{"channel":"1","family":"5","id":"477bca2c.e2b86c","name":"","namespace":"variable","peerid":"86","type":"toggle","variable":"STATE","variabletype":"device","wires":[[]],"x":505,"y":630,"z":"822c4be8.2ccc28"},{"channel":"1","factor":"","family":"5","id":"73c8de0d.09aa88","inputs":1,"interval":"","lighttype":"switch","maxvalue":"","minvalue":"","name":"","namespace":"light","offvalue":"0","offvalue2":"","onvalue":"100","peerid":"86","step":"","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":505,"y":580,"z":"822c4be8.2ccc28"},{"changes-only":false,"checkall":"true","id":"c0196811.057f2","inputs":1,"name":"","namespace":"basic-logic","output-false":false,"output-true":true,"outputs":1,"property":"payload","rules":[{"t":"true"}],"type":"switch","wires":[[{"id":"477bca2c.e2b86c","port":0}]],"x":260,"y":630,"z":"822c4be8.2ccc28"},{"changes-only":false,"checkall":"true","id":"3e39bd71.2271da","inputs":1,"name":"","namespace":"basic-logic","output-false":false,"output-true":true,"outputs":1,"property":"payload","rules":[{"t":"true"}],"type":"switch","wires":[[{"id":"397d4e8.3a1f732","port":0}]],"x":260,"y":680,"z":"822c4be8.2ccc28"},{"channel":"1","family":"15","id":"82215c9a.50962","loopprevention":false,"looppreventiongroup":"cab7665b.af1d4","name":"","namespace":"variable","outputonstartup":false,"peerid":"99","refractoryperiod":"1000","type":"variable-in","variable":"STATE","variabletype":"device","wires":[[{"id":"3e39bd71.2271da","port":0}]],"x":95,"y":730,"z":"822c4be8.2ccc28"},{"channel":"2","family":"15","id":"76fdb346.37f454","loopprevention":false,"looppreventiongroup":"cab7665b.af1d4","name":"","namespace":"variable","outputonstartup":false,"peerid":"99","refractoryperiod":"1000","type":"variable-in","variable":"STATE","variabletype":"device","wires":[[{"id":"c0196811.057f2","port":0}]],"x":95,"y":630,"z":"822c4be8.2ccc28"},{"channel":"3","family":"15","id":"883b728e.fe8c2","loopprevention":false,"looppreventiongroup":"cab7665b.af1d4","name":"","namespace":"variable","outputonstartup":false,"peerid":"99","refractoryperiod":"0","type":"variable-in","variable":"STATE","variabletype":"device","wires":[[{"id":"7187a87b.8afb58","port":1}]],"x":95,"y":430,"z":"822c4be8.2ccc28"},{"channel":"4","family":"15","id":"5a2d1963.61c448","loopprevention":false,"looppreventiongroup":"cab7665b.af1d4","name":"","namespace":"variable","outputonstartup":false,"peerid":"99","refractoryperiod":"0","type":"variable-in","variable":"STATE","variabletype":"device","wires":[[{"id":"7187a87b.8afb58","port":0}]],"x":95,"y":330,"z":"822c4be8.2ccc28"},{"channel":"11","family":"14","id":"3d8e44af.9e2634","loopprevention":false,"looppreventiongroup":"dfc2bc9b.417f1","name":"","namespace":"variable","outputonstartup":false,"peerid":"33","refractoryperiod":"0","type":"variable-in","variable":"PLAY","variabletype":"device","wires":[[{"id":"d97a4221.b6717","port":0}]],"x":90,"y":1290,"z":"5e7e747b.a20d9c"},{"id":"5cf39b6b.7d73ac","info":"","name":"Sonos","namespace":"comment","type":"comment","wires":[],"x":80,"y":1240,"z":"5e7e747b.a20d9c"},{"channel":"1","family":"6","id":"f95c83cb.bb70a8","name":"","namespace":"variable","peerid":"85","type":"variable-out","variable":"PLAY","variabletype":"device","wires":[],"x":510,"y":1290,"z":"5e7e747b.a20d9c"},{"changes-only":false,"checkall":"true","id":"d97a4221.b6717","inputs":1,"name":"","namespace":"basic-logic","output-false":false,"output-true":false,"outputs":1,"property":"payload","rules":[{"t":"true"}],"type":"switch","wires":[[{"id":"f95c83cb.bb70a8","port":0}]],"x":290,"y":1290,"z":"5e7e747b.a20d9c"},{"channel":"11","family":"14","id":"ccf0046d.e0401","loopprevention":false,"looppreventiongroup":"dfc2bc9b.417f1","name":"","namespace":"variable","outputonstartup":false,"peerid":"33","refractoryperiod":"0","type":"variable-in","variable":"PAUSE","variabletype":"device","wires":[[{"id":"e08be115.0c249","port":0}]],"x":95,"y":1340,"z":"5e7e747b.a20d9c"},{"channel":"1","family":"6","id":"e243fd74.17dbb","name":"","namespace":"variable","peerid":"85","type":"variable-out","variable":"PAUSE","variabletype":"device","wires":[],"x":500,"y":1340,"z":"5e7e747b.a20d9c"},{"changes-only":false,"checkall":"true","id":"e08be115.0c249","inputs":1,"name":"","namespace":"basic-logic","output-false":false,"output-true":false,"outputs":1,"property":"payload","rules":[{"t":"true"}],"type":"switch","wires":[[{"id":"e243fd74.17dbb","port":0}]],"x":290,"y":1340,"z":"5e7e747b.a20d9c"},{"channel":"11","family":"14","id":"43c486a2.1caf48","loopprevention":false,"looppreventiongroup":"dfc2bc9b.417f1","name":"","namespace":"variable","outputonstartup":false,"peerid":"33","refractoryperiod":"0","type":"variable-in","variable":"NEXT","variabletype":"device","wires":[[{"id":"e67d6377.50ca08","port":0}]],"x":95,"y":1390,"z":"5e7e747b.a20d9c"},{"channel":"1","family":"6","id":"d75151d4.6f26c8","name":"","namespace":"variable","peerid":"85","type":"variable-out","variable":"NEXT","variabletype":"device","wires":[],"x":500,"y":1390,"z":"5e7e747b.a20d9c"},{"changes-only":false,"checkall":"true","id":"e67d6377.50ca08","inputs":1,"name":"","namespace":"basic-logic","output-false":false,"output-true":false,"outputs":1,"property":"payload","rules":[{"t":"true"}],"type":"switch","wires":[[{"id":"d75151d4.6f26c8","port":0}]],"x":290,"y":1390,"z":"5e7e747b.a20d9c"},{"channel":"11","family":"14","id":"ea70e5ce.5c549","loopprevention":false,"looppreventiongroup":"dfc2bc9b.417f1","name":"","namespace":"variable","outputonstartup":false,"peerid":"33","refractoryperiod":"0","type":"variable-in","variable":"PREVIOUS","variabletype":"device","wires":[[{"id":"8b0f922.0ea1f7","port":0}]],"x":110,"y":1440,"z":"5e7e747b.a20d9c"},{"channel":"1","family":"6","id":"c9849a5e.8dd43","name":"","namespace":"variable","peerid":"85","type":"variable-out","variable":"PREVIOUS","variabletype":"device","wires":[],"x":485,"y":1440,"z":"5e7e747b.a20d9c"},{"changes-only":false,"checkall":"true","id":"8b0f922.0ea1f7","inputs":1,"name":"","namespace":"basic-logic","output-false":false,"output-true":false,"outputs":1,"property":"payload","rules":[{"t":"true"}],"type":"switch","wires":[[{"id":"c9849a5e.8dd43","port":0}]],"x":290,"y":1440,"z":"5e7e747b.a20d9c"},{"channel":"11","family":"14","id":"31aa181e.1f92e8","loopprevention":true,"looppreventiongroup":"e3a45745.cbe3c","name":"","namespace":"variable","outputonstartup":false,"peerid":"33","refractoryperiod":"0","type":"variable-in","variable":"VOLUME","variabletype":"device","wires":[[{"id":"b5739bab.87c4b","port":0}]],"x":110,"y":1490,"z":"5e7e747b.a20d9c"},{"channel":"1","family":"6","id":"b5739bab.87c4b","name":"","namespace":"variable","peerid":"85","type":"variable-out","variable":"VOLUME","variabletype":"device","wires":[],"x":490,"y":1490,"z":"5e7e747b.a20d9c"},{"channel":"1","family":"6","id":"93b22e33.600008","loopprevention":true,"looppreventiongroup":"e3a45745.cbe3c","name":"","namespace":"variable","outputonstartup":false,"peerid":"85","refractoryperiod":"0","type":"variable-in","variable":"VOLUME","variabletype":"device","wires":[[{"id":"32c3453a.6d7812","port":0}]],"x":100,"y":1540,"z":"5e7e747b.a20d9c"},{"channel":"11","family":"14","id":"32c3453a.6d7812","name":"","namespace":"variable","peerid":"33","type":"variable-out","variable":"VOLUME","variabletype":"device","wires":[],"x":485,"y":1540,"z":"5e7e747b.a20d9c"},{"channel":"11","family":"14","id":"2d3d8775.cb8798","loopprevention":false,"looppreventiongroup":"e3a45745.cbe3c","name":"","namespace":"variable","outputonstartup":false,"peerid":"33","refractoryperiod":"0","type":"variable-in","variable":"PLAYLIST.RAW","variabletype":"device","wires":[[{"id":"bd77729b.145348","port":0}]],"x":120,"y":1590,"z":"5e7e747b.a20d9c"},{"changes-only":false,"checkall":"true","id":"bd77729b.145348","inputs":1,"name":"","namespace":"basic-logic","output-false":false,"output-true":true,"outputs":3,"property":"payload","rules":[{"t":"eq","v":"0","vt":"int"},{"t":"eq","v":"1","vt":"int"},{"t":"eq","v":"2","vt":"int"}],"type":"switch","wires":[[{"id":"42c5a497.6cf2e4","port":0}],[{"id":"15f5b2fe.e62865","port":0}],[{"id":"e600dcc2.ed1ab8","port":0}]],"x":315,"y":1610,"z":"5e7e747b.a20d9c"},{"field":"payload","format":"handlebars","id":"42c5a497.6cf2e4","name":"Einaudi","namespace":"template","output":"str","syntax":"plain","template":"Einaudi","type":"template","wires":[[{"id":"cc726815.fee688","port":0}]],"x":470,"y":1590,"z":"5e7e747b.a20d9c"},{"channel":"1","family":"6","id":"cc726815.fee688","name":"","namespace":"variable","peerid":"85","type":"variable-out","variable":"PLAY_PLAYLIST","variabletype":"device","wires":[],"x":680,"y":1590,"z":"5e7e747b.a20d9c"},{"field":"payload","format":"handlebars","id":"15f5b2fe.e62865","name":"Musicals","namespace":"template","output":"str","syntax":"plain","template":"Musicals","type":"template","wires":[[{"id":"cc726815.fee688","port":0}]],"x":480,"y":1640,"z":"5e7e747b.a20d9c"},{"field":"payload","format":"handlebars","id":"e600dcc2.ed1ab8","name":"Mainstream","namespace":"template","output":"str","syntax":"plain","template":"Mainstream","type":"template","wires":[[{"id":"cc726815.fee688","port":0}]],"x":480,"y":1690,"z":"5e7e747b.a20d9c"},{"always-off-time":"21600","always-on-time":"21600","id":"985b1569.f18ef8","name":"","namespace":"presence-light","on-time":"300","type":"presence-light","wires":[[{"id":"4cb348c2.6d0ec","port":1},{"id":"1efe5129.c9daf7","port":0}],[],[],[{"id":"ffc81a3c.03757","port":0}],[{"id":"a52b3c28.255b48","port":0}]],"x":490,"y":450,"z":"5e7e747b.a20d9c"},{"channel":"0","id":"15c6c027.23d4b","name":"","namespace":"variable","peerid":"0","type":"variable-out","variable":"sleeping","variabletype":"global","wires":[],"x":265,"y":690,"z":"1755f935.cee76f"},{"channel":"0","id":"5a242994.0f8e38","name":"","namespace":"variable","peerid":"0","type":"variable-out","variable":"night","variabletype":"global","wires":[],"x":270,"y":220,"z":"1755f935.cee76f"},{"channel":"3","family":"14","id":"d375f38a.82cfe","name":"","namespace":"variable","peerid":"79","refractoryperiod":"0","type":"variable-in","variable":"MOTION","variabletype":"device","wires":[[{"id":"985b1569.f18ef8","port":3}]],"x":100,"y":500,"z":"5e7e747b.a20d9c"},{"channel":"0","id":"c3d8cd39.7128d8","loopprevention":false,"looppreventiongroup":"cab7665b.af1d4","name":"","namespace":"variable","outputonstartup":false,"peerid":"0","refractoryperiod":"0","type":"variable-in","variable":"presenceLightEnabledWithSleeping","variabletype":"global","wires":[[{"id":"985b1569.f18ef8","port":0}]],"x":170,"y":350,"z":"5e7e747b.a20d9c"},{"func":"if(!$message['payload']) return;\nsetFlowData('scene', $inputIndex + 1);","id":"e5be32cb.253258","inputs":"3","name":"Todo: Math node","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[]],"x":345,"y":220,"z":"5e7e747b.a20d9c"},{"channel":"1","eventsource":"device","family":"14","id":"c79c4036.a422d8","loopprevention":false,"looppreventiongroup":"cab7665b.af1d4","name":"","namespace":"variable","outputonstartup":false,"peerid":"33","refractoryperiod":"1000","type":"variable-in","variable":"SCENE_BATH","variabletype":"device","wires":[[{"id":"e5be32cb.253258","port":1}]],"x":120,"y":250,"z":"5e7e747b.a20d9c"},{"channel":"1","eventsource":"device","family":"14","id":"9cdb4eab.ab5808","loopprevention":false,"looppreventiongroup":"cab7665b.af1d4","name":"","namespace":"variable","outputonstartup":false,"peerid":"33","refractoryperiod":"1000","type":"variable-in","variable":"SCENE_FULL","variabletype":"device","wires":[[{"id":"e5be32cb.253258","port":0}]],"x":110,"y":200,"z":"5e7e747b.a20d9c"},{"id":"4cb348c2.6d0ec","name":"","namespace":"passthrough","onboolean":true,"type":"passthrough","wires":[[{"id":"1efe5129.c9daf7","port":0}]],"x":655,"y":380,"z":"5e7e747b.a20d9c"},{"channel":"0","id":"17dc1f42.2c6a71","loopprevention":false,"looppreventiongroup":"cab7665b.af1d4","name":"","namespace":"variable","outputonstartup":false,"peerid":"0","refractoryperiod":"0","type":"variable-in","variable":"scene","variabletype":"flow","wires":[[{"id":"4cb348c2.6d0ec","port":0}]],"x":480,"y":370,"z":"5e7e747b.a20d9c"},{"changes-only":false,"checkall":"false","id":"1efe5129.c9daf7","inputs":1,"name":"","namespace":"basic-logic","output-false":false,"output-true":false,"outputs":4,"property":"payload","rules":[{"t":"eq","v":"1","vt":"int"},{"t":"eq","v":"2","vt":"int"},{"t":"eq","v":"3","vt":"int"},{"t":"false"}],"type":"switch","wires":[[{"id":"f4925973.8c39e","port":0},{"id":"e66d7a5f.5a722","port":0},{"id":"452a59d3.6304f8","port":0}],[{"id":"24576ab9.f2941e","port":0},{"id":"f3e6188.18375e8","port":0},{"id":"f2f2fb17.20d01","port":0},{"id":"5578888b.64d5d","port":0}],[{"id":"80e651c.b56c5b","port":0},{"id":"ffc81820.984b9","port":0}],[{"id":"f4925973.8c39e","port":0},{"id":"d7842245.68ffd8","port":0},{"id":"e66d7a5f.5a722","port":0}]],"x":790,"y":380,"z":"5e7e747b.a20d9c"},{"channel":"0","id":"47705812.c1ccc8","loopprevention":false,"looppreventiongroup":"cab7665b.af1d4","name":"","namespace":"variable","outputonstartup":false,"peerid":"0","refractoryperiod":"0","type":"variable-in","variable":"isDark","variabletype":"global","wires":[[{"id":"b12298d4.e1dac","port":0}]],"x":90,"y":760,"z":"1755f935.cee76f"},{"func":"foreach($message['payload'] as $roomIsDark)\n{\n    if($roomIsDark)\n    {\n        setGlobalData('atLeastOneRoomDark', true);\n        return;\n    }\n}\n\nsetGlobalData('atLeastOneRoomDark', false);","id":"b12298d4.e1dac","inputs":1,"name":"Set atLeastOneRoomDark","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[]],"x":300,"y":760,"z":"1755f935.cee76f"},{"channel":"1","family":"14","id":"5da34189.ea1d5","name":"","namespace":"variable","peerid":"33","type":"variable-out","variable":"ON_TIMER","variabletype":"device","wires":[],"x":810,"y":460,"z":"5e7e747b.a20d9c"},{"channel":"1","eventsource":"device","family":"14","id":"f7d1aa9d.52f79","loopprevention":false,"looppreventiongroup":"c233726a.b4eee8","name":"","namespace":"variable","outputonstartup":false,"peerid":"33","refractoryperiod":"0","type":"variable-in","variable":"ON_TIMER","variabletype":"device","wires":[[{"id":"7238f647.a2c0a8","port":0}]],"x":110,"y":400,"z":"5e7e747b.a20d9c"},{"func":"if($message['payload'] == 0)\n{\n    return array('payload' => false);\n}\nelse\n{\n    $alwaysOnTime = $message['payload'] * 216; // 100% => 21600s\n    return array('payload' => true, 'alwaysOnTime' => $alwaysOnTime);\n}","id":"7238f647.a2c0a8","inputs":1,"name":"Todo: Scale node","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[{"id":"985b1569.f18ef8","port":1}]],"x":285,"y":400,"z":"5e7e747b.a20d9c"},{"channel":"1","eventsource":"device","family":"14","id":"d15ca7b4.e05e5","loopprevention":false,"looppreventiongroup":"782455c3.4da004","name":"","namespace":"variable","outputonstartup":false,"peerid":"33","refractoryperiod":"0","type":"variable-in","variable":"OFF_TIMER","variabletype":"device","wires":[[{"id":"533ff8f.bde0988","port":0}]],"x":110,"y":450,"z":"5e7e747b.a20d9c"},{"func":"if($message['payload'] == 0)\n{\n    return array('payload' => false);\n}\nelse\n{\n    $alwaysOffTime = $message['payload'] * 216; // 100% => 21600s\n    return array('payload' => true, 'alwaysOffTime' => $alwaysOffTime);\n}","id":"533ff8f.bde0988","inputs":1,"name":"","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[{"id":"985b1569.f18ef8","port":2}]],"x":260,"y":450,"z":"5e7e747b.a20d9c"},{"func":"$lastOutput = getNodeData('lastOutput');\nif($message['payload'] != 0 && time() - $lastOutput < 60) return;\nsetNodeData('lastOutput', time());\n$alwaysOnTime = (int)round($message['payload'] / 216.0);\nif($message['payload'] > 0 && $alwaysOnTime == 0) $alwaysOnTime = 1;\nreturn array('payload' => $alwaysOnTime);","id":"ffc81a3c.03757","inputs":1,"name":"","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[{"id":"5da34189.ea1d5","port":0}]],"x":660,"y":460,"z":"5e7e747b.a20d9c"},{"func":"$lastOutput = getNodeData('lastOutput');\nif($message['payload'] != 0 && time() - $lastOutput < 60) return;\nsetNodeData('lastOutput', time());\n$alwaysOffTime = (int)round($message['payload'] / 216.0);\nif($message['payload'] > 0 && $alwaysOffTime == 0) $alwaysOffTime = 1;\nreturn array('payload' => $alwaysOffTime);","id":"a52b3c28.255b48","inputs":1,"name":"","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[{"id":"ea79f766.36488","port":0}]],"x":660,"y":510,"z":"5e7e747b.a20d9c"},{"channel":"1","family":"14","id":"ea79f766.36488","name":"","namespace":"variable","peerid":"33","type":"variable-out","variable":"OFF_TIMER","variabletype":"device","wires":[],"x":810,"y":510,"z":"5e7e747b.a20d9c"},{"channel":"1","eventsource":"device","family":"14","id":"2f5131a0.99b77e","loopprevention":false,"looppreventiongroup":"cab7665b.af1d4","name":"","namespace":"variable","outputonstartup":false,"peerid":"33","refractoryperiod":"1000","type":"variable-in","variable":"SCENE_SPOT","variabletype":"device","wires":[[{"id":"e5be32cb.253258","port":2}]],"x":120,"y":300,"z":"5e7e747b.a20d9c"},{"channel":"1","eventsource":"device","family":"14","id":"8ea74440.5f1af8","loopprevention":false,"looppreventiongroup":"cab7665b.af1d4","name":"","namespace":"variable","outputonstartup":false,"peerid":"33","refractoryperiod":"0","type":"variable-in","variable":"sleeping","variabletype":"global","wires":[[{"id":"e5be32cb.253258","port":0}]],"x":100,"y":150,"z":"5e7e747b.a20d9c"},{"channel":"1","family":"11","id":"f4925973.8c39e","inputs":1,"lighttype":"switch","name":"","namespace":"light","offvalue":0,"onvalue":100,"peerid":"6","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":1230,"y":320,"z":"5e7e747b.a20d9c"},{"channel":"1","factor":"","family":"5","id":"d7842245.68ffd8","inputs":1,"interval":"","lighttype":"switch","maxvalue":"","minvalue":"","name":"","namespace":"light","offvalue":0,"offvalue2":"","onvalue":"254","peerid":"56","step":"","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":1230,"y":350,"z":"5e7e747b.a20d9c"},{"channel":"1","family":"5","id":"f63c145f.0934f","name":"","namespace":"variable","peerid":"56","type":"variable-out","variable":"BRIGHTNESS","variabletype":"device","wires":[],"x":1370,"y":400,"z":"5e7e747b.a20d9c"},{"channel":"3","factor":"","family":"11","id":"e66d7a5f.5a722","inputs":1,"interval":"","lighttype":"switch","maxvalue":"","minvalue":"","name":"","namespace":"light","offvalue":"0","offvalue2":"","onvalue":"100","peerid":"6","step":"","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":1230,"y":290,"z":"5e7e747b.a20d9c"},{"field":"","format":"handlebars","id":"56e8cc84.7d618c","name":"254","namespace":"template","output":"json","syntax":"plain","template":"254","type":"template","wires":[[{"id":"f63c145f.0934f","port":0}]],"x":1210,"y":400,"z":"5e7e747b.a20d9c"},{"id":"24576ab9.f2941e","name":"","namespace":"synchronous","outputs":"2","type":"synchronous","wires":[[{"id":"f3e6188.18375e8","port":0}],[{"id":"cca56e6c.a6748","port":0}]],"x":1050,"y":540,"z":"5e7e747b.a20d9c"},{"channel":"1","factor":"","family":"5","id":"f3e6188.18375e8","inputs":1,"interval":"","lighttype":"switch","maxvalue":"","minvalue":"","name":"","namespace":"light","offvalue":0,"offvalue2":"","onvalue":"254","peerid":"56","step":"","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":1230,"y":510,"z":"5e7e747b.a20d9c"},{"field":"","format":"handlebars","id":"cca56e6c.a6748","name":"100","namespace":"template","output":"json","syntax":"plain","template":"100","type":"template","wires":[[{"id":"7b5e9275.22f1a4","port":0}]],"x":1210,"y":560,"z":"5e7e747b.a20d9c"},{"channel":"1","family":"5","id":"7b5e9275.22f1a4","name":"","namespace":"variable","peerid":"56","type":"variable-out","variable":"BRIGHTNESS","variabletype":"device","wires":[],"x":1370,"y":560,"z":"5e7e747b.a20d9c"},{"channel":"1","family":"11","id":"f2f2fb17.20d01","inputs":1,"lighttype":"switch","name":"","namespace":"light","offvalue":0,"onvalue":100,"peerid":"6","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":1230,"y":480,"z":"5e7e747b.a20d9c"},{"channel":"3","factor":"","family":"11","id":"d9ecf3f1.336d4","inputs":1,"interval":"","lighttype":"switch","maxvalue":"","minvalue":"","name":"","namespace":"light","offvalue":"0","offvalue2":"","onvalue":"100","peerid":"6","step":"","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":1230,"y":450,"z":"5e7e747b.a20d9c"},{"field":"","format":"handlebars","id":"5578888b.64d5d","name":"false","namespace":"template","output":"json","syntax":"plain","template":"false","type":"template","wires":[[{"id":"d9ecf3f1.336d4","port":0}]],"x":1080,"y":450,"z":"5e7e747b.a20d9c"},{"id":"452a59d3.6304f8","name":"","namespace":"synchronous","outputs":"2","type":"synchronous","wires":[[{"id":"d7842245.68ffd8","port":0}],[{"id":"56e8cc84.7d618c","port":0}]],"x":1050,"y":390,"z":"5e7e747b.a20d9c"},{"field":"","format":"handlebars","id":"80e651c.b56c5b","name":"false","namespace":"template","output":"json","syntax":"plain","template":"false","type":"template","wires":[[{"id":"792b3c7f.1c93dc","port":0},{"id":"46b93076.bfa77","port":0}]],"x":1210,"y":610,"z":"5e7e747b.a20d9c"},{"channel":"3","factor":"","family":"11","id":"792b3c7f.1c93dc","inputs":1,"interval":"","lighttype":"switch","maxvalue":"","minvalue":"","name":"","namespace":"light","offvalue":"0","offvalue2":"","onvalue":"100","peerid":"6","step":"","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":1360,"y":610,"z":"5e7e747b.a20d9c"},{"channel":"1","family":"11","id":"ffc81820.984b9","inputs":1,"lighttype":"switch","name":"","namespace":"light","offvalue":0,"onvalue":100,"peerid":"6","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":1360,"y":670,"z":"5e7e747b.a20d9c"},{"channel":"1","factor":"","family":"5","id":"46b93076.bfa77","inputs":1,"interval":"","lighttype":"switch","maxvalue":"","minvalue":"","name":"","namespace":"light","offvalue":0,"offvalue2":"","onvalue":"254","peerid":"56","step":"","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":1360,"y":640,"z":"5e7e747b.a20d9c"},{"always-off-time":"21600","always-on-time":"21600","id":"413d6872.48eb1","name":"","namespace":"presence-light","on-time":"300","type":"presence-light","wires":[[{"id":"9ba38d15.691cf","port":0}],[{"id":"920d31ac.cb25b","port":0},{"id":"7d4cda6d.ff86bc","port":0}],[],[],[]],"x":370,"y":280,"z":"c0d2bbb9.a687a"},{"channel":"0","id":"d55b829f.27455","loopprevention":false,"looppreventiongroup":"cab7665b.af1d4","name":"","namespace":"variable","outputonstartup":false,"peerid":"0","refractoryperiod":"0","type":"variable-in","variable":"presenceLightEnabled","variabletype":"global","wires":[[{"id":"413d6872.48eb1","port":0}]],"x":135,"y":200,"z":"c0d2bbb9.a687a"},{"channel":"0","eventsource":"all","id":"a068999e.881ab8","loopprevention":false,"looppreventiongroup":"c233726a.b4eee8","name":"","namespace":"variable","outputonstartup":false,"peerid":"0","refractoryperiod":"0","type":"variable-in","variable":"lightOn","variabletype":"flow","wires":[[{"id":"413d6872.48eb1","port":1}]],"x":90,"y":250,"z":"c0d2bbb9.a687a"},{"channel":"0","eventsource":"all","id":"2c660745.d8bde8","loopprevention":false,"looppreventiongroup":"c233726a.b4eee8","name":"","namespace":"variable","outputonstartup":false,"peerid":"0","refractoryperiod":"0","type":"variable-in","variable":"lightOff","variabletype":"flow","wires":[[{"id":"413d6872.48eb1","port":2}]],"x":90,"y":300,"z":"c0d2bbb9.a687a"},{"channel":"12","family":"14","id":"2e69c689.a2f2fa","name":"","namespace":"variable","peerid":"32","type":"variable-out","variable":"STATE","variabletype":"device","wires":[],"x":710,"y":250,"z":"c0d2bbb9.a687a"},{"field":"payload","format":"handlebars","id":"920d31ac.cb25b","name":"0","namespace":"template","output":"json","syntax":"plain","template":"0","type":"template","wires":[[{"id":"2e69c689.a2f2fa","port":0}]],"x":560,"y":250,"z":"c0d2bbb9.a687a"},{"id":"7d4cda6d.ff86bc","name":"","namespace":"basic-logic","type":"not","wires":[[{"id":"89c7c0ac.6d0cf8","port":0},{"id":"202b816.df2517e","port":0}]],"x":560,"y":300,"z":"c0d2bbb9.a687a"},{"channel":"12","family":"14","id":"202b816.df2517e","name":"","namespace":"variable","peerid":"32","type":"variable-out","variable":"lightOn","variabletype":"flow","wires":[],"x":700,"y":280,"z":"c0d2bbb9.a687a"},{"channel":"12","family":"14","id":"89c7c0ac.6d0cf8","name":"","namespace":"variable","peerid":"32","type":"variable-out","variable":"lightOff","variabletype":"flow","wires":[],"x":700,"y":310,"z":"c0d2bbb9.a687a"},{"channel":"0","id":"e6e739d6.4234a","loopprevention":false,"looppreventiongroup":"cab7665b.af1d4","name":"","namespace":"variable","outputonstartup":false,"peerid":"0","refractoryperiod":"0","type":"variable-in","variable":"night","variabletype":"global","wires":[[{"id":"d17284af.7207a8","port":0}]],"x":80,"y":840,"z":"1755f935.cee76f"},{"changes-only":false,"id":"d17284af.7207a8","inputs":"2","name":"","namespace":"basic-logic","output-false":true,"type":"or","wires":[[{"id":"f60789e3.1b2898","port":0}]],"x":320,"y":860,"z":"1755f935.cee76f"},{"channel":"0","id":"f60789e3.1b2898","name":"","namespace":"variable","peerid":"0","type":"variable-out","variable":"presenceLightEnabled","variabletype":"global","wires":[],"x":505,"y":860,"z":"1755f935.cee76f"},{"channel":"0","id":"ba9faf34.35098","loopprevention":false,"looppreventiongroup":"cab7665b.af1d4","name":"","namespace":"variable","outputonstartup":false,"peerid":"0","refractoryperiod":"0","type":"variable-in","variable":"atLeastOneRoomDark","variabletype":"global","wires":[[{"id":"d17284af.7207a8","port":1}]],"x":130,"y":890,"z":"1755f935.cee76f"},{"changes-only":false,"id":"b135046c.962c7","inputs":"2","name":"","namespace":"basic-logic","output-false":true,"type":"or","wires":[[{"id":"be16cc63.98e8e","port":0}]],"x":330,"y":970,"z":"1755f935.cee76f"},{"channel":"0","id":"e582d151.db7818","loopprevention":false,"looppreventiongroup":"cab7665b.af1d4","name":"","namespace":"variable","outputonstartup":false,"peerid":"0","refractoryperiod":"0","type":"variable-in","variable":"night","variabletype":"global","wires":[[{"id":"b135046c.962c7","port":0}]],"x":80,"y":940,"z":"1755f935.cee76f"},{"changes-only":false,"id":"be16cc63.98e8e","inputs":2,"name":"","namespace":"basic-logic","output-false":true,"type":"and","wires":[[{"id":"ae6de175.3d27b","port":0}]],"x":460,"y":970,"z":"1755f935.cee76f"},{"channel":"0","id":"c58c04ab.670528","loopprevention":false,"looppreventiongroup":"cab7665b.af1d4","name":"","namespace":"variable","outputonstartup":false,"peerid":"0","refractoryperiod":"0","type":"variable-in","variable":"atLeastOneRoomDark","variabletype":"global","wires":[[{"id":"b135046c.962c7","port":1}]],"x":130,"y":990,"z":"1755f935.cee76f"},{"id":"5cebe02c.864eb8","name":"","namespace":"basic-logic","type":"not","wires":[[{"id":"be16cc63.98e8e","port":1}]],"x":330,"y":1020,"z":"1755f935.cee76f"},{"channel":"0","id":"ae6de175.3d27b","name":"","namespace":"variable","peerid":"0","type":"variable-out","variable":"presenceLightEnabledWithSleeping","variabletype":"global","wires":[],"x":700,"y":970,"z":"1755f935.cee76f"},{"channel":"0","id":"7ad2952b.6a6384","loopprevention":false,"looppreventiongroup":"cab7665b.af1d4","name":"","namespace":"variable","outputonstartup":false,"peerid":"0","refractoryperiod":"0","type":"variable-in","variable":"sleeping","variabletype":"global","wires":[[{"id":"5cebe02c.864eb8","port":0}]],"x":90,"y":1040,"z":"1755f935.cee76f"},{"channel":"1","family":"14","id":"e0f4e28.36f89a","loopprevention":false,"looppreventiongroup":"cab7665b.af1d4","name":"","namespace":"variable","outputonstartup":false,"peerid":"31","refractoryperiod":"0","type":"variable-in","variable":"STATE","variabletype":"device","wires":[[{"id":"ca97ea8b.6e0d88","port":0}]],"x":95,"y":150,"z":"9cd3b032.f95e28"},{"channel":"1","factor":"0.03","family":"11","id":"5b691b71.9f544c","inputs":1,"interval":"100","lighttype":"switch","maxvalue":"100","minvalue":"15","name":"","namespace":"light","offvalue":"0","offvalue2":"0","onvalue":"100","peerid":"5","step":"1","twoinputs":false,"type":"light","variable":"STATE","variabletype":"device","wires":[],"x":575,"y":200,"z":"9cd3b032.f95e28"},{"channel":"3","family":"14","id":"e0840096.b188e","loopprevention":false,"looppreventiongroup":"c233726a.b4eee8","name":"","namespace":"variable","outputonstartup":false,"peerid":"77","refractoryperiod":"0","type":"variable-in","variable":"MOTION","variabletype":"device","wires":[[{"id":"50257f0b.f13e7","port":3}]],"x":100,"y":350,"z":"9cd3b032.f95e28"},{"func":"$lightOn = getFlowData('lightOn');\n$lightOff = getFlowData('lightOff');\nif($message['payload'])\n{\n    if(!$lightOff)\n    {\n        setFlowData('lightOn', true);\n        $hg->setValue(31, 12, 'STATE', 100);\n    }\n    else\n    {\n        setFlowData('lightOff', false);\n        $hg->setValue(31, 12, 'STATE', 0);\n    }\n}\nelse\n{\n    if($lightOn)\n    {\n        setFlowData('lightOn', false);\n        $hg->setValue(31, 12, 'STATE', 0);\n    }\n    else\n    {\n        setFlowData('lightOff', true);\n        $hg->setValue(31, 12, 'STATE', 1);\n    }\n}","id":"ca97ea8b.6e0d88","inputs":"1","name":"","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[]],"x":290,"y":150,"z":"9cd3b032.f95e28"},{"channel":"1","family":"14","id":"fcf41d98.cbd8b","loopprevention":false,"looppreventiongroup":"","name":"","namespace":"variable","outputonstartup":false,"peerid":"77","refractoryperiod":"180000","type":"variable-in","variable":"BRIGHTNESS","variabletype":"device","wires":[[{"id":"d8c50ece.a5b4a","port":0}]],"x":115,"y":100,"z":"9cd3b032.f95e28"},{"func":"$isDarkGlobal = getGlobalData('isDark');\nif(!is_array($isDarkGlobal)) $isDarkGlobal = array();\n\nif(getGlobalData('night'))\n{\n    setFlowData('lastBrightnesses', array());\n    setFlowData('isDark', false);\n}\nelse if(!$hg->getValue(5, 3, 'STATE'))\n{\n    $brightnesses = getFlowData('lastBrightnesses');\n    if(!is_array($brightnesses)) $brightnesses = array($message['payload']);\n    else array_push($brightnesses, $message['payload']);\n    if(count($brightnesses) > 6) array_shift($brightnesses);\n    setFlowData('lastBrightnesses', $brightnesses);\n    foreach($brightnesses as $brightness)\n    {\n        if($brightness < 11000)\n        {\n            setFlowData('isDark', true);\n            $isDarkGlobal['Suedzimmer'] = true;\n            setGlobalData('isDark', $isDarkGlobal);\n            return NULL;\n        }\n    }\n    \n    $isDarkGlobal['Suedzimmer'] = false;\n    setGlobalData('isDark', $isDarkGlobal);\n    \n    foreach($isDarkGlobal as $room => $isDark)\n    {\n        if($room != 'Suedzimmer' && $isDark)\n        {\n            setFlowData('isDark', true);\n            return NULL;\n        }\n    }\n    \n    setFlowData('isDark', false);\n}\nelse\n{\n    $isDarkGlobal['Suedzimmer'] = false;\n    setGlobalData('isDark', $isDarkGlobal);\n}","id":"d8c50ece.a5b4a","inputs":1,"name":"Set flow.isDark and global.isDark","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[]],"x":360,"y":100,"z":"9cd3b032.f95e28"},{"always-off-time":"21600","always-on-time":"21600","id":"50257f0b.f13e7","name":"","namespace":"presence-light","on-time":"300","type":"presence-light","wires":[[{"id":"5b691b71.9f544c","port":0}],[{"id":"e1de7dd7.f0f818","port":0},{"id":"590c96fb.ee1488","port":0}],[],[],[]],"x":370,"y":280,"z":"9cd3b032.f95e28"},{"channel":"0","id":"8d636c4d.637f08","loopprevention":false,"looppreventiongroup":"cab7665b.af1d4","name":"","namespace":"variable","outputonstartup":false,"peerid":"0","refractoryperiod":"0","type":"variable-in","variable":"presenceLightEnabled","variabletype":"global","wires":[[{"id":"50257f0b.f13e7","port":0}]],"x":135,"y":200,"z":"9cd3b032.f95e28"},{"channel":"0","eventsource":"all","id":"b8cc12d8.665dc8","loopprevention":false,"looppreventiongroup":"c233726a.b4eee8","name":"","namespace":"variable","outputonstartup":false,"peerid":"0","refractoryperiod":"0","type":"variable-in","variable":"lightOn","variabletype":"flow","wires":[[{"id":"50257f0b.f13e7","port":1}]],"x":90,"y":250,"z":"9cd3b032.f95e28"},{"channel":"0","eventsource":"all","id":"926fda33.5c872","loopprevention":false,"looppreventiongroup":"c233726a.b4eee8","name":"","namespace":"variable","outputonstartup":false,"peerid":"0","refractoryperiod":"0","type":"variable-in","variable":"lightOff","variabletype":"flow","wires":[[{"id":"50257f0b.f13e7","port":2}]],"x":90,"y":300,"z":"9cd3b032.f95e28"},{"channel":"12","family":"14","id":"2ad2cac6.85263e","name":"","namespace":"variable","peerid":"31","type":"variable-out","variable":"STATE","variabletype":"device","wires":[],"x":710,"y":250,"z":"9cd3b032.f95e28"},{"field":"payload","format":"handlebars","id":"e1de7dd7.f0f818","name":"0","namespace":"template","output":"json","syntax":"plain","template":"0","type":"template","wires":[[{"id":"2ad2cac6.85263e","port":0}]],"x":560,"y":250,"z":"9cd3b032.f95e28"},{"id":"590c96fb.ee1488","name":"","namespace":"basic-logic","type":"not","wires":[[{"id":"6013d6a6.18c16","port":0},{"id":"3814875f.0487b","port":0}]],"x":560,"y":300,"z":"9cd3b032.f95e28"},{"channel":"12","family":"14","id":"3814875f.0487b","name":"","namespace":"variable","peerid":"32","type":"variable-out","variable":"lightOn","variabletype":"flow","wires":[],"x":700,"y":280,"z":"9cd3b032.f95e28"},{"channel":"12","family":"14","id":"6013d6a6.18c16","name":"","namespace":"variable","peerid":"32","type":"variable-out","variable":"lightOff","variabletype":"flow","wires":[],"x":700,"y":310,"z":"9cd3b032.f95e28"}]
